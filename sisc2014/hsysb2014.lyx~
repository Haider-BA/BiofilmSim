#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass cmes
\begin_preamble
%\usepackage{cite}

%\runningtitle{Variable Viscosity and Density Biofilm Simulations, Part I} 

%\title{Variable Viscosity and Density Biofilm Simulations using an Immersed Boundary Method, Part I: Numerical Scheme and Convergence Results}

%\author{
%Jason F. Hammond\thanks{High Power Microwave Division, AFRL, Kirtland AFB, Albuquerque, NM},\
%Elizabeth J. Stewart\thanks{Department of Chemical Engineering, University of Michigan, Ann Arbor, MI},\
%John G. Younger\thanks{Department of Emergency Medicine, University of Michigan Ann Arbor, MI},\
%Michael J. Solomon\affiliate{2},\
%David M. Bortz\thanks{Department of Applied Mathematics, University of Colorado, Boulder, CO}\thanks{Corresponding author (dmbortz@colorado.edu)}
%}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding default
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Variable Viscosity and Density Biofilm Simulations using an Immersed Boundary
 Method, Part I: Numerical Scheme and Convergence Results
\end_layout

\begin_layout RunningTitle
Variable Viscosity and Density Biofilm Simulations, Part I
\end_layout

\begin_layout Author
Jason F.
 Hammond
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
thanks{High Power Microwave Division, AFRL, Kirtland AFB, Albuquerque, NM}
\end_layout

\end_inset

, Elizabeth J.
 Stewart
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
thanks{Department of Chemical Engineering, University of Michigan, Ann Arbor,
 MI}
\end_layout

\end_inset

, John G.
 Younger
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
thanks{Department of Emergency Medicine, University of Michigan Ann Arbor,
 MI}
\end_layout

\end_inset

, Michael J.
 Solomon
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
affiliate{2}
\end_layout

\end_inset

, David M.
 Bortz
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
thanks{Department of Applied Mathematics, University of Colorado, Boulder,
 CO}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
thanks{Corresponding author (dmbortz@colorado.edu)}
\end_layout

\end_inset


\end_layout

\begin_layout Abstract
The overall goal of this work is to develop a numerical simulation which
 correctly describes a bacterial biofilm fluid-structure interaction and
 separation process.
 In this, the first of a two-part effort, we fully develop a convergent
 scheme and provide numerical evidence for the method order as well as a
 full 3D separation simulation.
 We use an immersed boundary-based method (IBM) to model and simulate a
 biofilm with density and viscosity values different from than that of the
 surrounding fluid.
 The simulation also includes breakable springs connecting the bacteria
 in the biofilm which allows the inclusion of erosion and detachment into
 the simulation.
 We use the incompressible Navier-Stokes (N-S) equations to describe the
 motion of the flowing fluid and discretize the fluid equations using finite
 differences.
 We use a geometric multigrid method to solve the resulting equations at
 each time step.
 We note that the use of multigrid is necessary because of the dramatically
 different densities and viscosities between the biofilm and the surrounding
 fluid.
 We investigate and simulate the model in both two and three dimensions.
\begin_inset Newline newline
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

We also note that our method differs from several previous attempts of using
 IBM for modeling biofilm/flow interactions in the following ways: the density
 and viscosity of the biofilm can differ substantially from the surrounding
 fluid, and the Lagrangian node locations correspond to experimentally measured
 bacterial cell locations from 3D images taken of 
\emph on
Staphylococcus epidermidis
\emph default
 in a biofilm.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

In the followup article, we will present the results of the validation of
 this model and calibration to several experimental scenarios.
\end_layout

\begin_layout Keywords
Navier-Stokes equation, biofilm, immersed boundary method, computational
 fluid dynamics, multigrid, viscoelastic fluid
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Introduction-to-Biofilm"

\end_inset

Introduction
\end_layout

\begin_layout Standard
This is the first of two articles which detail our investigation of the
 response and fragmentation of a biofilm in shear flow.
 Specifically, we study the mechanisms of biofilm fluid response and detachment
 in terms of spatially varying biofilm density, elasticity, and viscosity.
 In the simulations, we model the surface adherent biofilms using an extension
 of the immersed boundary method (IBM) (originally developed in 
\begin_inset CommandInset citation
LatexCommand citep
key "Peskin1977"

\end_inset

).
 Our approach differs from the traditional IBM in several ways.
 We use experimentally measured biofilm bacterial cell locations as the
 positions for our Lagrangian nodes, whereas traditional IBM refines the
 Lagrangian mesh along with the Eulerian mesh.
 An important part of the IBM is in the choice of approximation of the Dirac
 delta function which transfers information between the two grids.
 We have accordingly adapted the approximation to scale with the radius
 of the bacteria rather than with the mesh width.
 Lastly we note that this work comprises the bulk of the lead author's graduate
 school dissertation work.
 For further details of this and related work, we direct the interested
 reader to his dissertation (
\begin_inset CommandInset citation
LatexCommand citep
key "Hammond2012phd"

\end_inset

) as well as a previous version of this paper posted on arXiv in (
\begin_inset CommandInset citation
LatexCommand citep
key "HammondBiofilms"

\end_inset

).
 The second article will address validation of the scheme presented here
 (
\begin_inset CommandInset citation
LatexCommand cite
key "Stotsky"

\end_inset

).
\end_layout

\begin_layout Standard
In this introduction, we first provide a brief background on the biology
 and biomechanics of bacterial biofilms in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Bacterial-Biofilms"

\end_inset

.
 In 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Mathematical-Models"

\end_inset

, we discuss some alternative mathematical models that have been used to
 model biofilms (along with advantages and disadvantages).
 In 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Immersed-Boundary-Method"

\end_inset

, we introduce the immersed boundary method, and in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Variable-Viscosity"

\end_inset

, we discuss the significance of including variable viscosity.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Bacterial-Biofilms"

\end_inset

Biomechanics of Bacterial Biofilms
\end_layout

\begin_layout Standard
Biofilms are a phenotype of bacteria that are found in health, industrial
 and natural settings.
 In the medical field, biofilms occur on devices such as contact lenses,
 catheters, and mechanical heart valves.
 In industrial settings, they occur in and on water pipes, storage tanks,
 ship hulls, filters, food preparation facilities, etc.
 In natural settings, they can be found as slime on rocks in bodies of water
 or as dental plaque on teeth.
 
\end_layout

\begin_layout Standard
Physically, biofilms are immobile and consist of a community of bacterial
 cells embedded in a dense surface-adherent extracellular matrix (ECM) of
 polysaccharides.
 Biofilms are mechanically strong structures that tend to deform and fragment
 rather than completely dislodge when subjected to flows.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:BiofilmPicture"

\end_inset

 contains an electron micrograph of a biofilm of 
\shape italic
Klebsiella pneumoniae
\shape default
, clearly showing the ECM interconnecting the bacterial cells.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename GenomicsklebsiellaJustPic.gif
	lyxscale 50
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:BiofilmPicture"

\end_inset

Scanning electron microscopy of sessile 
\emph on
K.
 pneumoniae
\emph default
 LM21 performed in mature biofilm formed on Thermanox slides in microfermentor
 system after 48 hours of development at 20000 times magnification.
 This image is from 
\begin_inset CommandInset citation
LatexCommand citep
key "Balestrino2008"

\end_inset

 (used with permission).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
An important feature of biofilms is that they are known to behave like 
\shape italic
viscoelastic fluids
\shape default
 (
\begin_inset CommandInset citation
LatexCommand citep
key "Klapper2002"

\end_inset

).
 In other words, they exhibit both viscous and elastic responses upon deformatio
n.
 Describing the exact viscoelastic behavior has been the subject of much
 experimental, theoretical, and computational research (
\begin_inset CommandInset citation
LatexCommand cite
key "Aravas2008,EhretBolNetworkTheory2013,Klapper2002,Kreft2001,Lau2009,Pavlovsky2013,Picioreanu2004,Picioreanu2001,Picioreanu1999,PicioreanuLoodsdrecht2000DisContMod,Rupp2005"

\end_inset

).
 For example, Klapper et al.
\begin_inset space ~
\end_inset

and Pavlosky et al.
\begin_inset space ~
\end_inset

use a linear Jeffrey’s constitutive law (
\begin_inset CommandInset citation
LatexCommand citep
key "Klapper2002,Pavlovsky2013"

\end_inset

) while Lau et al.
\begin_inset space ~
\end_inset

use a Voigt standard linear solid model for viscoelastic materials (
\begin_inset CommandInset citation
LatexCommand citep
key "Lau2009"

\end_inset

).
 Recently, Ehret and Böl use an approach from network theory and model the
 ECM as a superposition of worm-like chain networks, and include viscosity
 by considering the network junctions to be transient (
\begin_inset CommandInset citation
LatexCommand citep
key "EhretBolNetworkTheory2013"

\end_inset

).
 Our model includes elasticity of the biofilm by using simple linear springs
 (as done in 
\begin_inset CommandInset citation
LatexCommand citep
key "AlpkvistKlapper2007WST"

\end_inset

) to connect the bacterial cells, and includes the viscosity of the biofilm
 with a modification of the constitutive equations for stress.
\end_layout

\begin_layout Subsection
Mathematical Models of Biofilms
\begin_inset CommandInset label
LatexCommand label
name "sec:Mathematical-Models"

\end_inset


\end_layout

\begin_layout Standard
Much research into the mathematical modeling of biofilm growth and fluid/structu
re interactions has been conducted in the last three decades (
\begin_inset CommandInset citation
LatexCommand cite
key "Kreft1998,Kreft2001,Picioreanu2001,Picioreanu1999,PicioreanuLoodsdrecht2000DisContMod,ZhangCoganWang2008One,ZhangCoganWang2008Two"

\end_inset

).
 Below, we summarize several modeling and simulation strategies.
 This is not intended to be exhaustive and we direct the interested reader
 to 
\begin_inset CommandInset citation
LatexCommand cite
key "Klapper2010,WangZhang2010Review"

\end_inset

 for more in-depth reviews.
 
\end_layout

\begin_layout Standard
The first attempts at mathematical modeling of biofilms were conducted in
 the early 1980s (
\begin_inset CommandInset citation
LatexCommand cite
key "Kissel1984,Rittmann1980,Rittmann1982"

\end_inset

).
 Picioreanu and others (
\begin_inset CommandInset citation
LatexCommand cite
key "Kreft1998,Kreft2001,Picioreanu2004"

\end_inset

) advocated for an individual based (IB) approach, which models the behavior
 of each bacteria, encompassing ideas such as cell division, cell motility,
 metabolism, and death to simulate the growth and formation of colonies.
 Hybrid discrete-continuum models were the first methods to couple the flow
 with the the biofilm computationally in 2D and 3D simulations.
 Picioreanu, van Loodsdrecht, and Heijnen developed and used these hybrid
 discrete-continuum models to incorporate the flow over the irregular biofilm's
 surfaces, convective and diffusive mass transfer of substrate, bacterial
 growth, and biomass spreading (
\begin_inset CommandInset citation
LatexCommand cite
key "Picioreanu2001,Picioreanu1999,PicioreanuLoodsdrecht2000DisContMod"

\end_inset

).
 
\end_layout

\begin_layout Standard
The most sophisticated (purely) continuum models developed are the phase-field
 models, which use a one-fluid/two-component formulation in which the ECM
 and the bacteria are modeled as one fluid component, while the collective
 ensemble of nutrient substrates and the surrounding fluid are the other
 (
\begin_inset CommandInset citation
LatexCommand citep
key "ZhangCoganWang2008One,ZhangCoganWang2008Two"

\end_inset

).
 Two-dimensional simulations of both biofilm growth and biofilm-flow interaction
 are presented in 
\begin_inset CommandInset citation
LatexCommand citep
key "ZhangCoganWang2008Two"

\end_inset

, in which shear induced deformation and detachment are illustrated.
 
\end_layout

\begin_layout Standard
We note that our model differs from both these approaches in the way that
 we model the biofilm.
 We treat the bacteria in the biofilm as discrete points, where the nodal
 locations in our simulations correspond to the locations of the bacterial
 cells within the biofilm.
 This contrasts from the continuum phase-field models that only include
 averaged biomechanical properties of the biofilm.
 With our mathematical formulation, just as in the individual based models,
 we can obtain the cumulative local stresses as well as attribute different
 local properties to the biofilm.
 Our model can be thought of as an extension of the individual based models,
 where we accurately account for the interactions with the fluid as well
 as include the possibility of fragmentation.
 We also assume that on the time scale of our simulations there is no biofilm
 growth; so we ignore such factors as nutrient concentrations and growth
 rates.
 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sec:Immersed-Boundary-Method"

\end_inset

Immersed Boundary Method
\end_layout

\begin_layout Standard
The immersed boundary method (IBM) was originally developed by Peskin to
 study blood flow in the heart (
\begin_inset CommandInset citation
LatexCommand citep
key "Peskin1977"

\end_inset

).
 The IBM has been used previously to model and simulate biofilm/fluid interactio
ns by 
\begin_inset CommandInset citation
LatexCommand citep
key "Dillon1996"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citep
key "AlpkvistKlapper2007WST"

\end_inset

.
 The authors successfully coupled the fluid to the biofilm; however, they
 make the assumption that the biofilm has the same density and viscosity
 as the surrounding fluid.
 This choice substantially simplifies the task of solving the N-S equations
 but does not account for the fact that biofilms typically have 
\begin_inset Formula $500\times$
\end_inset

 larger viscosity and 
\begin_inset Formula $12\%$
\end_inset

 larger density than water (
\begin_inset CommandInset citation
LatexCommand citep
key "Klapper2002,Ro1991"

\end_inset

).
 They also use a random distribution of points within a biofilm-shaped shell
 to represent the biofilm, which does not account for the true spatial distribut
ion of bacterial cells within a biofilm.
 
\end_layout

\begin_layout Standard
The IBM has been used more recently in the modeling of immersed elastic
 structures in viscous flows in 
\begin_inset CommandInset citation
LatexCommand cite
key "Huang2009IBM,Luo2008,Strychalski2012,Zhuo2011"

\end_inset

, in which the authors use constitutive viscoelastic models including Maxwell,
 Voigt, and Jeffrey's models to incorporate forces in the immersed structures
 into the IBM.
 Similarly, our ultimate goal is to establish an appropriate constitutive
 model for the forces in the biofilm with the help of experimental collaborators
 and to include this in our IBM formulation.
 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Variable-Viscosity"

\end_inset

Variable Viscosity
\end_layout

\begin_layout Standard
It is generally agreed that biofilms behave like a viscoelastic fluid and
 there has been a several efforts to match the behavior of biofilms with
 conventional mechanical viscoelastic models (
\begin_inset CommandInset citation
LatexCommand cite
key "Aravas2008,Klapper2002,Lau2009,Pavlovsky2013"

\end_inset

).
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
We also note that adding viscosity through the use of local damping forces
 (a typical mechanical model for a viscoelastic material) leads to problematic
 stability restrictions.
 
\end_layout

\end_inset

 However, these efforts have not produced a consensus on the best mathematical
 model.
 This is, in part, due to the fact that the viscoelastic properties in biofilms
 are highly variable with different growth conditions (
\begin_inset CommandInset citation
LatexCommand citep
key "Chen2005effectsAdhesiveStrength"

\end_inset

) and even in the same growth conditions (
\begin_inset CommandInset citation
LatexCommand citep
key "Aggarwal2010"

\end_inset

).
\end_layout

\begin_layout Standard
In this work, we chose to treat the fluid in the entire domain as a Newtonian
 viscous fluid with a spatially varying viscous coefficient.
 We couple the biofilm to the fluid within the entire biofilm region via
 the viscous term in the N-S equations.
 We note that a similar approach has recently been attempted in a single
 fluid IBM (
\begin_inset CommandInset citation
LatexCommand cite
key "FaiPeskin2013,Fai2014"

\end_inset

).
 Their approach, however, is not directly applicable to a system with continuous
ly varying viscosity.
\begin_inset Foot
status collapsed

\begin_layout Standard
They consider the simulation of a tumbling red blood cell with an interior
 viscosity higher than the surrounding fluid.
 Mathematically this means there is a discontinuity in the viscosity across
 the cell membrane.
\end_layout

\end_inset

 Others have used two materials (fluid-fluid or fluid-solid), but couple
 them only at the interface (
\begin_inset CommandInset citation
LatexCommand cite
key "Luo2008,ZhangCoganWang2008Two"

\end_inset

).
\end_layout

\begin_layout Standard
We now describe the organization of this paper.
 In 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Mathematical-Formulation"

\end_inset

 we provide our mathematical formulation, which is a variation of the immersed
 boundary method literature.
 In 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Numerical-Method"

\end_inset

, we describe our numerical method, based on a multigrid approach.
 In 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Validation"

\end_inset

, we provide numerical convergence results for our method.
 In 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Simulations-Results"

\end_inset

, we provide simulation results in both two and three dimensions, running
 our simulations for a variety of experimentally obtained biofilms with
 varying parameters such as spring constants, densities, viscosities.
 Finally, we provide conclusions in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Biofilm-Simulation-Conclusions"

\end_inset

 and a discussion of possibilities for future work in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:FW"

\end_inset

.
\end_layout

\begin_layout Section
Mathematical Formulation
\begin_inset CommandInset label
LatexCommand label
name "sec:Mathematical-Formulation"

\end_inset


\end_layout

\begin_layout Standard
In this section, we provide the mathematical formulation for our simulations.
 We use an Eulerian mesh to describe the system as a whole and solve the
 dimensionless N-S equations at each time step on the mesh.
 The Lagrangian nodes are used only to compute information about the bacteria/bi
ofilm (location, velocity, local density, force) and then transfer the informati
on back onto the Eulerian mesh using the Dirac delta function.
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The Dirac Delta function is approximated in the actual implementation (see
 Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dirac Delta Approx"

\end_inset

).
\end_layout

\end_inset


\begin_inset space \negthinspace{}
\end_inset


\begin_inset space \negthinspace{}
\end_inset

 For convenience, we provide a list in Appendix A of the variables and parameter
s used in this work.
 
\end_layout

\begin_layout Standard
We now introduce the mathematical equations used in our model.
 The dependent Eulerian variables are velocity 
\begin_inset Formula $\mathbf{u}(\mathbf{x},\, t)$
\end_inset

, pressure 
\begin_inset Formula $p(\mathbf{x},\, t)$
\end_inset

, density 
\begin_inset Formula $\rho(\mathbf{x},\, t)$
\end_inset

, and Eulerian force density 
\begin_inset Formula $\mathbf{f}(\mathbf{x},\, t)$
\end_inset

, where 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is the independent Eulerian variable and 
\begin_inset Formula $t$
\end_inset

 is time.
 The dependent Lagrangian variables are position of the nodes 
\begin_inset Formula $\mathbf{X}(\mathbf{q},\, t)$
\end_inset

, velocity of the nodes 
\begin_inset Formula $\mathbf{U}(\mathbf{q},\, t)$
\end_inset

, and the Lagrangian force density 
\begin_inset Formula $\mathbf{F}(\mathbf{q},\, t)$
\end_inset

, where 
\begin_inset Formula $\mathbf{q}=(q,r,s)$
\end_inset

 is the independent Lagrangian variable.
 The equations of motion for the biofilm-fluid interaction are 
\begin_inset Formula 
\begin{eqnarray}
\rho(\mathbf{x},\, t)\left(\frac{\partial\mathbf{u}}{\partial t}+\mathbf{u}\cdot\triangledown\mathbf{u}\right) & = & -\triangledown p+\triangledown\cdot\left(\mu(\mathbf{x},\, t)\left(\triangledown\mathbf{u}+\left(\triangledown\mathbf{u}\right)^{T}\right)\right)+\mathbf{f}(\mathbf{x},\, t)\label{eq:N-S1VarVisc}\\
\triangledown\cdot\mathbf{u} & = & 0,\label{eq:Incompressible}\\
\frac{\partial\mathbf{X}}{\partial t}(\mathbf{q},\, t) & = & \mathbf{U}(\mathbf{X}(\mathbf{q},\, t),\, t),\label{eq:LagVel}\\
\mathbf{f}(\mathbf{x},\, t) & = & \int_{\Omega_{b}}\mathbf{F}(\mathbf{q},\, t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{q},\, t))\textrm{d}\mathbf{q},\label{eq:ForceCouple}\\
\mathbf{\rho}(\mathbf{x},\, t) & = & \rho_{0}+\int_{\Omega_{b}}\rho_{b}\delta(\mathbf{x}-\mathbf{X}(\mathbf{q},\, t))\textrm{d}\mathbf{q},\label{eq:DensCouple}\\
\mathbf{U}(\mathbf{X}(\mathbf{q},\, t),\, t) & = & \int_{\Omega}\mathbf{u}(\mathbf{x},\, t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{q},\, t))\textrm{d}\mathbf{x},\label{eq:VelCouple}
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 is the dynamic viscosity, 
\begin_inset Formula $\rho_{0}$
\end_inset

 is the mass density of the fluid, 
\begin_inset Formula $\rho_{b}$
\end_inset

 is the additional mass density of the biofilm from that of the surrounding
 fluid, 
\begin_inset Formula $\Omega$
\end_inset

 is the flow domain, 
\begin_inset Formula $\Omega_{b}\subset\Omega$
\end_inset

 is the space occupied by only the biofilm, and 
\begin_inset Formula $\delta(\mathbf{x})$
\end_inset

 is the Dirac delta function.
 Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-S1VarVisc"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Incompressible"

\end_inset

 form the incompressible Navier-Stokes (N-S) equations with spatially varying
 viscosity and a forcing term that represents the forces applied by the
 biofilm on the fluid.
 We omit the force of gravity from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-S1VarVisc"

\end_inset

 since the biofilms we wish to model are at most 20% greater density than
 water (
\begin_inset CommandInset citation
LatexCommand citep
key "Masuda1991,Ro1991"

\end_inset

); thus, the gravitational force is negligible compared to the other forces
 involved.
 Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:LagVel"

\end_inset

 is the equation of motion of the biofilm, where 
\begin_inset Formula $\mathbf{U}(\mathbf{q},\, t)$
\end_inset

 is the velocity of the biofilm.
 The systems of PDE's given by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-S1VarVisc"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Incompressible"

\end_inset

 is coupled to 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:LagVel"

\end_inset

 by the integrals given in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ForceCouple"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:VelCouple"

\end_inset

.
\end_layout

\begin_layout Standard
To avoid numerical inaccuracies due to roundoff errors, we non-dimensionalize
 these equations using the non-dimensional variables defined as 
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t^{*}=\frac{t}{T}$
\end_inset

, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{x}^{*}=\frac{\mathbf{x}}{L}$
\end_inset

, 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}^{*}=\frac{\mathbf{u}}{u_{0}}$
\end_inset

,
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p^{*}=\frac{p-p_{L_{tube}}}{p_{0}-p_{L_{tube}}}$
\end_inset

,
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{\triangledown}^{*}=L\mathbf{\triangledown}$
\end_inset

,
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\rho^{*}=\frac{\rho}{\rho_{0}}$
\end_inset

,
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{f}^{*}=\frac{\mathbf{f}}{f_{0}}$
\end_inset

,
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu^{*}=\frac{\mu}{\mu_{0}}$
\end_inset

,
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset

 
\end_layout

\begin_layout Standard
\noindent
where 
\begin_inset Formula $p_{0}$
\end_inset

 is the pressure at the upstream end of the tube, 
\begin_inset Formula $p_{L_{tube}}$
\end_inset

 is the pressure at the downstream end of the tube, 
\begin_inset Formula $T$
\end_inset

 is the characteristic time scale, 
\begin_inset Formula $f_{0}$
\end_inset

 is the characteristic force density, and 
\begin_inset Formula $L$
\end_inset

 is the characteristic length.
 We use the scaling parameters defined in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: 2D sim params-1"

\end_inset

.
 Dropping the stars from the dimensionless variables, Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Incompressible"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ForceCouple"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:VelCouple"

\end_inset

 remain the same as in the case with dimensions, while Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-S1VarVisc"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:LagVel"

\end_inset

 become
\begin_inset Formula 
\begin{eqnarray}
\sigma\rho(\mathbf{x},\, t)\frac{\partial\mathbf{u}}{\partial t}+\rho(\mathbf{x},\, t)\mathbf{u}\cdot\triangledown\mathbf{u} & = & -\varepsilon\triangledown p+Re^{-1}\triangledown\cdot\left(\mu(\mathbf{x},\, t)\left(\triangledown\mathbf{u}+\left(\triangledown\mathbf{u}\right)^{T}\right)\right)\label{eq:N-SnondimFull}\\
 &  & \qquad+\frac{Lf_{0}}{\rho_{0}u_{0}^{2}}\mathbf{f}(\mathbf{x},\, t),\label{eq:N-SnondimFull2}\\
\sigma\frac{\partial\mathbf{X}}{\partial t}(\mathbf{q},\, t) & = & \mathbf{U}(\mathbf{q},\, t),
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\sigma=\frac{L}{Tu_{0}}$
\end_inset

 is the Strouhal number, 
\begin_inset Formula $\varepsilon=\frac{p_{0}-p_{L_{tube}}}{\rho_{0}u_{0}^{2}}$
\end_inset

 is the Euler number, and 
\begin_inset Formula $Re=\frac{\rho_{0}Lu_{0}}{\mu}$
\end_inset

 is the Reynolds number of the fluid.
 
\end_layout

\begin_layout Standard
The initial velocity profile is the exact solution to the incompressible
 Navier-Stokes equations in a square or circular tube with rigid walls and
 no-slip conditions at the walls.
 The velocity profile for a circular cylinder can be found in many textbooks
 in fluid dynamics (such as 
\begin_inset CommandInset citation
LatexCommand citep
key "Zamir2000"

\end_inset

), and a series solution for the laminar flow velocity profile for a square
 tube was derived by 
\begin_inset CommandInset citation
LatexCommand citep
key "Spiga1994"

\end_inset

.
\end_layout

\begin_layout Section
Numerical Method
\begin_inset CommandInset label
LatexCommand label
name "sec:Numerical-Method"

\end_inset


\end_layout

\begin_layout Standard
In this section, we describe the numerical formulation for our simulations,
 which is based on the Immersed Boundary Method.
 Our numerical task is to solve the system defined by Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-S1VarVisc"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:VelCouple"

\end_inset

, and we now provide the details of our numerical approach.
 
\end_layout

\begin_layout Standard
The incompressible flow Navier-Stokes equations, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-S1VarVisc"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Incompressible"

\end_inset

, are discretized on a fixed uniform Eulerian lattice, while the biofilm
 equations are discretized on a moving Lagrangian array of points that do
 not necessarily coincide with the fixed Eulerian mesh points of the fluid
 computation.
 We represent the interaction equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ForceCouple"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:VelCouple"

\end_inset

 with a smoothed approximation 
\begin_inset Formula $\tilde{\delta}$
\end_inset

 to the Dirac delta function (see Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dirac Delta Approx"

\end_inset

).
 Our numerical approach was inspired by the solving technique used by 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhu2002"

\end_inset

 to simulate a flapping filament in a soap film.
 
\end_layout

\begin_layout Standard
The discretized equations corresponding to Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ForceCouple"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:VelCouple"

\end_inset

 are given by
\begin_inset Formula 
\begin{eqnarray}
\mathbf{f}^{n}(\mathbf{x}) & = & \sum_{s=1}^{\eta}\mathbf{F}^{n}(s)\tilde{\delta}(\mathbf{x}-\mathbf{X}^{n}(s),\,\omega),\label{eq:discrForceCouple}\\
\mathbf{\rho}^{n}(\mathbf{x}) & = & \rho_{0}+\sum_{s=1}^{\eta}\rho_{b}\tilde{\delta}(\mathbf{x}-\mathbf{X}^{n}(s),\,\omega)d_{0}^{3},\label{eq:discrDensCouple}\\
\mathbf{U}^{n+1}(s) & = & \sum_{\mathbf{x}}\mathbf{u}^{n+1}(\mathbf{x})\tilde{\delta}(\mathbf{x}-\mathbf{X}^{n}(s),\,\omega)h^{3},\label{eq:discrVelCouple}
\end{eqnarray}

\end_inset

where the superscript 
\begin_inset Formula $n$
\end_inset

 denotes numerical approximations at a particular time step 
\begin_inset Formula $n$
\end_inset

, 
\begin_inset Formula $\eta$
\end_inset

 is the total number of Lagrangian discretization points, the sum in Equation
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrVelCouple"

\end_inset

 is over all the discrete points of the form 
\begin_inset Formula $\mathbf{x}=(ih,\, jh,\, kh)$
\end_inset

 with 
\begin_inset Formula $i,\, j,$
\end_inset

 and 
\begin_inset Formula $k$
\end_inset

 are integers, 
\begin_inset Formula $h$
\end_inset

 is the Eulerian mesh width, and 
\begin_inset Formula $d_{0}^{3}$
\end_inset

 is the average volume element of the Lagrangian nodes (computed by dividing
 the total volume of the biofilm by the total number of Lagrangian nodes
 distributed within it).
 Following convention, we replace 
\begin_inset Formula $(q,\, r,\, s)$
\end_inset

 from the mathematical formulation with only 
\begin_inset Formula $s$
\end_inset

, which we use as an indexed label with a unique number assigned to each
 Lagrangian point (
\begin_inset CommandInset citation
LatexCommand citep
key "Zhu2002"

\end_inset

).
 In Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrForceCouple"

\end_inset

, 
\begin_inset Formula $\mathbf{F}(s)$
\end_inset

 is now the total elastic force on the Lagrangian node associated with marker
 
\begin_inset Formula $s$
\end_inset

, as opposed to an elastic force density.
 This is because we calculate the force explicitly depending on which other
 nodes it is connected to.
 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Dirac-Delta-Approximation"

\end_inset

Dirac Delta Approximation
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "Peskin2002"

\end_inset

, he defines 
\begin_inset Formula $\delta_{h}(\mathbf{x})$
\end_inset

 as
\begin_inset Formula 
\begin{eqnarray}
\delta_{h}(\mathbf{x})=h^{-3}\phi\left(\frac{x}{h}\right)\phi\left(\frac{y}{h}\right)\phi\left(\frac{z}{h}\right) &  & ,\label{eq:Dirac Delta Post 1}
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\phi(r)$
\end_inset

 is a symmetric function with compact support such that 
\begin_inset Formula $\delta_{h}$
\end_inset

 satisfies a 
\shape italic
unity condition,
\shape default
 
\begin_inset Formula 
\begin{equation}
\sum_{\mathbf{x}\in g_{h}}\delta_{h}(\mathbf{x}-\mathbf{X})h^{3}=1,\:\forall\mathbf{X},\label{eq:unityConditionDirac}
\end{equation}

\end_inset

and a 
\shape italic
first-moment condition,
\shape default
 
\begin_inset Formula 
\begin{equation}
\sum_{\mathbf{x}\in g_{h}}(\mathbf{x}-\mathbf{X})\delta_{h}(\mathbf{x}-\mathbf{X})h^{3}=0,\:\forall\mathbf{X}\,.\label{eq:1stMomentConditionDirac}
\end{equation}

\end_inset

We replace this 
\begin_inset Formula $\delta_{h}$
\end_inset

, that is used in standard IBM implementations, with one that scales with
 
\begin_inset Formula $\omega$
\end_inset

 instead of the grid spacing 
\begin_inset Formula $h$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\tilde{\delta}(\mathbf{x},\,\omega)=\omega^{-3}\phi\left(\frac{x}{\omega}\right)\phi\left(\frac{y}{\omega}\right)\phi\left(\frac{z}{\omega}\right).\label{eq:Dirac Delta Approx}
\end{equation}

\end_inset

We deviate from the standard scaling of the Dirac Delta approximation for
 two reasons.
 The first is that we wish to give a presence to the bacterial cells that
 is representative of the true volume of the cells.
 Thus, in the simulations, we make 
\begin_inset Formula $\omega$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrForceCouple"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrVelCouple"

\end_inset

 equal to the radius of a bacterial cell that we are modelling.
 Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrForceCouple"

\end_inset

 then spreads the force over a volume that is slightly larger than the cell,
 ensuring that the entire space occupied by the cell in the fluid is influenced
 by the force.
 The second reason we use this scaling is because, during the mesh refinement
 analysis described in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Eulerian-Grid-Refinement"

\end_inset

, we discovered that the implementation with the scaling by 
\begin_inset Formula $h$
\end_inset

 restricts us to less than first-order convergence of the velocity, 
\begin_inset Formula $\mathbf{u}$
\end_inset

.
 Using a scaling that is independent of the mesh-width fixes this issue
 and leads to greater than first order convergence.
 We also note that this class of modification is not a new practice and
 was used by Lim and Peskin to improve accuracy and to introduce material
 length scales in IBM in 
\begin_inset CommandInset citation
LatexCommand citep
key "LimPeskin2012"

\end_inset

.
 However, using 
\begin_inset Formula $\tilde{\delta}$
\end_inset

 in place of 
\begin_inset Formula $\delta_{h}$
\end_inset

, these conditions are simultaneously satisfied only when 
\begin_inset Formula $\omega=n\, h$
\end_inset

 for some 
\begin_inset Formula $n\in\mathbb{N}^{+}$
\end_inset

.
 In practice, this is not a major concern as many IBM formulations use a
 Dirac delta approximation that satisfies the unity condition, but does
 not satisfy the first-moment condition.
 Accordingly, we choose the function 
\begin_inset Formula 
\begin{equation}
\phi(r)=\phi_{2}=\left\{ \begin{array}{cc}
\frac{1}{4}\left(1+\cos\left(\frac{\pi r}{2}\right)\right); & \textrm{if }|r|\le2,\\
0; & \textrm{if }|r|>2.
\end{array}\right.\label{eq:PhiCosAlternative}
\end{equation}

\end_inset

as is done in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhu2002"

\end_inset

 because it is a better match with the choices made for 
\begin_inset Formula $\omega$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

.
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
For a thorough analysis of the errors induced by using 
\begin_inset Formula $\tilde{\delta}$
\end_inset

, we direct the interested reader to 
\begin_inset CommandInset citation
LatexCommand cite
key "Hammond2012phd,HammondBiofilms"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Elastic Forces and Breaking Criteria
\end_layout

\begin_layout Standard
For a model of the elastic forces, we follow 
\begin_inset CommandInset citation
LatexCommand citep
key "AlpkvistKlapper2007WST"

\end_inset

 who used Hooke's Law to describe the elastic force between the connected
 Lagrangian nodes.
 Thus, the elastic force on each Lagrangian point using Hooke's Law is
\begin_inset Formula 
\begin{equation}
\mathbf{F}^{n}(s)=\sum_{k=1}^{\eta}I_{s,k}\frac{\mathbf{d}_{s,k}}{d_{s,k}}T_{s,k}\,,\label{eq:springF}
\end{equation}

\end_inset

where 
\begin_inset Formula $T$
\end_inset

 is the tension between nodes 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $k$
\end_inset

, 
\begin_inset Formula $I$
\end_inset

 is the connectivity matrix defined as 
\begin_inset Formula 
\begin{eqnarray*}
I_{s,k} & = & \left\{ \begin{array}{cc}
1 & \textrm{ bacteria }s\textrm{ connected to bacteria }k\\
0 & \textrm{otherwise}\:,
\end{array}\right.
\end{eqnarray*}

\end_inset

and 
\begin_inset Formula $\mathbf{d}_{s,k}$
\end_inset

 is the vector pointing from Lagrangian node 
\begin_inset Formula $s$
\end_inset

 to 
\begin_inset Formula $k$
\end_inset

 with magnitude 
\begin_inset Formula $d_{s,k}$
\end_inset

.
 The tension from the spring connecting node 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $k$
\end_inset

 is formulated as 
\begin_inset Formula 
\[
T_{s,k}=K_{s,k}(d_{s,k}-r_{s,k}),
\]

\end_inset

where 
\begin_inset Formula $r_{s,k}$
\end_inset

 is the rest length of the spring connecting nodes 
\begin_inset Formula $s$
\end_inset

 and 
\begin_inset Formula $k$
\end_inset

, and 
\begin_inset Formula $K_{s,k}$
\end_inset

 is its Hookean spring coefficient.
 We choose to define each spring coefficient as
\begin_inset Formula 
\begin{equation}
K_{s,k}=\frac{F_{max}}{r_{s,k}},\label{eq:defineK}
\end{equation}

\end_inset

where 
\begin_inset Formula $F_{max}$
\end_inset

 is the force required to break the spring.
 We define the spring coefficients in this way to ensure that all of the
 springs, regardless of initial length, break with a force of 
\begin_inset Formula $F_{max}$
\end_inset

 when they are stretched to a length of 
\begin_inset Formula $2r_{s,k}$
\end_inset

.
 In our simulations, we vary 
\begin_inset Formula $F_{max}$
\end_inset

 to attain specific results (such as detachment; see 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Discussion-of-Elastic"

\end_inset

 more details).
 As is done in 
\begin_inset CommandInset citation
LatexCommand citep
key "AlpkvistKlapper2007WST"

\end_inset

, we model the failure of the ECM by breaking the connections between the
 Lagrangian nodes as the springs used to connect them exceed twice their
 resting length.
 We note that this condition, however, is not based on experimental evidence,
 and in future work we will adapt this breaking criteria according to experiment
al results.
 In 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:FW"

\end_inset

, we discuss future adaptations to the breaking criteria in terms of the
 yield stress of polymers.
 
\end_layout

\begin_layout Subsection
Variable Viscosity
\begin_inset CommandInset label
LatexCommand label
name "sub:varVisc"

\end_inset


\end_layout

\begin_layout Standard
It is known that ECM density decreases with distance from an individual
 cell.
 To account for this, the exact form of 
\begin_inset Formula $\mu(\mathbf{x})$
\end_inset

 used in our simulations is
\begin_inset Formula 
\begin{equation}
\mu(\mathbf{x})=\max_{1\le s\le\eta,\, s\in\mathbb{N}}\left[\left(2\omega\right)^{D}\left(\mu_{max}-\mu_{out}\right)\tilde{\delta}(\mathbf{x}-\mathbf{X}(s),\,\omega)+\mu_{out}\right],\label{eq:ViscExp}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu_{max}$
\end_inset

 is the viscosity at a bacterial node, 
\begin_inset Formula $\mu_{out}$
\end_inset

 is the viscosity of the surrounding fluid, 
\begin_inset Formula $D$
\end_inset

 is the spatial dimension, and 
\begin_inset Formula $\omega$
\end_inset

 is a parameter we can use to stretch the influence of the additional viscosity.
 We made this choice for 
\begin_inset Formula $\mu(\mathbf{x})$
\end_inset

 because we wanted a viscosity that would decrease at the same rate as the
 elastic force with the distance from the bacterial cell.
 To illustrate how the viscosity will decay, in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ViscEx"

\end_inset

 we depict a 1D example of the effect of 
\begin_inset Formula $\omega$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

 on the viscosity distribution, 
\begin_inset Formula $\mu(\mathbf{x})$
\end_inset

, from 
\emph on
two
\emph default
 interacting cells.
 In the subsequent work, we will change this function to suit the specific
 viscous properties of the particular biofilm.
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename ViscExh_1_32.eps
	width 40col%

\end_inset

(b)
\begin_inset Graphics
	filename ViscExh_1_64.eps
	width 40col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename ViscExh_1_128.eps
	width 40col%

\end_inset

(d)
\begin_inset Graphics
	filename ViscExh_1_512.eps
	width 40col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ViscEx"

\end_inset

Examples of 1D 
\begin_inset Formula $\mu(x)$
\end_inset

 with two Lagrangian nodes, one at 
\begin_inset Formula $x=\nicefrac{5}{32}$
\end_inset

 on an Eulerian node and the other at 
\begin_inset Formula $x=\frac{5}{32}+\frac{2\pi}{150}$
\end_inset

, with 
\begin_inset Formula $\omega=\frac{1}{50}$
\end_inset

.
 These Lagrangian nodes (cells) are close enough that there is a region
 of interaction.
 These plots illustrate the effect of using different spatial steps: (a)
 
\begin_inset Formula $h=\frac{1}{32}$
\end_inset

, (b) 
\begin_inset Formula $h=\frac{1}{64}$
\end_inset

 (c) 
\begin_inset Formula $h=\frac{1}{128}$
\end_inset

 (d) 
\begin_inset Formula $h=\frac{1}{512}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Solution Strategy
\end_layout

\begin_layout Standard
We employ a 
\shape italic
projection method
\shape default
 (
\begin_inset CommandInset citation
LatexCommand citep
key "BrownCortezMinion2001"

\end_inset

) to solve the incompressible Navier-Stokes equations numerically, building
 on the method used by 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhu2002"

\end_inset

.
 This method introduces a velocity field (at an intermediate time), 
\begin_inset Formula $\mathbf{\tilde{u}}(\mathbf{x},\, t)$
\end_inset

, which is the solution to the difference equation
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\rho^{n}\left(\sigma\frac{\tilde{\mathbf{u}}_{k}^{n+1}-\mathbf{u}_{k}^{n}}{\triangle t}+\frac{1}{2}(\mathbf{u}\cdot\mathbf{D}^{0}\mathbf{u}_{k}+\mathbf{D}^{0}\cdot(\mathbf{u}\mathbf{u}_{k}))^{n}\right)\qquad\qquad\qquad\qquad\qquad\\
\qquad\qquad\qquad\qquad=\frac{1}{Re}\mathbf{D}^{0}\cdot\left(\mu^{n}\left(\mathbf{D}^{0}\tilde{\mathbf{u}}_{k}^{n+1}+D_{h,k}^{0}\tilde{\mathbf{u}}^{n+1}\right)\right)+\frac{Lf_{0}}{\rho_{0}u_{0}^{2}}\mathbf{f}_{k}^{n}\,,
\end{array}\label{eq:NSdis1-1}
\end{equation}

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
where 
\begin_inset Formula $k$
\end_inset

 denotes the 
\begin_inset Formula $k^{\textrm{th}}$
\end_inset

 component of that vector.
 In this discretization, 
\begin_inset Formula $\mathbf{D}^{0}\cdot(a\mathbf{D}^{0}\phi)$
\end_inset

 is defined for scalar functions
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 
\begin_inset Formula $a(\mathbf{x})$
\end_inset

 and 
\begin_inset Formula $\phi(\mathbf{x})$
\end_inset

 using the midpoint values of 
\begin_inset Formula $a$
\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\mathbf{D}^{0}\cdot\left(a\mathbf{D}^{0}\phi\right)=\sum_{i=1}^{3}\frac{a\left(\mathbf{x}+\frac{h}{2}\mathbf{e}_{i}\right)\frac{\phi(\mathbf{x}+h\mathbf{e}_{i})-\phi(\mathbf{x})}{h}-a\left(\mathbf{x}-\frac{h}{2}\mathbf{e}_{i}\right)\frac{\phi(\mathbf{x})-\phi(\mathbf{x}-h\mathbf{e}_{i})}{h}}{h}\,,\label{eq:divergenceGrad}
\end{equation}

\end_inset

 and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\mathbf{D}^{0}\cdot\left(aD_{h,k}^{0}\mathbf{u}\right)$
\end_inset

 is defined as
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula 
\begin{eqnarray}
\mathbf{D}^{0}\cdot\left(aD_{h,k}^{0}\mathbf{u}\right) & = & \frac{a\left(\mathbf{x}+\frac{h}{2}\mathbf{e}_{k}\right)\frac{\mathbf{u}_{k}(\mathbf{x}+h\mathbf{e}_{k})-\mathbf{u}_{k}(\mathbf{x})}{h}-a\left(\mathbf{x}-\frac{h}{2}\mathbf{e}_{k}\right)\frac{\mathbf{u}_{k}(\mathbf{x})-\mathbf{u}_{k}(\mathbf{x}-h\mathbf{e}_{k})}{h}}{h}+\nonumber \\
 &  & +\sum_{i\ne k}^{3}\left(\frac{a\left(\mathbf{x}+h\mathbf{e}_{i}\right)\frac{\mathbf{u}_{i}(\mathbf{x}+h\mathbf{e}_{i}+h\mathbf{e}_{k})-\mathbf{u}_{i}(\mathbf{x}+h\mathbf{e}_{i}-h\mathbf{e}_{k})}{2h}}{2h}\right.\label{eq:divergencePartial}\\
 &  & -\left.\frac{a\left(\mathbf{x}-h\mathbf{e}_{i}\right)\frac{\mathbf{u}_{i}(\mathbf{x}-h\mathbf{e}_{i}+h\mathbf{e}_{k})-\mathbf{u}_{i}(\mathbf{x}-h\mathbf{e}_{i}-h\mathbf{e}_{k})}{2h}}{2h}\right)\,.\nonumber 
\end{eqnarray}

\end_inset


\shape up
To complete the discretized incompressible Navier-Stokes system, we have
 the following two equations:
\begin_inset Formula 
\begin{eqnarray}
\sigma\rho^{n}\left(\frac{\mathbf{u}^{n+1}-\mathbf{\tilde{u}}^{n+1}}{\triangle t}\right) & = & -\varepsilon\mathbf{D}^{0}p^{n+1}\,,\label{eq:NSdis2}\\
\mathbf{D}^{0}\cdot\mathbf{u}^{n+1} & = & 0\,.\label{eq:NSdis3}
\end{eqnarray}

\end_inset

We point out here that summing Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis1-1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis2"

\end_inset

 leads to the discretized version of Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-SnondimFull"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-SnondimFull2"

\end_inset

, with the exception that the evaluation of the viscous term is at the intermedi
ate value of the velocity 
\begin_inset Formula $\tilde{\mathbf{u}}^{n+1}$
\end_inset

.
 We solve for pressure by applying 
\begin_inset Formula $\mathbf{D}^{0}$
\end_inset

 to both sides of Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis2"

\end_inset

 and using Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis3"

\end_inset

 to obtain
\begin_inset Formula 
\begin{equation}
\mathbf{D}^{0}\cdot\left(\frac{1}{\rho^{n}}\mathbf{D}^{0}p^{n+1}\right)=\frac{\sigma}{\varepsilon}\frac{\mathbf{D}^{0}\cdot\tilde{\mathbf{u}}^{n+1}}{\Delta t}.\label{eq:NSdis4}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
To solve equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis1-1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis4"

\end_inset

, we use Gauss-Seidel as a smoother in a multigrid solver.
 At each time step, we solve Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-SnondimFull"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:N-SnondimFull2"

\end_inset

 for 
\begin_inset Formula $\mathbf{\tilde{u}}^{n+1}$
\end_inset

, substitute it into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis4"

\end_inset

, solve for 
\begin_inset Formula $p^{n+1}$
\end_inset

, and finally solve for 
\begin_inset Formula $u^{n+1}$
\end_inset

 using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis2"

\end_inset

.
 Then the velocity is transferred from the Eulerian points to the Lagrangian
 points using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrVelCouple"

\end_inset

.
 With 
\begin_inset Formula $\mathbf{U}^{n+1}$
\end_inset

 computed, the new Lagrangian node locations are computed using Euler's
 method as
\begin_inset Formula 
\[
\mathbf{X}^{n+1}(s)=\frac{\Delta t}{\sigma}\mathbf{U}^{n+1}(s)+\mathbf{X}^{n}(s).
\]

\end_inset

The forces between the Lagrangian points are then recalculated and transferred
 to the Eulerian points using Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrForceCouple"

\end_inset

.
 Finally, the values of 
\begin_inset Formula $\rho^{n}$
\end_inset

 and 
\begin_inset Formula $\mu^{n}$
\end_inset

 are evaluated using the new Lagrangian locations.
\end_layout

\begin_layout Subsection
Multigrid
\end_layout

\begin_layout Standard
In this section, we discuss the elements of multigrid that we use in our
 solution strategy.
 For more details on multigrid, see 
\begin_inset CommandInset citation
LatexCommand citep
key "Briggs2000"

\end_inset

.
 
\end_layout

\begin_layout Standard
In our solver, we use the conventional Gauss-Seidel iterative method with
 red-black ordering.
 In the multigrid scheme, we use full-weighting restriction to go from fine
 to coarse grids, and we use linear interpolation to go from coarse back
 to fine grids.
 The finest grid is the grid with step size 
\begin_inset Formula $h$
\end_inset

 and the grids become coarser by increasing the step size by a factor of
 2.
 This halves the number of nodes in each dimension, allowing for significantly
 faster computations on the coarser grids.
 The number of levels in the multigrid solver depends on both the dimensions
 of the computational domain as well as 
\begin_inset Formula $h$
\end_inset

.
 In our simulations, we iterate using multigrid V-cycles until we reach
 a sufficiently low value for the norm of the residual, 
\begin_inset Formula 
\[
\left\Vert f^{h}-A^{h}\tilde{v}^{h}\right\Vert ,
\]

\end_inset

at each time step.
 Here, 
\begin_inset Formula $A^{h}v^{h}=f^{h}$
\end_inset

 is the linear discretization of a PDE, and the residual is 
\begin_inset Formula $r^{h}=f^{h}-A^{h}\tilde{v}^{h}$
\end_inset

, where 
\begin_inset Formula $\tilde{v}$
\end_inset

 is an approximation to 
\begin_inset Formula $v$
\end_inset

.
 The residual provides a bound on the true error in the solution of the
 linear system since we have this relationship between the error and the
 relative residual error:
\begin_inset Formula 
\begin{equation}
\frac{\left\Vert e^{h}\right\Vert }{\left\Vert v^{h}\right\Vert }\le cond(A^{h})\frac{\left\Vert r^{h}\right\Vert }{\left\Vert f^{h}\right\Vert }\,,\label{eq:resCondrelationship}
\end{equation}

\end_inset

where 
\begin_inset Formula $e^{h}=v^{h}-\tilde{v}^{h}$
\end_inset

, 
\begin_inset Formula $r^{h}=f^{h}-A^{h}\tilde{v}^{h}$
\end_inset

, and 
\begin_inset Formula $cond(A^{h})$
\end_inset

 is the condition number of 
\begin_inset Formula $A^{h}$
\end_inset

.
 In 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Validation"

\end_inset

, we give approximations for the condition numbers for our matrices.
\end_layout

\begin_layout Subsection
Boundary Conditions
\end_layout

\begin_layout Standard
The computational domain used in our example simulations is a section of
 a tube with the biofilm centered in the direction along the axis of the
 tube (see sigure in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset

 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Simulations-Results"

\end_inset

).
 In the 2D case, flow is along the 
\begin_inset Formula $x$
\end_inset

-axis and, in 3D, it is along the 
\begin_inset Formula $z$
\end_inset

-axis.
 The boundary conditions we used in these simulations were derived from
 exact solutions for the velocity and pressure in the case of laminar flow.
 We now provide the boundary conditions in both the 2D and 3D cases.
\end_layout

\begin_layout Subsubsection
2D Boundaries
\begin_inset CommandInset label
LatexCommand label
name "sub:2D-Boundaries"

\end_inset


\end_layout

\begin_layout Standard
The no-slip boundary condition exists at the walls of tube and requires
 that the velocity be zero there, so we use that as the boundary condition
 at the walls.
 The velocity at the upstream boundary (
\begin_inset Formula $x=0$
\end_inset

) is held at the conventional laminar flow velocity given by 
\begin_inset Formula 
\begin{equation}
u_{1}(y)=\frac{\kappa}{2\mu}(y^{2}-2ay),\label{eq:2DlaminarSoln}
\end{equation}

\end_inset

where 
\begin_inset Formula $a$
\end_inset

 is the radius of the tube, 
\begin_inset Formula $y$
\end_inset

 is the displacement from the bottom edge of the tube, 
\begin_inset Formula $\kappa$
\end_inset

 is the linear rate at which the pressure decreases through the tube, and
 
\begin_inset Formula $u_{1}$
\end_inset

 is the x-component of the velocity (i.e., 
\begin_inset Formula $\mathbf{u}=\left(u_{1},\, u_{2}\right)$
\end_inset

).
 At the downstream boundary, a Neumann condition is applied to the velocity
 by enforcing that 
\begin_inset Formula 
\[
\left(\frac{\partial}{\partial x}\mathbf{u}(x,y)\right)_{x=x_{down}}=0\qquad\forall y,
\]

\end_inset

where 
\begin_inset Formula $x_{down}$
\end_inset

 represents the 
\begin_inset Formula $x$
\end_inset

 value at the downstream boundary.
\end_layout

\begin_layout Standard
The boundary conditions for pressure come from the laminar flow equation
 for pressure given by
\begin_inset Formula 
\begin{equation}
p(x)=\kappa x+p(0).\label{eq:pressLam}
\end{equation}

\end_inset

In our simulations, we hold the pressure at the upstream boundary at 
\begin_inset Formula $p(0)$
\end_inset

 and at 
\begin_inset Formula $p(x_{down})$
\end_inset

 at the downstream.
 At the top boundary, we hold the pressure at the values given by Equation
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:pressLam"

\end_inset

 and, at the bottom boundary (the boundary on which the biofilm is attached),
 we use a Neumann boundary
\begin_inset Formula 
\[
\left(\frac{\partial}{\partial y}p(x,y)\right)_{y=0}=0,\qquad\forall x.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
3D Boundaries
\end_layout

\begin_layout Standard
In the 3D simulations, we orient the square tube along the 
\begin_inset Formula $z$
\end_inset

-axis.
 The no-slip boundary condition exists at the walls of tube and requires
 that the velocity be zero there so we use that as the boundary condition
 at the walls.
 Derived by 
\begin_inset CommandInset citation
LatexCommand citep
key "Spiga1994"

\end_inset

, the velocity at the upstream boundary is held at the laminar flow velocity
 given by 
\begin_inset Formula 
\begin{equation}
u_{3}(x,y)=-\frac{16\kappa a^{2}}{\mu\pi^{4}}\sum_{n,m>0,\,\textrm{odd}}\frac{\sin\left(n\pi\nicefrac{x}{a}\right)\sin\left(m\pi\nicefrac{y}{a}\right)}{nm\left(n^{2}+m^{2}\right)},\label{eq:3DlaminarFlow}
\end{equation}

\end_inset

where 
\begin_inset Formula $a$
\end_inset

 is the width of the tube and 
\begin_inset Formula $u_{3}$
\end_inset

 is the z-component of the velocity (i.e., 
\begin_inset Formula $\mathbf{u}=\left(u_{1},\, u_{2},\, u_{3}\right)$
\end_inset

).
 At the downstream boundary, a Neumann condition is applied to the velocity
 by enforcing that 
\begin_inset Formula 
\[
\left(\frac{\partial}{\partial z}\mathbf{u}(x,y,z)\right)_{z=z_{down}}=0\qquad\forall x,\, y.
\]

\end_inset


\end_layout

\begin_layout Standard
The boundary conditions for pressure come from the laminar flow equation
 for pressure given by
\begin_inset Formula 
\begin{equation}
p(z)=\kappa z+p(0),\label{eq:pressLam3D}
\end{equation}

\end_inset

where 
\begin_inset Formula $z=0$
\end_inset

 is the upstream boundary.
 In our simulations, we hold the pressure at the upstream boundary at 
\begin_inset Formula $p(0)$
\end_inset

 and at 
\begin_inset Formula $p(z_{down})$
\end_inset

 at the downstream.
 At the top and side boundaries, we hold the pressure at the values given
 by Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:pressLam3D"

\end_inset

 and, at the bottom boundary (side with attached biofilm), we use the Neumann
 condition given by
\begin_inset Formula 
\[
\left(\frac{\partial}{\partial y}p(x,y,z)\right)_{y=0}=0\qquad\forall x,\, z.
\]

\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Validation"

\end_inset

Convergence 
\end_layout

\begin_layout Standard
In this section, we provide numerical evidence for the convergence of our
 simulation strategy.
 For the purposes of the 2D and 3D convergence analysis conducted in later
 sections, we require the following notation.
 We present the following notation in 3D (the 2D versions are analogous
 but without the 
\begin_inset Formula $z$
\end_inset

 elements).
 Define the 
\shape italic
Eulerian grid function 
\begin_inset Formula $p$
\end_inset

-norm
\shape default
 for an arbitrary 3D vector field, 
\begin_inset Formula $\mathbf{w}(\mathbf{x})=(w_{1}(\mathbf{x}),w_{2}(\mathbf{x}),w_{3}(\mathbf{x}))$
\end_inset

, by
\begin_inset Formula 
\begin{equation}
\left\Vert \mathbf{w}\right\Vert _{p}=\left(\sum_{i,j,k}\left|\mathbf{w}(x_{i},y_{j},z_{k})\right|{}^{p}h^{D}\right)^{\nicefrac{1}{p}},\label{eq:EulPnorm}
\end{equation}

\end_inset

where 
\begin_inset Formula $D$
\end_inset

 is the spatial dimension, 
\begin_inset Formula $1\le p<\infty$
\end_inset

, and 
\begin_inset Formula 
\[
\left|\mathbf{w}(x_{i},y_{j},z_{k})\right|=\sqrt{w_{1}(x_{i},y_{j},z_{k})^{2}+w_{2}(x_{i},y_{j},z_{k})^{2}+w_{3}(x_{i},y_{j},z_{k})^{2}}.
\]

\end_inset

Then 
\begin_inset Formula 
\[
\left\Vert \mathbf{w}\right\Vert _{\infty}=\max_{i,j,k}\left|\mathbf{w}(x_{i},y_{j},z_{k})\right|.
\]

\end_inset

Additionally, on the Lagrangian grid define the 
\shape italic
Lagrangian grid function 
\begin_inset Formula $p$
\end_inset

-norm
\shape default
 for a vector field, 
\begin_inset Formula $\mathbf{X}=(X_{1}(s),X_{2}(s),X_{3}(s))$
\end_inset

, as 
\begin_inset Formula 
\[
\left\Vert \mathbf{X}\right\Vert _{p}=\left(\sum_{s=1}^{\eta}\left|\left(X_{1}(s),\, X_{2}(s),\, X_{3}(s)\right)\right|^{p}d_{0}^{D}\right)^{\nicefrac{1}{p}},
\]

\end_inset

where 
\begin_inset Formula $1\le p<\infty$
\end_inset

 and 
\begin_inset Formula $d_{0}^{D}$
\end_inset

 is the average volume element of the Lagrangian nodes.
 Then 
\begin_inset Formula 
\[
\left\Vert \mathbf{X}\right\Vert _{\infty}=\max_{1\le s\le\eta}\left|\left(X_{1}(s),\, X_{2}(s),\, X_{3}(s)\right)\right|.
\]

\end_inset

Note that both of these grid function norms are derived from using discretizatio
ns of the integrals used in a typical function p-norm (see Appendix A of
 
\begin_inset CommandInset citation
LatexCommand citep
key "LeVeque2007"

\end_inset

 for more details).
 
\end_layout

\begin_layout Standard
There are three parts to our simulation validation process: 1) we illustrate
 that in the absence of the biofilm our numerical simulation converges to
 the analytical solution; 2) we verify that our multigrid technique is correctly
 accelerating the convergence of our chosen relaxation scheme; and 3) we
 determine the convergence rate of the simulations with a biofilm using
 a mesh refinement convergence analysis.
 
\end_layout

\begin_layout Standard
Before discussing the results of our validation process, we provide a brief
 description of the two primary sources of error present in our simulations,
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Discussion-of-Errors"

\end_inset

.
 We also setup our simulations with a detailed description of initial Lagrangian
 node positions in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:SimSetup"

\end_inset

.
 Then we provide 2D simulation validation in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Two-Dimensional-Validation"

\end_inset

 and 3D validation in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Three-Dimensional-Validation"

\end_inset

.
 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Discussion-of-Errors"

\end_inset

Discussion of Errors
\end_layout

\begin_layout Standard
In our numerical scheme, we have two sources of error: 1) 
\shape italic
discretization error
\shape default
 is introduced by discretizing the Navier-Stokes equations in space and
 time; and 2) 
\shape italic
algebraic error
\shape default
 is introduced when we attempt to solve the resultant systems of linearized
 equations.
 
\end_layout

\begin_layout Standard
As it is impossible to compute the true algebraic error, we use the norm
 of the residual to deduce an upper bound on the algebraic error using Equation
 
\shape up

\begin_inset CommandInset ref
LatexCommand ref
reference "eq:resCondrelationship"

\end_inset


\shape default
.
 Recall that Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:resCondrelationship"

\end_inset

 indicates that the relative algebraic error at each timestep is no larger
 than the condition number of the matrix times the relative residual norm
 (
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
recall that 
\begin_inset Formula $\frac{\left\Vert r\right\Vert }{\left\Vert f\right\Vert }$
\end_inset

 is the relative residual norm)
\family default
\series default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
.
 We do not construct these matrices during the actual simulations because
 we do not need them to solve the systems.
 However, we did construct them to find their condition numbers and found
 that the condition numbers for the matrices used in the computations for
 
\begin_inset Formula $\tilde{\mathbf{u}}^{n+1}$
\end_inset

 and 
\begin_inset Formula $p^{n+1}$
\end_inset

 are 
\begin_inset Formula $O\left(h^{-2}\right)$
\end_inset

 (this is true for both 2D and 3D simulations).
 The simulations that resulted in the plots given in 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Two-Dimensional-Simulations"

\end_inset

 and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Three-Dimensional-Simulations"

\end_inset

 were run using 
\begin_inset Formula $h=\frac{1}{128}$
\end_inset

, and thus the matrix condition numbers were approximately 
\begin_inset Formula $10^{4}$
\end_inset

.
\end_layout

\begin_layout Standard

\shape up
Our goal in the simulations is to ensure that the algebraic error falls
 well below the discretization error at each time step, so the total error
 will be dominated by the discretization error.
 In theory, the discretization error is at best 
\begin_inset Formula $O(h^{2})\approx C\left(\nicefrac{1}{128}\right)^{2}$
\end_inset


\begin_inset Formula $\approx C\times6\times10^{-5}$
\end_inset

, for 
\begin_inset Formula $C>0$
\end_inset

, with our discretization.
 Using a stopping criteria of 
\begin_inset Formula $10^{-9}$
\end_inset

 for the relative residual at each timestep should suffice (i.e., from Equation
 
\shape default

\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:resCondrelationship"

\end_inset

).
 
\shape up
We continue to the next time step only when the computed relative residual,
 
\begin_inset Formula $\frac{\left\Vert r^{h}\right\Vert }{\left\Vert f^{h}\right\Vert }\le10^{-9}$
\end_inset

, because this implies 
\begin_inset Formula $\left\Vert e^{h}\right\Vert \le cond(A)*10^{-9}\approx10^{-5}$
\end_inset

.
 
\end_layout

\begin_layout Standard

\shape up
Another factor influencing the capability of our simulations is that after,
 extensive simulation, we discover that our linear solver is limited to
 converging to a relative residual norm of about 
\begin_inset Formula $10^{-11}$
\end_inset

 (possibly from machine precision issues).
 With 
\begin_inset Formula $h=\frac{1}{512}$
\end_inset

, the condition number is 
\begin_inset Formula $O(10^{5})$
\end_inset

 and the discretization error is 
\begin_inset Formula $O(10^{-6})$
\end_inset

, so the algebraic error is at best bounded by about 
\begin_inset Formula $10^{-11}\times10^{5}=10^{-6}$
\end_inset

 (see Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:resCondrelationship"

\end_inset

), and we can no longer be certain that the algebraic error falls below
 the discretization error at each timestep.
 For this reason, we restrict 
\begin_inset Formula $h$
\end_inset

 to be larger than 
\begin_inset Formula $\frac{1}{512}$
\end_inset

 in all of the simulations and convergence analysis.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:SimSetup"

\end_inset

Simulation Setup
\end_layout

\begin_layout Standard
In these convergence simulations, we constructed an experimentally motivated
 mushroom shaped biofilm (shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Mushroom-shaped-biofilm2Dsims"

\end_inset

(a)).
 We carved this shape from a 
\begin_inset Formula $1.6\,\mu\textrm{m}$
\end_inset

 slice cut from data points generated in the Younger and Solomon labs at
 the University of Michigan.
 These data points are 3D bacterial cell locations from 3D Leica SP2 confocal
 laser scanning microscopy images taken of 
\shape italic
Staphylococcus epidermidis
\shape default
 RP62A (ATCC 35984) grown in a Stovall 3 channel flow cell for 24 hours
 at 37
\begin_inset Formula $^{\circ}$
\end_inset

C in tryptic soy broth with 1% glucose added under a wall shear stress of
 
\begin_inset Formula $0.01\,\textrm{Pa}$
\end_inset

.
 For further details of how the coordinates were computed, see 
\begin_inset CommandInset citation
LatexCommand citep
key "Stewart"

\end_inset

.
\end_layout

\begin_layout Standard
From this data, the average Lagrangian volume element, 
\begin_inset Formula $d_{0}^{3}$
\end_inset

, is calculated to be approximately 
\begin_inset Formula $4.036\,\mu\textrm{m}^{3}$
\end_inset

, and thus we use 
\begin_inset Formula $d_{0}=1.59\,\mu\textrm{m}$
\end_inset

 in both the 2D and 3D simulations.
 We connect the initial distribution of cells with a distance based connection
 criteria.
 Our inspiration for the connection distance criteria came from the closeup
 images of biofilms such as the one shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:BiofilmPicture"

\end_inset

.
 We observed that each bacterial cell is connected to neighboring cells
 that are within about 
\begin_inset Formula $2d_{0}$
\end_inset

.
 Thus, we varied the connection criteria in our algorithm between 
\begin_inset Formula $1.5$
\end_inset

-
\begin_inset Formula $2.5\times d_{0}$
\end_inset

 in an effort to find one that resulted in a biofilm that was sufficiently
 connected but not overcrowded.
 This resulted in the choice of a connection criteria of 
\begin_inset Formula $d_{c}=2.8\,\mu\textrm{m}$
\end_inset

.
 In other words, we placed spring connections between Lagrangian nodes at
 the beginning of the simulation with every node connected to every other
 node less than 
\begin_inset Formula $2.8\,\mu\textrm{m}$
\end_inset

 away.
 Admittedly, this value of 
\begin_inset Formula $d_{c}$
\end_inset

 is arbitrary, and future work will include deriving a method to determine
 this connection criteria through image analysis of closeup images of biofilms
 similar to 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:BiofilmPicture"

\end_inset

.
 The mushroom shaped biofilm has a height of about 
\begin_inset Formula $8.5\,\mu\textrm{m}$
\end_inset

 and width of about 
\begin_inset Formula $8\,\mu\textrm{m}$
\end_inset

 (see 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Mushroom-shaped-biofilm2Dsims"

\end_inset

).
 In the convergence simulations, the maximum spring force, 
\begin_inset Formula $F_{max}$
\end_inset

, is set to 
\begin_inset Formula $5\times10^{-6}\,\textrm{N}$
\end_inset

.
 The fluid parameters for these convergence simulations are provided later
 in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: 2D sim params"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename Easyshroom2DnoAddl_t_0.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename sample3Dbiofilm1.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Mushroom-shaped-biofilm2Dsims"

\end_inset

Mushroom-shaped biofilm at 
\begin_inset Formula $t=0$
\end_inset

 in the middle of the computational domain attached to the bottom 
\begin_inset Formula $(y=0)$
\end_inset

 of the tube.
 (a) This is the shape used in the 2D simulations, and (b) 3D mushroom shaped
 biofilm at 
\begin_inset Formula $t=0$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $\tilde{\delta}$
\end_inset

 is a function of 
\begin_inset Formula $\omega$
\end_inset

, a scaling parameter we must choose that determines the volume/area of
 influence when the forces and density are transferred to the Eulerian grid.
 We must also point out here that a more accurate representation of the
 Dirac delta function occurs when 
\begin_inset Formula $\omega\ge h$
\end_inset

.
 Thus, for the purpose of the convergence simulations, we use 
\begin_inset Formula $\omega=1.0\,\mu\textrm{m}$
\end_inset

 in the transfer equations, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrForceCouple"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:discrDensCouple"

\end_inset

.
 However, in our simulations, we use 
\begin_inset Formula $\omega=0.5\,\mu\textrm{m}$
\end_inset

 since the actual radius of 
\shape italic
Staphylococcus epidermidis
\shape default
 is known to be about 
\begin_inset Formula $0.5\,\mu\textrm{m}$
\end_inset

 (
\begin_inset CommandInset citation
LatexCommand citep
key "Todar2012"

\end_inset

).
 Using a characteristic length of 
\begin_inset Formula $L=50\,\mu\textrm{m}$
\end_inset

, we have the non-dimensionalized 
\begin_inset Formula $\omega^{*}=\frac{\omega}{L}=\frac{1}{50}$
\end_inset

.
 Dropping the star from the dimensionless variable, we use 
\begin_inset Formula $\omega=\frac{1}{50}$
\end_inset

 in the convergence simulations and 
\begin_inset Formula $\omega=\frac{1}{100}$
\end_inset

 in the results simulations.
 We desire that 
\begin_inset Formula $\omega\ge h$
\end_inset

, so that the Lagrangian forces are spread at least two Eulerian mesh widths
 in every direction (as is done in the traditional IBM (
\begin_inset CommandInset citation
LatexCommand citep
key "Peskin2002"

\end_inset

)).
 Using 
\begin_inset Formula $\omega=\frac{1}{50}$
\end_inset

 in the convergence simulations allows 
\begin_inset Formula $h=\frac{1}{64},\,\frac{1}{128},\,\frac{1}{256}$
\end_inset

 to obey these criteria.
 We again note that one of the reasons for using 
\begin_inset Formula $\omega$
\end_inset

 in the scaling of Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Dirac Delta Approx"

\end_inset

 as opposed to 
\begin_inset Formula $h$
\end_inset

 is that better spatial convergence rates are achieved since the scaling
 is independent of 
\begin_inset Formula $h$
\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Two-Dimensional-Validation"

\end_inset

Two-Dimensional Validation
\end_layout

\begin_layout Standard
In the absence of a biofilm, we expect that using a centered finite difference
 approximation for the second derivatives allows 
\shape italic
exact
\shape default
 convergence to the second-order polynomial solution (Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:2DlaminarSoln"

\end_inset

).
 That is to say, we expect the numerical solution to converge to the analytical
 within machine precision.
 Reassuringly, we find that the biofilm-free simulations converge exactly
 to the steady state laminar flow.
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
In the 3D simulations, we do not see exact convergence since the laminar
 solution is not a second-order polynomial.
 See 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Three-Dimensional-Simulations"

\end_inset

 for details on the convergence properties of the 3D laminar flow case.
 
\end_layout

\end_inset

 To illustrate, we started with an initial velocity profile that is one-half
 of that of the laminar flow velocity profile.
 The error in the simulation converged (within machine precision) in less
 than 300 time iterations for all spatial resolutions (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2DLaminarConvergence"

\end_inset

 for example with 
\begin_inset Formula $h=\nicefrac{1}{128}$
\end_inset

 and 
\begin_inset Formula $dt=0.0001$
\end_inset

).
 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ConvergenceToLaminarFlow.eps
	width 4in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2DLaminarConvergence"

\end_inset

Exact error in biofilm-free 2D simulation with 
\begin_inset Formula $h=\frac{1}{128}$
\end_inset

.
 The solution is compared to the exact solution, 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:2DlaminarSoln"

\end_inset

, using a maximum norm.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Multigrid-performance"

\end_inset

Multigrid performance
\end_layout

\begin_layout Standard
Next, we provide numerical evidence that the multigrid technique convergences
 optimally to the solutions of Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis1-1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:NSdis4"

\end_inset

.
 We define a 
\shape italic
work unit
\shape default
 as the cost of performing one relaxation on the finest grid (see 
\begin_inset CommandInset citation
LatexCommand citep
key "Briggs2000"

\end_inset

).
 In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Work Units Decrease 2D"

\end_inset

(a), we depict (for the pressure computation) the work units required to
 reach the minimum residual error as a function of allowed levels in the
 multigrid.
 This result shows that the number of work units required decreases significantl
y with each added multigrid level.
 This means that the multigrid method correctly accelerates the convergence
 of our iterative method by doing computations on the coarser grids.
 For example, with just one allowed level of multigrid, the relaxation uses
 only the finest resolution grid and requires about 
\begin_inset Formula $10^{5}$
\end_inset

 work units, whereas with 6 multigrid levels we only require about 
\begin_inset Formula $10^{2}$
\end_inset

 work units to achieve the same error.
 Note that there is no reduction in the number of required work units with
 the addition of a 
\begin_inset Formula $7^{\textrm{th}}$
\end_inset

 level in the multigrid, so we use at most 6 levels in our 2D solvers.
 The data in this plot was obtained using our 2D simulation with a mushroom
 shaped biofilm similar to those shown in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Two-Dimensional-Simulations"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename 2DmultConvWithLevels.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename 3DmultConvWithLevels.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Work Units Decrease 2D"

\end_inset

Decrease in work units required to reach the minimum residual error as the
 number of multigrid levels is increased in the (a) 2D simulations, (b)
 and 3D simulations.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Empirical Estimate of Convergence Rate in Time
\end_layout

\begin_layout Standard
Similar to the development in 
\begin_inset CommandInset citation
LatexCommand citep
key "Mori2008"

\end_inset

, we define a measure of error by 
\begin_inset Formula 
\begin{equation}
E_{p}(q(T);\Delta t)=\left\Vert q^{\Delta t}(T)-q^{\Delta t/2}(T)\right\Vert _{p},\label{eq:ErrorTemporal}
\end{equation}

\end_inset

which is the error difference at time 
\begin_inset Formula $t=T$
\end_inset

 in a computed quantity, 
\begin_inset Formula $q$
\end_inset

, using a temporal refinement of a half timestep.
 Then, an 
\shape italic
empirical estimate
\shape default
 for the convergence rate is calculated using 
\begin_inset Formula 
\begin{equation}
r_{p}(q(T);\Delta t)=\log_{2}\left(\frac{E_{p}(q(T);\Delta t)}{E_{p}(q(T);\frac{\Delta t}{2})}\right).\label{eq:temporal convergence rate}
\end{equation}

\end_inset

We compute the approximate convergence rate in time using the 
\begin_inset Formula $E_{2}$
\end_inset

 and 
\begin_inset Formula $E_{\infty}$
\end_inset

 errors in the Eulerian variable, 
\begin_inset Formula $\mathbf{u}$
\end_inset

, and in the Lagrangian variable, 
\begin_inset Formula $\mathbf{X}$
\end_inset

.
 We simulate until 
\begin_inset Formula $t=T=0.01\,\textrm{s}$
\end_inset

 using temporal step sizes that ranged from 
\begin_inset Formula $\Delta t=\nicefrac{1}{5000}$
\end_inset

 to 
\begin_inset Formula $\Delta t=\nicefrac{1}{80000}$
\end_inset

, decreasing by a factor of 
\begin_inset Formula $2$
\end_inset

 at each level.
 The Eulerian grid is discretized with a step size of 
\begin_inset Formula $h=\nicefrac{1}{256}$
\end_inset

.
\end_layout

\begin_layout Standard
The empirical convergence rates from our temporal refinement are provided
 in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceTimeRefinement"

\end_inset

.
 The immersed boundary method, as we have implemented it, is formally second-ord
er in space and first order in time, but, for problems with sharp interfaces
 that do not have smooth solutions, it is limited to first-order accuracy
 in space and time.
 Thus for our problem we expect only first order accuracy.
 The convergence rates in time given in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceTimeRefinement"

\end_inset

 show first-order convergence in time as is expected.
 In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ErrRef"

\end_inset

(a), we depict the exact values of 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $E_{p}(q(T);\Delta t)$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 for 
\begin_inset Formula $q=\mathbf{X}$
\end_inset

 and 
\begin_inset Formula $q=\mathbf{u}$
\end_inset

.
 We show 
\begin_inset Formula $\log_{2}$
\end_inset

 in the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 axes so that the empirical convergence rates from Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceTimeRefinement"

\end_inset

 appear as the slope of the line segments.
 
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Eulerian-Grid-Refinement"

\end_inset

Empirical Estimate of Convergence Rate in Space
\end_layout

\begin_layout Standard
For this refinement study, we define a measure of error by 
\begin_inset Formula 
\begin{equation}
E_{p}(q(T);h)=\left\Vert q^{h}(T)-I_{h}^{2h}\left(q^{h/2}(T)\right)\right\Vert _{p},\label{eq:ErrorSpatial}
\end{equation}

\end_inset

which is the error difference at time 
\begin_inset Formula $t=T$
\end_inset

 in a computed quantity, 
\begin_inset Formula $q$
\end_inset

, using a spatial refinement of a half.
 In this definition, 
\begin_inset Formula $I_{h}^{2h}$
\end_inset

 is the restriction operator from a fine to a coarse grid.
 Then, an empirical estimate for the convergence rate is calculated using
 
\begin_inset Formula 
\begin{equation}
r_{p}(q(T);h)=\log_{2}\left(\frac{E_{p}(q(T);h)}{E_{p}(q(T);\frac{h}{2})}\right).\label{eq:convergenceRate}
\end{equation}

\end_inset

We note that the estimates for convergence rates given by Equations 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:temporal convergence rate"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:convergenceRate"

\end_inset

 have a fairly simple derivation using a Taylor series expansion (see 
\begin_inset CommandInset citation
LatexCommand citep
key "Ferziger2002"

\end_inset

 or 
\begin_inset CommandInset citation
LatexCommand citep
key "LeVeque2007"

\end_inset

).
 
\end_layout

\begin_layout Standard
In the spatial refinement analysis, we did not refine the Lagrangian grid
 with the Eulerian grid, so the same number of Lagrangian points were present
 in all of the simulations.
 In addition, full weighting restriction is used in the definition of the
 error, Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ErrorSpatial"

\end_inset

, for the error in 
\begin_inset Formula $\mathbf{u}$
\end_inset

.
 We also used a fixed timestep of 
\begin_inset Formula $\Delta t=10^{-4}$
\end_inset

 until 
\begin_inset Formula $t=T=0.01\,\textrm{s}$
\end_inset

 for all of these simulations.
 The computed convergence rates from this refinement are provided in Table
 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceEulerianRefinement"

\end_inset

.
 The 
\begin_inset Formula $\infty$
\end_inset

-norm convergence rates given in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceEulerianRefinement"

\end_inset

 show greater than first-order convergence in space for the error in the
 Lagrangian variable 
\begin_inset Formula $\mathbf{X}$
\end_inset

 and in the Eulerian variable 
\begin_inset Formula $\mathbf{u}$
\end_inset

.
 The seemingly large convergence rates for the lower resolution grids (
\begin_inset Formula $h=\frac{1}{16},\,\frac{1}{32},\,\frac{1}{64}$
\end_inset

 ) can be explained by the fact that using 
\begin_inset Formula $\omega=\frac{1}{50}$
\end_inset

 in the Dirac delta approximations does not allow the Lagrangian forces
 to be adequately represented in the Eulerian grid.
 This leads to larger errors in the coarse-grid simulations.
 Therefore, the best estimates for the convergence rates are the ones using
 the three resolutions all obeying 
\begin_inset Formula $\omega>h$
\end_inset

 given in the 4
\begin_inset script superscript

\begin_layout Plain Layout
th
\end_layout

\end_inset

 and 7
\begin_inset script superscript

\begin_layout Plain Layout
th
\end_layout

\end_inset

 columns of Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceEulerianRefinement"

\end_inset

.
 In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ErrRef"

\end_inset

(b), we depict the exact values of 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $E_{p}(q(T);h)$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 for 
\begin_inset Formula $q=\mathbf{X}$
\end_inset

 and 
\begin_inset Formula $q=\mathbf{u}$
\end_inset

.
 We show 
\begin_inset Formula $\log_{2}$
\end_inset

 in the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 axes so that the empirical convergence rates from Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceEulerianRefinement"

\end_inset

 appear as the slope of the line segments.
 We discuss possibilities for improvement in the convergence rates later
 in the conclusion sections.
 
\end_layout

\begin_layout Standard
We also used a grid refinement analysis to find the empirical convergence
 rate with spatial refinement when the density of the biofilm is two times
 that of the surrounding fluid.
 This analysis was done to show that the first order convergence rate is
 maintained with the increased density in the biofilms.
 The results of this convergence analysis are shown in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceEulerianRefinementDensity"

\end_inset

 and Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ErrRef"

\end_inset

(c).
\end_layout

\begin_layout Standard
Finally, we compute the empirical convergence rates for our 2D simulation
 with variable viscosity.
 In this convergence study, (
\begin_inset CommandInset ref
LatexCommand formatted
reference "tab:ConvergenceEulerianRefinementViscSpr"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:ErrRef"

\end_inset

(d)) we use a non-dimensionalized value of biofilm viscosity of 
\begin_inset Formula $\mu_{max}=500$
\end_inset

, which means that the viscosity at the location of a Lagrangian node is
 500 times that of the surrounding fluid.
 First-order convergence in space is maintained, even with this very large
 biofilm viscosity.
 
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename 2DConvRateTemporalRefineWis1_50.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename 2DConvRateSpatialRefineWis1_50.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename 2DConvRateSpatialRefineWis1_50addldens1.eps
	width 45col%

\end_inset

(d)
\begin_inset Graphics
	filename 2DConvRateSpatialRefineWis1_50addlvisc500.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ErrRef"

\end_inset

Empirical error estimates with (a) temporal refinement:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $E_{p}(q(T);\Delta t)$
\end_inset

 is the 
\begin_inset Formula $p$
\end_inset

-norm of the error as defined by 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:ErrorTemporal"

\end_inset

, (b)
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 spatial refinement with constant density and viscosity:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $E_{p}(q(T);h)$
\end_inset

 is the 
\begin_inset Formula $p$
\end_inset

-norm of the error as defined by 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:ErrorSpatial"

\end_inset

, (c) 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
spatial refinement and increased biofilm density
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
, (d) 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
spatial refinement and increased biofilm viscosity
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
.
 In all plots, 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
we show 
\begin_inset Formula $\log_{2}$
\end_inset

 in the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 axes so that the empirical convergence rate appears as the slope of the
 line segments.
 
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);2\times10^{-4})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);10^{-4})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{10^{-4}}{2})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);2\times10^{-4})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);10^{-4})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{10^{-4}}{2})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.32
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.31
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.08
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.29
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.28
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.07
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.12
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.45
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.54
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.04
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.23
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.07
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:ConvergenceTimeRefinement"

\end_inset

Empirical convergence rates with temporal refinement.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $r_{p}(q(T);dt)$
\end_inset

 is the convergence rate in the variable, 
\begin_inset Formula $q$
\end_inset

, at 
\begin_inset Formula $t=T$
\end_inset

 using the 
\begin_inset Formula $p$
\end_inset

-norm and the three time steps 
\begin_inset Formula $dt,\,\nicefrac{dt}{2},\,\nicefrac{dt}{4}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{128})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{128})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.03
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.10
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.83
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.90
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.67
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.24
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.00
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.53
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.95
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.30
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.77
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:ConvergenceEulerianRefinement"

\end_inset

Empirical convergence rates with spatial refinement.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $r_{p}(q(T);h)$
\end_inset

 is the convergence rate in the variable, 
\begin_inset Formula $q$
\end_inset

, at 
\begin_inset Formula $t=T$
\end_inset

 using the 
\begin_inset Formula $p$
\end_inset

-norm and the three Eulerian step sizes 
\begin_inset Formula $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{128})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{128})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.42
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.43
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.19
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.01
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.54
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.23
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.50
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.97
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.63
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.19
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.92
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.63
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:ConvergenceEulerianRefinementDensity"

\end_inset

Empirical convergence rates with spatial refinement and increased biofilm
 density.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $r_{p}(q(T);h)$
\end_inset

 is the convergence rate in the variable, 
\begin_inset Formula $q$
\end_inset

, at 
\begin_inset Formula $t=T$
\end_inset

 using the 
\begin_inset Formula $p$
\end_inset

-norm and the three Eulerian step sizes 
\begin_inset Formula $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$
\end_inset

.
 In this experiment, the density of the biofilm is double that of the surroundin
g fluid.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{128})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{128})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.91
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.89
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.85
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.88
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.62
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.08
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.02
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.12
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.44
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.87
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.21
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.59
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:ConvergenceEulerianRefinementViscSpr"

\end_inset

Empirical convergence rates with spatial refinement and increased biofilm
 viscosity.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $r_{p}(q(T);h)$
\end_inset

 is the convergence rate in the variable, 
\begin_inset Formula $q$
\end_inset

, at 
\begin_inset Formula $t=T$
\end_inset

 using the 
\begin_inset Formula $p$
\end_inset

-norm and the three Eulerian step sizes 
\begin_inset Formula $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$
\end_inset

.
 In this experiment the viscosity of the biofilm is 500 times that of the
 surrounding fluid.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Time-Step-Stability-Restrictions"

\end_inset

Time-Step Stability Restrictions
\end_layout

\begin_layout Standard
Finally, we investigated the stability of the method computationally as
 it depends on the spatial and temporal refinement and the stiffness of
 the springs.
 Analytically, stability applies to a numerical scheme and not to a computationa
l run, but here we follow 
\begin_inset CommandInset citation
LatexCommand citep
key "Mori2008"

\end_inset

 and give a simple definition of the stability for each computational run.
 Using the square of the 
\begin_inset Formula $2$
\end_inset

-norm defined by 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:EulPnorm"

\end_inset

 on 
\begin_inset Formula $\mathbf{u}$
\end_inset

 (i.e.
\begin_inset space ~
\end_inset


\begin_inset Formula $\left\Vert \mathbf{u}\right\Vert _{p}^{2}$
\end_inset

) gives a value which is proportional to the kinetic energy in the system.
 We call the simulation 
\shape italic
stable
\shape default
 if magnitude of the total velocity (as measured by the total kinetic energy)
 does not have a time of extreme growth during the simulation.
 Moreover, this kinetic energy should remain relatively close to the value
 of the total kinetic energy in the case of no biofilm.
 Using this definition of stability, we found, through experimentation with
 many combinations of 
\begin_inset Formula $h$
\end_inset

, 
\begin_inset Formula $\Delta t$
\end_inset

, and 
\begin_inset Formula $F_{max}$
\end_inset

, that we have timestep restrictions that scale with the mesh-width, 
\begin_inset Formula $h$
\end_inset

, and with the maximum Lagrangian force, 
\begin_inset Formula $F_{max}$
\end_inset

.
 The restrictions are approximately given by 
\begin_inset Formula 
\[
\triangle t\le C_{1}h\,
\]

\end_inset

and 
\begin_inset Formula 
\[
\triangle t\le\frac{C_{2}}{F_{max}}\,,
\]

\end_inset

where 
\begin_inset Formula $C_{1}$
\end_inset

 and 
\begin_inset Formula $C_{2}$
\end_inset

 are positive proportionality constants.
 Specific values of 
\begin_inset Formula $C_{1}$
\end_inset

 and 
\begin_inset Formula $C_{2}$
\end_inset

 change depending on the parameters of the simulation.
 In future simulations, we hope to avoid these timestep restrictions by
 using an implicit or semi-implicit method as is done in 
\begin_inset CommandInset citation
LatexCommand citep
key "Mori2008"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citep
key "Newren2007"

\end_inset

.
 All of the simulations shown in this work and used in the convergence testing
 used time-steps satisfying these two restrictions.
 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Three-Dimensional-Validation"

\end_inset

Three-Dimensional Validation
\end_layout

\begin_layout Standard
In this subsection, we provide some numerical evidence validating the 3D
 simulations.
 We first validate in the absence of a biofilm using the exact laminar flow
 solution.
 Then, we validate the multigrid method in the presence of a biofilm and,
 finally, we provide the empirical convergence rates for the simulation
 in the presence of a biofilm.
 
\end_layout

\begin_layout Standard
We first tested the rate of convergence of our method on the laminar flow
 case without the interference of a biofilm.
 To illustrate the convergence rate in the absence of a biofilm, we started
 with an initial velocity profile that is one-half of that of the laminar
 flow velocity profile, given by Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:3DlaminarFlow"

\end_inset

.
 We ran the simulation enough timesteps until the approximate solution converged
, with only discretization error remaining, to the exact solution for six
 spatial step sizes, 
\begin_inset Formula $h=\left\{ \frac{1}{4},\,\frac{1}{8},\,\frac{1}{16},\,\frac{1}{32},\,\frac{1}{64},\,\frac{1}{128}\right\} $
\end_inset

.
 We computed the discretization error (using the exact laminar solution,
 Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:3DlaminarFlow"

\end_inset

, for computations) for each of the step sizes and found that the error
 is 
\begin_inset Formula $O(h^{2})$
\end_inset

.
 This can be seen in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Laminar convergence rate"

\end_inset

, where on the vertical axis we have the 
\begin_inset Formula $\log_{2}$
\end_inset

 of the error so that the convergence rate appears as the slope in the plot.
 
\end_layout

\begin_layout Standard
Next, in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Work Units Decrease 2D"

\end_inset

(b), we depict (for the pressure computation) the work units required to
 reach the minimum residual error as a function of allowed levels in the
 multigrid approach.
 This again implies that the multigrid method correctly accelerates the
 convergence of our iterative method for the 3D simulations with a biofilm.
 Note that there is only a slight reduction in the number of required work
 units with the addition of a 
\begin_inset Formula $6^{\textrm{th}}$
\end_inset

 level in the multigrid, and we saw no reduction with 7 levels, so we use
 at most 6 levels in our 3D solvers.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Fig4.eps
	width 4in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Laminar convergence rate"

\end_inset

We show the convergence rate in the laminar flow case.
 These points are discretization errors for each of the spatial step sizes
 (
\begin_inset Formula $\frac{1}{4},\,\frac{1}{8},\,\frac{1}{16},\,\frac{1}{32},\,\frac{1}{64},\,\frac{1}{128}$
\end_inset

).
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Finally, as was done for the 2D case in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Eulerian-Grid-Refinement"

\end_inset

, we compute the empirical convergence rates for our 3D simulation in the
 presence of the biofilm shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Mushroom-shaped-biofilm2Dsims"

\end_inset

(b) with all of the same fluid parameters used in the 2D analysis.
 Using the 
\begin_inset Formula $p$
\end_inset

-norms defined above, we can compute the convergence rates using Equations
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:temporal convergence rate"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:convergenceRate"

\end_inset

 (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:EmpConvErr3D"

\end_inset

(a) and Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceTemporalRefinement3D"

\end_inset

).
 For the temporal convergence analysis, we used 
\begin_inset Formula $\omega=\frac{1}{50}$
\end_inset

 and 
\begin_inset Formula $h=\frac{1}{64}$
\end_inset

.
 This analysis resulted in first-order convergence in all measures except
 
\begin_inset Formula $r_{p}(q(T);\Delta t)$
\end_inset

 in which it has an average convergence rate of about 
\begin_inset Formula $0.6$
\end_inset

.
 Next, we found empirical convergence rates for spatial refinement (see
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceEulerianRefinement3D"

\end_inset

 and Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:EmpConvErr3D"

\end_inset

(b)).
 As expected, we observe a greater than first-order convergence rate in
 both the Eulerian velocity, 
\begin_inset Formula $\mathbf{u}$
\end_inset

, and the Lagrangian position, 
\begin_inset Formula $\mathbf{X}$
\end_inset

.
 Next, we conducted a spatial refinement analysis with a biofilm that has
 double the density of the surrounding fluid (see Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceEulerianRefinementDensity3D"

\end_inset

 and Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:EmpConvErr3D"

\end_inset

(c)).
 Finally, we did the spatial refinement study for our simulations with 
\begin_inset Formula $\mu_{max}=500$
\end_inset

, and again achieved first-order spatial convergence (see Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ConvergenceEulerianRefinementViscSpr3D"

\end_inset

 and Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:EmpConvErr3D"

\end_inset

(d)).
 
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename 3DConvRateTemporalRefineWis1_50.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename 3DConvRateSpatialRefineWis1_50.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename 3DConvRateSpatialRefineWis1_50addldens1.eps
	width 45col%

\end_inset

(d)
\begin_inset Graphics
	filename 3DConvRateSpatialRefineWis1_50addlvisc500.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:EmpConvErr3D"

\end_inset

Empirical errors in the 3D simulations with (a) temporal refinement:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $E_{p}(q(T);\Delta t)$
\end_inset

 is the 
\begin_inset Formula $p$
\end_inset

-norm of the error as defined by Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ErrorTemporal"

\end_inset

, (b)
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 spatial refinement with constant density and viscosity:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $E_{p}(q(T);h)$
\end_inset

 is the 
\begin_inset Formula $p$
\end_inset

-norm of the error as defined by Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ErrorSpatial"

\end_inset

, (c) 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
spatial refinement and increased biofilm density
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
, (d) 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
spatial refinement and increased biofilm viscosity
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
.
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
We show 
\begin_inset Formula $\log_{2}$
\end_inset

 in the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 axes so that the empirical convergence rate appears as the slope of the
 line segments.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);.0004)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);.0002)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);10^{-4})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);.0004)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);.0002)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);10^{-4})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.71
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.35
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.64
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.04
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.18
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.83
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.90
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.03
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.11
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.90
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.02
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.88
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:ConvergenceTemporalRefinement3D"

\end_inset

Empirical convergence rates in the 3D simulations with temporal refinement
 are shown for 
\begin_inset Formula $\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\mathbf{X}$
\end_inset

.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $r_{p}(q(T);\Delta t)$
\end_inset

 is the convergence rate in the variable, 
\begin_inset Formula $q$
\end_inset

, at 
\begin_inset Formula $t=T$
\end_inset

 using the 
\begin_inset Formula $p$
\end_inset

-norm and the three Eulerian step sizes 
\begin_inset Formula $\Delta t,\,\nicefrac{\Delta t}{2},\,\nicefrac{\Delta t}{4}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{16})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{16})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.46
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.47
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.11
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.97
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.98
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.99
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.25
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.84
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.11
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.91
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.75
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.17
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:ConvergenceEulerianRefinement3D"

\end_inset

Empirical convergence rates in the 3D simulations with spatial refinement
 are shown for 
\begin_inset Formula $\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\mathbf{X}$
\end_inset

.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $r_{p}(q(T);h)$
\end_inset

 is the convergence rate in the variable, 
\begin_inset Formula $q$
\end_inset

, at 
\begin_inset Formula $t=T$
\end_inset

 using the 
\begin_inset Formula $p$
\end_inset

-norm and the three Eulerian step sizes 
\begin_inset Formula $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{16})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{16})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.44
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.47
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.15
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.05
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.94
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.61
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.94
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.24
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.72
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.81
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.91
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:ConvergenceEulerianRefinementDensity3D"

\end_inset

Empirical convergence rates with 3D spatial refinement and increased biofilm
 density.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $r_{p}(q(T);h)$
\end_inset

 is the convergence rate in the variable, 
\begin_inset Formula $q$
\end_inset

, at 
\begin_inset Formula $t=T$
\end_inset

 using the 
\begin_inset Formula $p$
\end_inset

-norm and the three Eulerian step sizes 
\begin_inset Formula $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$
\end_inset

.
 In this experiment, the density of the biofilm is double that of the surroundin
g fluid.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
q
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{16})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{2}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{16})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{32})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r_{\infty}(q(T);\frac{1}{64})$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{u}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.07
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.82
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.45
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.54
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.96
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.40
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.31
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.15
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.43
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.70
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.32
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.98
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:ConvergenceEulerianRefinementViscSpr3D"

\end_inset

Empirical convergence rates with 3D spatial refinement and increased biofilm
 viscosity.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $r_{p}(q(T);h)$
\end_inset

 is the convergence rate in the variable, 
\begin_inset Formula $q$
\end_inset

, at 
\begin_inset Formula $t=T$
\end_inset

 using the 
\begin_inset Formula $p$
\end_inset

-norm and the three Eulerian step sizes 
\begin_inset Formula $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$
\end_inset

.
 In this experiment, the viscosity of the biofilm is 500 times that of the
 surrounding fluid.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This concludes our validation section, and we now present the results of
 our numerical simulations.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Simulations-Results"

\end_inset

Simulations Results
\end_layout

\begin_layout Standard
In this section, we present the results of our numerical simulations.
 First, we briefly discuss the reality of elastic forces in biofilms.
 Then we provide 2D results in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Two-Dimensional-Simulations"

\end_inset

 and 3D results in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Three-Dimensional-Simulations"

\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Discussion-of-Elastic"

\end_inset

Discussion of Elastic Maximum Force, 
\begin_inset Formula $F_{max}$
\end_inset


\end_layout

\begin_layout Standard
We now provide a brief discussion of the physical reality of the values
 of 
\begin_inset Formula $F_{max}$
\end_inset

 used in our simulations.
 The 
\shape italic
cohesive strength
\shape default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The cohesive strength is a measure of the forces that interconnect the biofilm's
 cells.
\end_layout

\end_inset

 in biofilms has been found experimentally to be highly heterogeneous, with
 repeated experimental measurements on the same biofilm yielding vastly
 different strength measurements.
 For example, 49 cohesive strength measurements taken on only two samples
 of 
\shape italic
Staphylococcus epidermidis 
\shape default
yielded measurements between 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
61-5182
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 Pa (
\begin_inset CommandInset citation
LatexCommand citep
key "Aggarwal2010"

\end_inset

).
 These biofilms were grown on a 
\begin_inset Formula $22\,\textrm{mm}$
\end_inset

 diameter disc rotating at 75 
\begin_inset Formula $\textrm{\nicefrac{rot}{min}}$
\end_inset

 so the fastest speed, 
\begin_inset Formula $\sim86\,\nicefrac{\textrm{mm}}{\textrm{s}}$
\end_inset

, was at the perimeter of the disc (i.e.
 very slow flow growth conditions).
 The 
\shape italic
adhesive
\shape default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The adhesive strength is a measure of the forces that connect a biofilm
 to the surface.
\end_layout

\end_inset

 and cohesive strengths have also been shown to vary significantly with
 changes in growth conditions such as flow rate and nutrient concentration.
 Changes in these growth conditions influence the amount of ECM production
 in the biofilm as well as the compactness of the biofilm, which has a direct
 effect on its strengths (
\begin_inset CommandInset citation
LatexCommand citep
key "Chen2005effectsAdhesiveStrength,Ohashi1996,chen1998directBiofilmStrengthTube"

\end_inset

).
 We note here that the required values we find for 
\begin_inset Formula $F_{max}$
\end_inset

 for the biofilms to remain attached in our 2D and 3D simulations are consistent
 with the cohesive strength measurements provided in 
\begin_inset CommandInset citation
LatexCommand citep
key "Aggarwal2010"

\end_inset

.
 Since the diameter of 
\shape italic
Staphylococcus epidermidis
\shape default
 is about 
\begin_inset Formula $1\,\mu$
\end_inset

m, in 3D, we multiply the cohesive strengths by 
\begin_inset Formula $1\,\mu\textrm{m}^{2}$
\end_inset

 to get an approximation for the range of forces on the surface area of
 one cell.
 Using the range of 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
61-5182
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 Pa yields a range of forces from 
\begin_inset Formula $6.1\times10^{-11}$
\end_inset

 N to 
\begin_inset Formula $5.18\times10^{-9}$
\end_inset

 N.
 In 2D, we multiply the cohesive strengths by the cell diameter to get a
 rough approximation for the range of forces on the surface perimeter surroundin
g one cell.
 Using the range of 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
61-5182
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 Pa yields a range of forces from 
\begin_inset Formula $6.1\times10^{-5}$
\end_inset

 N to 
\begin_inset Formula $5.18\times10^{-3}$
\end_inset

 N.
 Our values for 
\begin_inset Formula $F_{max}$
\end_inset

 are at the low end of these ranges.
 The actual strength of the biofilm is most likely larger than our 
\begin_inset Formula $F_{max}$
\end_inset

 values since the positional data was from a biofilm that was not fragmenting
 in the flow conditions in which it was grown, and we used the same flow
 conditions in our simulations.
 Thus, in order to see detachment under these flow conditions, we had to
 lower the value of 
\begin_inset Formula $F_{max}$
\end_inset

.
 We could alternatively increase the flow rate to necessitate a larger 
\begin_inset Formula $F_{max}$
\end_inset

 requirement to avoid detachment.
 One eventual goal of this work is that, if the approximate value of 
\begin_inset Formula $F_{max}$
\end_inset

 is known for a particular type of biofilm, then our simulations can be
 used to predict the flow rates required to break different shaped biofilms.
 
\end_layout

\begin_layout Subsection
Two-Dimensional Simulations
\begin_inset CommandInset label
LatexCommand label
name "sub:Two-Dimensional-Simulations"

\end_inset


\end_layout

\begin_layout Standard
In this section, we provide results from our 2D simulations, which represent
 a cross-section of a biofilm attached to the inside of a tube and subjected
 to fluid flow in a computational domain of 
\begin_inset Formula $150\,\mu\textrm{m}$
\end_inset

 by 
\begin_inset Formula $50\,\mu\textrm{m}$
\end_inset

.
 The parameters for our simulations are given in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: 2D sim params"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter Values for the Simulations
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tube Radius
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $25\times10^{-6}\,\textrm{m}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid Dynamic Viscosity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.0\times10^{-3}\,\nicefrac{\textrm{kg}}{\textrm{m\cdot s}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fluid Density
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum Fluid Velocity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10^{-3}\,\nicefrac{\textrm{m}}{\textrm{s}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: 2D sim params"

\end_inset

The values of parameters used in the 2D simulations.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In all simulations, we implement a breaking condition on the springs of
 two times the rest length.
 The initial configuration for the biofilm in these simulations is shown
 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Mushroom-shaped-biofilm2Dsims"

\end_inset

.
 The spring connections between Lagrangian nodes are put in place at the
 beginning of the simulation with every node connected to every other node
 less than 
\begin_inset Formula $d_{c}$
\end_inset

 away (the reason for this connection distance is given above in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:SimSetup"

\end_inset

).
 The mushroom shaped biofilm has a height of about 
\begin_inset Formula $8.5\,\mu\textrm{m}$
\end_inset

 and width of about 
\begin_inset Formula $8\,\mu\textrm{m}$
\end_inset

 (width of about 
\begin_inset Formula $2\,\mu\textrm{m}$
\end_inset

 at the thinnest part) .
 We use a non-dimensionalized 
\begin_inset Formula $\omega=\frac{1}{100}$
\end_inset

 to match the radius of 
\shape italic
Staphylococcus epidermidis
\shape default
 and choose 
\begin_inset Formula $h=\frac{1}{128}$
\end_inset

 in all of the simulations shown, so that 
\begin_inset Formula $\omega>h$
\end_inset

.
 
\end_layout

\begin_layout Standard
In the first simulation, the maximum spring force, 
\begin_inset Formula $F_{max}$
\end_inset

, is set to 
\begin_inset Formula $5.00\times10^{-7}\,\textrm{N}$
\end_inset

, and the results are provided in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ShroomNoaddl_f175"

\end_inset

.
 The biofilm bends over in the flow, and the connections in the thin part
 of the biofilm break as they stretch too far.
 The blue streamlines in (b), (c), and (d) of Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ShroomNoaddl_f175"

\end_inset

 and in all of the other 2D simulation plots follow the trajectories given
 by the velocity field, 
\begin_inset Formula $\mathbf{u}$
\end_inset

.
 
\end_layout

\begin_layout Standard
We point out that the values of the spring constants are well within physically
 realistic values (see the discussion in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Discussion-of-Elastic"

\end_inset

), although, in this work, we have chosen these values for the qualities
 they give to the simulations rather than experimental evidence of the elastic
 strength of biofilms.
 For example, in these 2D simulations, we investigated several simulation
 runs with various spring constants until we obtained those that exhibited
 the above described behaviors.
\end_layout

\begin_layout Standard
Next, we conducted a simulation of the same mushroom shaped biofilm with
 all of the same parameter values, but we gave the biofilm additional density
 of 
\begin_inset Formula $\rho_{b}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}}$
\end_inset

 compared to the ambient fluid.
 We know this density is larger than what is seen in actual biofilms (at
 most 20% greater density than water (
\begin_inset CommandInset citation
LatexCommand citep
key "Masuda1991,Ro1991"

\end_inset

)), but we chose it to show an exaggerated example of increasing the biofilm
 density.
 These result is provided in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ShroomAddl"

\end_inset

(b) and illustrates that the added density essentially adds momentum to
 the biofilm.
 This additional momentum causes the biofilm to curl over into the slower
 flow region and thus prevents detachment.
 
\end_layout

\begin_layout Standard
Finally, we conducted a simulation of the same mushroom shaped biofilm with
 all of the same parameter values as the first simulation, but we increased
 
\begin_inset Formula $F_{max}$
\end_inset

 to 
\begin_inset Formula $5.00\times10^{-6}\,\textrm{N}$
\end_inset

.
 The effect of these stronger springs is that the thin part of the biofilm
 does not stretch enough to break the connections.
 The result is depicted in Figure 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:ShroomAddl"

\end_inset

(c).
 We can see from these simulations that either increasing the biofilm density
 or strengthening the springs causes similar results, but, with the increased
 density, the biofilm has more of a curling action.
 
\end_layout

\begin_layout Standard
In the next simulation, we use all of the same parameters described in the
 first simulation, with the addition that the biofilm has a 500
\begin_inset Formula $\times$
\end_inset

 larger viscosity than the surrounding fluid, so 
\begin_inset Formula $\mu_{max}=0.5\,\nicefrac{\textrm{kg}}{\textrm{m}\cdot\textrm{s}}$
\end_inset

.

\shape up
 Comparing simulation results illustrated in Figure 
\shape default

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ShroomAddl"

\end_inset

(d)
\shape up
 and Figure 
\shape default

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ShroomAddl"

\end_inset

(a)
\shape up
, which show the biofilm configurations just before detachment, we observe
 a longer time until detachment in the high viscosity case.
 This is the expected outcome of increasing the viscosity in the biofilm.
 We note here that we used 
\begin_inset Formula $\omega=\frac{1}{100}$
\end_inset

 in the equation for 
\begin_inset Formula $\mu(\mathbf{x})$
\end_inset

 in Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ViscExp"

\end_inset

 because we wanted to spread additional viscosity over the same region that
 the elastic forces are spread to.
 We achieve an even longer detachment time in the simulation by widening
 the influence of additional viscosity by using, for example 
\begin_inset Formula $\omega=\frac{1}{50}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename shroom2Dnondim_noAddl_t_0_00_f10.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename shroom2Dnondim_noAddl_t_0_02_f10.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename shroom2Dnondim_noAddl_t_0_028_f10.eps
	width 45col%

\end_inset

(d)
\begin_inset Graphics
	filename shroom2Dnondim_noAddl_t_0_04_f10.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ShroomNoaddl_f175"

\end_inset

2D Simulation of a mushroom shaped biofilm with the same density as the
 surrounding fluid.
 Time 
\begin_inset Formula $t$
\end_inset

 is in seconds and the distance is in microns.
 In this simulation, 
\begin_inset Formula $\rho_{0}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}},\:\rho_{b}=0,\: F_{max}=5.00\times10^{-7}\,\textrm{N}$
\end_inset

.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
 The blue streamlines follow the velocity field.
 In this simulation, the top of the biofilm stretches in the flow, and the
 top breaks off as the connections in the the middle separate as they exceed
 the breaking criteria of twice the rest length.
 
\family default
\series default
\size default
\emph default
\bar default
\noun default
\color inherit
As expected in a laminar shear flow, the broken piece then tumbles end over
 end through the flow.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename shroom2Dnondim_noAddl_t_0_028_f10.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename shroom2Dnondim_Addl0_0visc1_0dens_t_0_14_f10.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename shroom2Dnondim_noAddl_t_0_16_f100.eps
	width 45col%

\end_inset

(d)
\begin_inset Graphics
	filename shroom2Dnondim_Addl500_0visc0_0dens_t_0_048_f10.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ShroomAddl"

\end_inset

 Snapshots in time (
\begin_inset Formula $t$
\end_inset

 in seconds) of cell distributions resulting from 2D simulation of mushroom
 shaped biofilm with four different property configurations.
 In (a), the biofilm has the same density and viscosity as the surrounding
 fluid (just before detachment), (b) increased 
\begin_inset Formula $F_{max}$
\end_inset

, (c) density twice as large as the surrounding fluid density, and (d) viscosity
 is 
\begin_inset Formula $500\times$
\end_inset

 that of the surrounding fluid (just before detachment).

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
 The blue streamlines follow the velocity field.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Three-Dimensional Simulations
\begin_inset CommandInset label
LatexCommand label
name "sub:Three-Dimensional-Simulations"

\end_inset


\end_layout

\begin_layout Standard
In this section, we provide results from our 3D simulations, which use the
 same parameter values as in the two dimensional simulations (see Table
 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: 2D sim params"

\end_inset

).
 The difference is that the simulation in 3D represents flow through a square
 shaped tube with a side length of 
\begin_inset Formula $50\,\mu\textrm{m}$
\end_inset

.
 Note that these 3D simulations reproduce qualitatively the same results
 as in the 2D ones.
\end_layout

\begin_layout Standard
Our 3D simulations were run on a 
\begin_inset Formula $50\times50\times150\,\mu\textrm{m}$
\end_inset

 computational domain.
 We simulate on a mushroom shaped biofilm with a height of about 
\begin_inset Formula $8.5\,\mu\textrm{m}$
\end_inset

 and a diameter of about 
\begin_inset Formula $7.5\,\mu\textrm{m}$
\end_inset

.
 This shape is carved from the same set of data points described in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:SimSetup"

\end_inset

.
 The spring connections between Lagrangian nodes are put in place at the
 beginning of the simulation, with every node connected to every other node
 less than 
\begin_inset Formula $d_{c}=3\,\mu\textrm{m}$
\end_inset

 away.
 Note that, for the 3D simulations, we increased 
\begin_inset Formula $d_{c}$
\end_inset

 slightly to establish enough connections in the biofilm.
 We again use 
\begin_inset Formula $\omega=\frac{1}{100}$
\end_inset

 to match the radius of 
\shape italic
Staphylococcus epidermidis
\shape default
 and choose 
\begin_inset Formula $h=\frac{1}{128}$
\end_inset

 in all of the simulations shown, so that 
\begin_inset Formula $\omega>h$
\end_inset

.
 In the first simulation, the maximum spring force, 
\begin_inset Formula $F_{max}$
\end_inset

, is set to 
\begin_inset Formula $1.25\times10^{-12}\,\textrm{N}$
\end_inset

.
 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Typically the adhesive strength is on the order of 
\begin_inset Formula $nN$
\end_inset

,nano-Newtons, but since our input velocity 
\begin_inset Formula $v_{0}$
\end_inset

 is 
\begin_inset Formula $10^{-3}\textrm{m/s}$
\end_inset

 our 
\begin_inset Formula $F_{max}$
\end_inset

 is lower.
 I expect 
\begin_inset Formula $F_{max}$
\end_inset

 would increase if we increased the 
\begin_inset Formula $v_{0}$
\end_inset

 to 
\begin_inset Formula $1m/s$
\end_inset

.
 Alpkvist and Klapper paper had a Re=.3 so that's why ours is low also, just
 Re=.05, but typical experiments have Re>50 so this would be consistent if
 we increase the speed to 
\begin_inset Formula $v_{0}=1m/s$
\end_inset

.
\end_layout

\end_inset

 We again chose the value of these spring constants in order to illustrate
 specific behaviors.
 The results of the first simulation are shown in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Shroom3DNoaddl_0_5"

\end_inset

.
 The mushroom shaped biofilm bends over and stretches in the flow.
 The connections in the midsection of the biofilm exceed their breaking
 length and the top of the biofilm breaks off into the flow.
 Next, we ran a simulation of the same mushroom shaped biofilm, but we added
 
\begin_inset Formula $\rho_{b}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}}$
\end_inset

 additional density to the biofilm compared to the surrounding fluid.
 The final result is provided in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Shroom3Daddl"

\end_inset

(b) and illustrates that the added density increases the momentum of the
 biofilm.
 This allows for the mushroom to curl over into the flow and increases the
 time until detachment.
 We also ran a simulation of the same mushroom shaped biofilm, but we increased
 
\begin_inset Formula $F_{max}$
\end_inset

 to 
\begin_inset Formula $1\times10^{-11}\,\textrm{N}$
\end_inset

 and kept the biofilm density the same as the surrounding fluid.
 The result is provided in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Shroom3Daddl"

\end_inset

(c).
 The effect of these stronger springs is that the thin part of the biofilm
 does not stretch enough to break the connections.
 We can see from these simulations that either increasing the biofilm density
 or strengthening the springs causes similar results, but with the increased
 density the biofilm just curls over.
\end_layout

\begin_layout Standard
Finally, we provide one 3D simulation to show that, with increased biofilm
 viscosity, they produce qualitatively the same behavior as in the 2D case.
 In the simulation result shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Shroom3Daddl"

\end_inset

(d), we use the same parameters as the first 3D simulation, but we use a
 viscosity in the biofilm that is a factor of 
\begin_inset Formula $500$
\end_inset

 times that of the surrounding fluid.
 Just as in the 2D case, this results in a longer time until detachment
 (compare time in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Shroom3Daddl"

\end_inset

(a) and Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Shroom3Daddl"

\end_inset

(d)).
 
\end_layout

\begin_layout Standard
For ease of comparison, we now provide the figures in the order in which
 they were discussed in this section.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename shroom3Dnondim_noAddl_t_0_00_f0_5.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename shroom3Dnondim_noAddl_t_0_02_f0_5.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename shroom3Dnondim_noAddl_t_0_04_f0_5.eps
	width 45col%

\end_inset

(d)
\begin_inset Graphics
	filename shroom3Dnondim_noAddl_t_0_06_f0_5.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Shroom3DNoaddl_0_5"

\end_inset

Full 3D simulation of a mushroom shaped biofilm with the same density as
 the surrounding fluid.
 The time 
\begin_inset Formula $t$
\end_inset

 is in seconds and the distance is in microns.
 As the biofilm stretches in the flow, the strain in the midsection exceeds
 the breaking length of the connections, and the top of the biofilm breaks
 off into the flow.
 Then the broken piece tumbles end over end through the flow, and the base
 retracts back.
 In this simulation, 
\begin_inset Formula $\rho_{0}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}},\:\rho_{b}=0,\: F_{max}=1.25\times10^{-12}\,\textrm{N}$
\end_inset

.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename shroom3Dnondim_noAddl_t_0_04_f0_5.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename shroom3Dnondim_Addl0_0visc1_0dens_t_0_12_f0_5.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename shroom3Dnondim_noAddl_t_0_10_f4_0.eps
	width 45col%

\end_inset


\begin_inset Graphics
	filename shroom3Dnondim_Addl500_0visc0_0dens_t_0_051_f0_5.eps
	width 45col%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Shroom3Daddl"

\end_inset

Snapshots in time (
\begin_inset Formula $t$
\end_inset

 in seconds) of cell distributions resulting from 3D simulation of mushroom
 shaped biofilm with four different property configurations.
 In (a), the biofilm has the same density and viscosity as the surrounding
 fluid (just before detachment), (b) increased 
\begin_inset Formula $F_{max}$
\end_inset

, (c) density twice as large as the surrounding fluid density, and (d) viscosity
 is 
\begin_inset Formula $500\times$
\end_inset

 that of the surrounding fluid (just before detachment).
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
In 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:RealShroomDiffViews"

\end_inset

 we show 4 views of the biofilm cell locations taken from a 
\begin_inset Formula $10\,\times\,20\,\mu\textrm{m}$
\end_inset

 subset of the same data set used to acquire the cell locations for the
 2D representation from 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Realistically-Shaped-Biofilm"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sub:2D-SimulationsWithViscosity"

\end_inset

.
 These points were connected with a 
\begin_inset Formula $2.5\,\mu\textrm{m}$
\end_inset

 connection criteria.
 Observation of this biofilm yields some voids in the structure at which
 the biofilm has absolutely no cells.
 It also shows that this segment of biofilm grew quite top-heavy leaving
 an obvious weak point in its central region.
 
\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename x_y_planeRealBiofilmFrontview.eps
	width 3in

\end_inset

(b)
\begin_inset Graphics
	filename x_z_planeRealBiofilmTopview.eps
	width 3in

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename y_z_planeRealBiofilmSideview.eps
	width 3in

\end_inset

(d)
\begin_inset Graphics
	filename x_y_z_planeRealBiofilmDiagview.eps
	width 3in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RealShroomDiffViews"

\end_inset

Illustrates the bacterial cell locations of an real experimental section
 of biofilm of 
\shape italic
Staphylococcus epidermidis
\shape default
 (a) upstream-view, (b) top-view, (c)side-view (d) angled-view.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
In 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:RealShroom3DNoaddl"

\end_inset

 we show the result of running the simulation on the real section of biofilm.
 In this simulation we use the same parameters that were used in the first
 simulation of 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sub:Three-Dimensional-Simulations"

\end_inset

.
 
\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
(a)
\begin_inset Graphics
	filename Fig9a.eps
	width 3in

\end_inset

(b)
\begin_inset Graphics
	filename Fig9b.eps
	width 3in

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename Fig9c.eps
	width 3in

\end_inset

(d)
\begin_inset Graphics
	filename Fig9d.eps
	width 3in

\end_inset


\begin_inset Newline newline
\end_inset

(e)
\begin_inset Graphics
	filename Fig9e.eps
	width 3in

\end_inset

(f)
\begin_inset Graphics
	filename Fig9f.eps
	width 3in

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RealShroom3DNoaddl"

\end_inset

Full 3D simulation of a mushroom shaped biofilm with the same density as
 the surrounding fluid.
 The time is in seconds and the distance is in microns.
 As the biofilm stretches in the flow the strain in the midsection exceeds
 the breaking length of the connections, and the top of the biofilm breaks
 off into the flow.
 Then the broken piece tumbles end over end through the flow, and the base
 retracts back.
 In this simulation 
\begin_inset Formula $\rho_{0}=998\,\nicefrac{kg}{m^{3}},\:\rho_{b}=0,\: F_{max}=1.25\times10^{-12}\, N$
\end_inset

.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Realistically-Shaped-Biofilm"

\end_inset

Realistically Shaped Biofilm Simulation
\end_layout

\begin_layout Standard
The biofilm shapes used in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Two-Dimensional-Simulations"

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Three-Dimensional-Simulations"

\end_inset

 were intentionally carved from the data in a way to provide a weak point
 at which it would be most likely to break.
 This was done in order to verify the expected effects of varying the different
 parameters in the simulation.
 In this section, we provide results of the simulation on a biofilm that
 is a subset of points taken directly from the real biofilm data set.
 In reality, this biofilm was surrounded by more cells on all sides, which
 would change the behavior of the fluid structure interactions.
 However, we use this to show the results of the simulation on a 
\shape italic
real
\shape default
 top heavy biofilm shape that was grown in a lab.
 The 
\shape italic
Staphylococcus epidermidis
\shape default
 data set discussed in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:SimSetup"

\end_inset

 was supplied as positions in three 
\begin_inset Formula $30\times30\times15\,\mu\textrm{m}$
\end_inset

 sub-domains of a biofilm.
\end_layout

\begin_layout Standard
In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RealShroom2Dnoaddl"

\end_inset

(a), we show the biofilm taken from a 
\begin_inset Formula $2\times30\times15\mu\textrm{m}$
\end_inset

 subset of one data set that has been connected with 
\begin_inset Formula $d_{c}=2.8\,\mu\textrm{m}$
\end_inset

.
 For the 2D representation, we collapse the 
\begin_inset Formula $2\,\mu\textrm{m}$
\end_inset

 dimension, leaving only the 
\begin_inset Formula $(x,y)$
\end_inset

 coordinates of the data.
 The most interesting feature of this biofilm is that in the region from
 
\begin_inset Formula $x=60\,\mu\textrm{m}$
\end_inset

 to 
\begin_inset Formula $x=67\,\mu\textrm{m}$
\end_inset

 the biofilm exhibits a mushroom shape similar to the one we used in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
S
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Two-Dimensional-Simulations"

\end_inset

.
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
We now provide two simulation results on this realistically shaped biofilm.
 The first simulation (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RealShroom2Dnoaddl"

\end_inset

) uses a biofilm density equal to the surrounding fluid and uses 
\begin_inset Formula $F_{max}=7.5\times10^{-7}\,\textrm{N}$
\end_inset

.
 In this simulation, the mushroom shaped part pushes against the biofilm
 behind it, then rolls over the top of it as it breaks from its base, forming
 a long streamer-like biofilm.
\begin_inset Foot
status collapsed

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
Streamers are a natural occurrence in biofilms.
 Examples in 
\begin_inset CommandInset citation
LatexCommand citep
key "Klapper2002,Rusconi2010"

\end_inset

.
\end_layout

\end_inset

Then the streamer breaks completely off leaving two distinct attached structures.
 In the second simulation, we use a biofilm density of 
\strikeout off
\uuline off
\uwave off

\begin_inset Formula $\rho_{b}=120\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}}$
\end_inset

 and kept everything else the same.
 Although the density is only 12% larger than the surrounding fluid, it
 has a large impact on the outcome of the simulation.
 
\strikeout default
\uuline default
\uwave default
In this simulation, the effect of the increased density of the biofilm is
 a longer breaking time (compare time in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RealShroom2Daddl"

\end_inset

(b) and Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RealShroom2Daddl"

\end_inset

(c)).
 This occurs since the increased momentum causes the first detached piece
 to continue further down, pulling the whole streamer lower (compare the
 height of the detaching pieces).
 The fluid forces continue to push the streamer until it breaks into the
 flow.
\end_layout

\begin_layout Standard
In the final simulation, we show that increasing the viscosity in the 
\begin_inset Quotes eld
\end_inset

realistically
\begin_inset Quotes erd
\end_inset

 shaped biofilm has larger impact on the results than in the case of the
 previous standalone mushroom shaped biofilm.
 In this simulation, we increased the biofilm viscosity to 50
\begin_inset Formula $\times$
\end_inset

 the surrounding fluid with 
\begin_inset Formula $\mu_{max}=0.05\,\nicefrac{\textrm{kg}}{\textrm{m}\cdot\textrm{s}}$
\end_inset

.
 Although this is 10
\begin_inset Formula $\times$
\end_inset

 less than in the previous variable viscosity simulation, it has a larger
 impact on this wider biofilm, doubling the detachment time from the case
 of constant viscosity (compare Figure 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RealShroom2Daddl"

\end_inset

(b)
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 and Figure 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RealShroom2Daddl"

\end_inset

(d)
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename Realshroom2Dnondim_noAddl_t_0_00_f15.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename Realshroom2Dnondim_noAddl_t_0_04_f15.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename Realshroom2Dnondim_noAddl_t_0_08_f15.eps
	width 45col%

\end_inset

(d)
\begin_inset Graphics
	filename Realshroom2Dnondim_noAddl_t_0_16_f15.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(e)
\begin_inset Graphics
	filename Realshroom2Dnondim_noAddl_t_0_24_f15.eps
	width 45col%

\end_inset

(f)
\begin_inset Graphics
	filename Realshroom2Dnondim_noAddl_t_0_28_f15.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RealShroom2Dnoaddl"

\end_inset

Simulation on a 2D slice of a real biofilm with the same density as the
 surrounding fluid.
 Time 
\begin_inset Formula $t$
\end_inset

 is in seconds and the distance is in microns.
 In this simulation, 
\begin_inset Formula $\rho_{0}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}},\:\rho_{b}=0,\: F_{max}=7.5\times10^{-7}\,\textrm{N}$
\end_inset

.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
 The blue streamlines follow the velocity field.
 In this simulation, the mushroom shaped part pushes against the biofilm
 behind it (b), then rolls over the top of it as it breaks from its base
 (d).
 Then a large portion of the biofilm breaks completely off leaving 2 distinct
 bases (f).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename Realshroom2Dnondim_Addl0_0visc0_12dens_t_0_00_f15.eps
	width 45col%

\end_inset

(b)
\begin_inset Graphics
	filename Realshroom2Dnondim_Addl0_0visc0_12dens_t_0_244_f15stream.eps
	width 45col%

\end_inset


\begin_inset Newline newline
\end_inset

(c)
\begin_inset Graphics
	filename Realshroom2Dnondim_Addl0_0visc0_12dens_t_0_38_f15stream.eps
	width 45col%

\end_inset

(d)
\begin_inset Graphics
	filename Realshroom2Dnondim_Addl0_50visc0_0dens_t_0_508_f15stream.eps
	width 45col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RealShroom2Daddl"

\end_inset

Snapshots in time (
\begin_inset Formula $t$
\end_inset

 in seconds) showing the detachment time and configuration at detachment
 of a 2D slice of a real biofilm with initial configuration in (a).
 In (b), biofilm has the same density and viscosity as the surrounding fluid,
 (c) 12% larger density, and (d) 
\begin_inset Formula $50\times$
\end_inset

 larger viscosity than the surrounding fluid.

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
 The blue streamlines follow the velocity field.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Numerical-Concerns"

\end_inset

Numerical Concerns
\end_layout

\begin_layout Standard
We note that there remains one pressing concern that will be the focus of
 our future work.
 When adapting the multigrid scheme for large values of 
\begin_inset Formula $\mu_{max}$
\end_inset

, we do not achieve expected speed ups in convergence rates.
 We use restriction to transfer the viscosity to the coarse grids works
 for small values of 
\begin_inset Formula $\mu_{max}$
\end_inset

, but we found that, for larger values of 
\begin_inset Formula $\mu_{max}$
\end_inset

, this technique leads to a very slowly converging solver.
 Intriguingly, we found that using our restriction operator to define the
 coarse grid viscous values and then scaling the values leads to faster
 convergence.
 Specifically, we define the coarse grid viscosity as
\begin_inset Formula 
\begin{eqnarray}
\mu_{lh}(\mathbf{x}) & = & \gamma_{lh}I_{\frac{l}{2}h}^{lh}\mu_{\frac{l}{2}h}(\mathbf{x}),\label{eq:ViscCoarseGrid}
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $lh$
\end_inset

 denotes the grid whose mesh width is 
\begin_inset Formula $l$
\end_inset

 times 
\begin_inset Formula $h$
\end_inset

 (
\begin_inset Formula $l=2,\,4,\,8,\,16,\ldots$
\end_inset

), 
\begin_inset Formula $\gamma_{lh}\in(0,1]$
\end_inset

 is the scaling which maximizes the convergence of the solver, and 
\begin_inset Formula $\mu_{h}(\mathbf{x})$
\end_inset

 is defined by Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:ViscExp"

\end_inset

.
 Through repeated experimentation, we found that using 
\begin_inset Formula $\gamma_{lh}\in[.7,1]$
\end_inset

 resulted in the fastest convergence rates in the 2D and 3D simulations.
 This approach is admittedly ad-hoc.
 However, the consistency with which we achieved dramatic speed ups strongly
 suggests the existence of an underlying mathematical principle to be discovered.
 
\end_layout

\begin_layout Standard
For our future work, the highest priority is to resolve the problem of slow
 convergence for large 
\begin_inset Formula $\mu_{max}$
\end_inset

.
 There are three approaches that may lead to resolving this issue.
 The first would be to mathematically derive optimal values for the scaling
 parameters, 
\begin_inset Formula $\gamma_{lh}$
\end_inset

.
 Second, we could ensure that our discretization satisfies the Galerkin
 condition.
 Lastly, and probably the best choice, would be to re-implement the geometric
 multigrid as an algebraic multigrid method (AMG, see Ch.
 8 of 
\begin_inset CommandInset citation
LatexCommand citep
key "Briggs2000"

\end_inset

).
 
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Biofilm-Simulation-Conclusions"

\end_inset

Conclusions
\end_layout

\begin_layout Standard
In this work we developed a simulation to model the flow-induced fragmentation
 of biofilms.
 In this simulation, we have provided a way to adjust the biofilm density
 and viscosity, which had not been addressed in previous IBM biofilm models.
 We also have control of the fluid flow rate, density, viscosity, and elastic
 forces within the biofilm.
 We used experimentally measured biofilm bacterial cell locations as initial
 positions for our Lagrangian nodes.
 This is dramatically different than the traditional IBM, in which methods
 usually refine the Lagrangian mesh along with the Eulerian mesh.
 We adapted the Dirac delta approximation to scale with the radius of the
 bacteria rather than with the mesh width.
 This implies that the information that transfers from the Lagrangian grid
 to the Eulerian grid (i.e.,
\begin_inset space ~
\end_inset

density, viscosity, and elastic force) is spread over a set distance rather
 than scaling by the mesh width, 
\begin_inset Formula $h$
\end_inset

.
 This adapted Dirac Delta approximation improves our numerical convergence
 rates as well.
\end_layout

\begin_layout Standard
We used a projection method to split the incompressible Navier-Stokes equations
 to solve separately for an intermediate velocity and the pressure, and
 then used a Gauss-Seidel iterative method with multigrid to solve the resulting
 equations.
 Using an iterative solver, as opposed to a spectral method, to solve these
 systems was necessitated by the fact that biofilms have spatially varying
 density and viscosity.
 With this solver we achieved first order convergence in both space and
 time.
 
\end_layout

\begin_layout Standard
For the numerical simulations, we carved a mushroom shaped biofilm from
 the bacterial cell locations and ran simulations with varying parameters.
 We first ran the simulation on a simplistic shape in order to validate
 the effect of the various parameter changes on the outcome of the biofilm.
 By adjusting the maximum elastic force, 
\begin_inset Formula $F_{max}$
\end_inset

 in the biofilm, we controlled the detachment phenomenon.
 We also showed that slight changes in the density of the biofilm has a
 large effect on the outcome of the simulation.
 This is an important conclusion as usually modelers ignore the differences
 in biofilm density.
 Finally, we showed that we can increase the detachment time in the simulations
 by increasing the viscosity of the biofilm.
 Finally, we ran simulations on more realistically shaped biofilms, which
 showed how a larger biofilm with different shapes will react to fluid flow
 forces.
 Adjusting these parameters will be a necessary component when we attempt
 to match these simulations to experimental data.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:FW"

\end_inset

 Future Work
\end_layout

\begin_layout Standard
As mentioned in the introduction, this is the first of two articles which
 detail our investigation into modeling and simulating the response and
 fragmentation of a biofilm in shear flow.
 The second article (currently in preparation 
\begin_inset CommandInset citation
LatexCommand cite
key "Stotsky"

\end_inset

) will involve using the results of our simulation to match biofilm rheological
 properties (such as those reported in 
\begin_inset CommandInset citation
LatexCommand cite
key "Pavlovsky2013"

\end_inset

).
 Below we provide an overview of potential improvements, some of which will
 appear in the followup article and some which will be pursued in subsequent
 work.
\end_layout

\begin_layout Standard
There are straightforward ways to include more biologically realistic terms
 to interpret biofilm internal stress dynamics, cell volume, and fragmentation
 dynamics.
 In its current form, our simulations can be used to make predictions in
 detachment times of biofilms, as well as general behavioral responses of
 biofilms to various flow conditions.
 We do plan to include the fact that bacterial cells displace fluid.
 While we have adapted the Dirac delta function approximation to transfer
 the cell parameters (
\begin_inset Formula $F$
\end_inset

, 
\begin_inset Formula $\rho$
\end_inset

, 
\begin_inset Formula $\mu$
\end_inset

) to the Eulerian grid, the current simulation does not actually assign
 a size to the cells.
 As a result, the cells are free to pass through each other.
 We first plan to alter the model for the bacterial cell so that it displaces
 fluid.
 An important step in this process will be to identify a collision detection
 strategy.
 We will base ours on some combination of potentials for electrostatic,
 steric, and Van der Waals forces.
\end_layout

\begin_layout Standard
Our current simulation also uses a spring-breaking criteria of double the
 rest length, and assumes that the bonds are linearly elastic until the
 breaking point.
 This is not an accurate assumption, as it is known that biofilms are composed
 of polymer based ECMs.
 These structures are linearly elastic for small strains and then experience
 plastic deformation (permanently altering the bonds in the ECM and thus
 the rest length) before finally fracturing.
 In the future, we will use biofilm yielding data from experiments such
 as 
\begin_inset CommandInset citation
LatexCommand citep
key "Aggarwal2010"

\end_inset

 to determine accurate approximations for yield points and fracture points
 in the biofilm.
 We plan to include plasticity into the simulations by changing the equations
 for stress, Equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:springF"

\end_inset

, when the bond has been stretched beyond its yield point.
\end_layout

\begin_layout Standard
We also have several plans for improving our numerical method.
 Our current simulation is limited to first-order accuracy.
 Guided by the results in 
\begin_inset CommandInset citation
LatexCommand citep
key "BrownCortezMinion2001"

\end_inset

, we will derive the numerical boundary conditions for our projection method
 to ensure second order accuracy for both velocity and pressure computations.
 To improve the accuracy of the immersed boundary method, we could also
 adapt our modeling method to either an immersed interface method (
\begin_inset CommandInset citation
LatexCommand citep
key "LiIto2006"

\end_inset

) in which we adapt the finite difference approximations close to the interface
 or a blob projection immersed boundary method as discussed in 
\begin_inset CommandInset citation
LatexCommand citep
key "Cortez2000"

\end_inset

 in order to obtain second-order spatial accuracy.
 Another limitation of our current numerical scheme is the time-step stability
 restrictions, which limit the size of the elastic forces between the cells.
 We plan to eliminate these restrictions altogether by changing to a semi-implic
it or implicit method of transferring the data between the Eulerian and
 Lagrangian grids, as is shown in 
\begin_inset CommandInset citation
LatexCommand citep
key "Newren2007"

\end_inset

.
 
\end_layout

\begin_layout Standard
Finally, with large biofilm densities and viscosities, our multigrid method
 in its current formulation does not converge as fast as expected.
 We plan to fix this by appropriately adapting our implementation of the
 geometric multigrid (by satisfying the Galerkin condition) or by changing
 to an algebraic multigrid approach.
\end_layout

\begin_layout Section
Acknowledgements
\end_layout

\begin_layout Standard
We thank Stephen McCormick for his advice concerning the multigrid method
 used in our simulations.
 We also thank Charles Peskin and Thomas Fai for insightful comments and
 discussions related to a previous draft of this work.
\end_layout

\begin_layout Standard
This work was supported in part by the National Science Foundation grants
 PHY-0940991 and PHY-0941227 and NIH-NIGMS grant GM081702.
 This work also utilized the Janus supercomputer, which is supported by
 the National Science Foundation (award number CNS-0821794), the University
 of Colorado Boulder, the University of Colorado Denver, and the National
 Center for Atmospheric Research.
 The Janus supercomputer is operated by the University of Colorado Boulder.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "mathbioCU"
options "cmes"

\end_inset


\end_layout

\begin_layout Section
\start_of_appendix
\begin_inset CommandInset label
LatexCommand label
name "sec:Appendix"

\end_inset


\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
In this appendix we provide a list of variables and parameters used in this
 paper.
\end_layout

\begin_layout Description
\begin_inset Formula $d_{0}$
\end_inset

 Average Spring Rest Length
\end_layout

\begin_layout Description
\begin_inset Formula $\delta$
\end_inset

 Dirac Delta Function
\end_layout

\begin_layout Description
\begin_inset Formula $\delta_{h}$
\end_inset

 Discretized Dirac Delta Function from Peskin
\end_layout

\begin_layout Description
\begin_inset Formula $\tilde{\delta}$
\end_inset

 Our Modified Discretized Dirac Delta Function
\end_layout

\begin_layout Description
\begin_inset Formula $D$
\end_inset

 Spatial dimension, 
\begin_inset Formula $D=2$
\end_inset

 for 2D simulations and 
\begin_inset Formula $D=3$
\end_inset

 for 3D simulations
\end_layout

\begin_layout Description
\begin_inset Formula $\mathbf{e}_{i}$
\end_inset

 Unit Vector in the 
\begin_inset Formula $i^{th}$
\end_inset

 direction
\end_layout

\begin_layout Description
\begin_inset Formula $\eta$
\end_inset

 Total Number of Lagrangian Points
\end_layout

\begin_layout Description

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula $\mathbf{f}$
\end_inset

 Eulerian Force Density
\end_layout

\begin_layout Description
\begin_inset Formula $\mathbf{F}$
\end_inset

 Lagrangian Force
\end_layout

\begin_layout Description
\begin_inset Formula $F_{max}$
\end_inset

 Maximum Lagrangian Force
\end_layout

\begin_layout Description
\begin_inset Formula $h$
\end_inset

 Spatial Discretization of finest grid
\end_layout

\begin_layout Description
\begin_inset Formula $K$
\end_inset

 Hookean Spring Coefficient
\end_layout

\begin_layout Description
\begin_inset Formula $\mu$
\end_inset

 Dynamic Fluid Viscosity
\end_layout

\begin_layout Description
\begin_inset Formula $\mu_{max}$
\end_inset

 Maximum Biofilm Viscosity
\end_layout

\begin_layout Description
\begin_inset Formula $p$
\end_inset

 Pressure
\end_layout

\begin_layout Description

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\mathbf{q}=(q,\, r,\, s)$
\end_inset

 Lagrangian Coordinates
\end_layout

\begin_layout Description
\begin_inset Formula $\rho$
\end_inset

 Density
\end_layout

\begin_layout Description
\begin_inset Formula $\rho_{0}$
\end_inset

 Uniform Fluid Density
\end_layout

\begin_layout Description
\begin_inset Formula $\rho_{b}$
\end_inset

 Additional Density in Biofilm
\end_layout

\begin_layout Description
\begin_inset Formula $s$
\end_inset

 Lagrangian Node Marker
\end_layout

\begin_layout Description
\begin_inset Formula $t$
\end_inset

 Time
\end_layout

\begin_layout Description
\begin_inset Formula $T$
\end_inset

 Tension in Spring
\end_layout

\begin_layout Description
\begin_inset Formula $\mathbf{u}$
\end_inset

 Eulerian Velocity
\end_layout

\begin_layout Description
\begin_inset Formula $\mathbf{\tilde{u}}$
\end_inset

 Intermediate Velocity
\end_layout

\begin_layout Description
\begin_inset Formula $\mathbf{U}$
\end_inset

 Lagrangian Velocity
\end_layout

\begin_layout Description
\begin_inset Formula $\mathbf{x}=(x_{1},x_{2},x_{3})$
\end_inset

 Cartesian Coordinates
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Scaling-Parameters"

\end_inset

Scaling Parameters
\end_layout

\begin_layout Standard
\noindent
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Scaling Parameters
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Scaling 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Primary 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specific values 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dimensions
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
chosen for 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
simulations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic Length
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\{ L\right\} $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $50\: microns$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic Speed
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $u_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\{ \nicefrac{L}{t}\right\} $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10^{-3}\nicefrac{\ensuremath{m}}{s}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic Frequency
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\{ t\right\} $
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1\, s$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Reference Pressure Difference
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p_{0}-p_{L_{tube}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\{ mL^{-1}t^{-2}\right\} $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $.8144\, Pa$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic Density
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\rho_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\{ mL^{-3}\right\} $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $998\,\nicefrac{kg}{m^{3}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic Viscosity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\{ mL^{-1}t^{-1}\right\} $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10^{-3}\,\nicefrac{kg}{ms}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Characteristic Force Density
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\{ \nicefrac{F}{L^{3}}\right\} $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $varies$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: 2D sim params-1"

\end_inset

Shows the scaling parameters and their descriptions.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
lastpage
\end_layout

\end_inset


\end_layout

\end_body
\end_document
