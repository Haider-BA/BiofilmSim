%% LyX 2.0.6 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[oneside,english]{cmes}
\usepackage[T1]{fontenc}
\usepackage{verbatim}
\usepackage{rotating}
\usepackage{refstyle}
\usepackage{float}
\usepackage{units}
\usepackage{amstext}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{esint}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.

\AtBeginDocument{\providecommand\secref[1]{\ref{sec:#1}}}
\AtBeginDocument{\providecommand\figref[1]{\ref{fig:#1}}}
\AtBeginDocument{\providecommand\eqref[1]{\ref{eq:#1}}}
\AtBeginDocument{\providecommand\tabref[1]{\ref{tab:#1}}}
%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}
\RS@ifundefined{subref}
  {\def\RSsubtxt{section~}\newref{sub}{name = \RSsubtxt}}
  {}
\RS@ifundefined{thmref}
  {\def\RSthmtxt{theorem~}\newref{thm}{name = \RSthmtxt}}
  {}
\RS@ifundefined{lemref}
  {\def\RSlemtxt{lemma~}\newref{lem}{name = \RSlemtxt}}
  {}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\cmes{1}{1}{2009}{0}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%\usepackage{cite}

\runningtitle{Variable Viscosity and Density Biofilm Simulations, Part I} 

\title{Variable Viscosity and Density Biofilm Simulations using an Immersed Boundary Method, Part I: Numerical Scheme and Convergence Results}

\author{
Jason F. Hammond\thanks{High Power Microwave Division, AFRL, Kirtland AFB, Albuquerque, NM},\
Elizabeth J. Stewart\thanks{Department of Chemical Engineering, University of Michigan, Ann Arbor, MI},\
John G. Younger\thanks{Department of Emergency Medicine, University of Michigan Ann Arbor, MI},\
Michael J. Solomon\affiliate{2},\
David M. Bortz\thanks{Department of Applied Mathematics, University of Colorado, Boulder, CO}\thanks{Corresponding author (dmbortz@colorado.edu)}
}

\makeatother

\usepackage{babel}
\begin{document}
\maketitle


\abstract{The overall goal of this work is to develop a numerical simulation
which correctly describes a bacterial biofilm fluid-structure interaction
and separation process. In this, the first of a two-part effort, we
fully develop a convergent scheme and provide numerical evidence for
the method order as well as a full 3D separation simulation. We use
an immersed boundary-based method (IBM) to model and simulate a biofilm
with density and viscosity values different from than that of the
surrounding fluid. The simulation also includes breakable springs
connecting the bacteria in the biofilm which allows the inclusion
of erosion and detachment into the simulation. We use the incompressible
Navier-Stokes (N-S) equations to describe the motion of the flowing
fluid and discretize the fluid equations using finite differences.
We use a geometric multigrid method to solve the resulting equations
at each time step. We note that the use of multigrid is necessary
because of the dramatically different densities and viscosities between
the biofilm and the surrounding fluid. We investigate and simulate
the model in both two and three dimensions.\\
~\\
We also note that our method differs from several previous attempts
of using IBM for modeling biofilm/flow interactions in the following
ways: the density and viscosity of the biofilm can differ substantially
from the surrounding fluid, and the Lagrangian node locations correspond
to experimentally measured bacterial cell locations from 3D images
taken of \emph{Staphylococcus epidermidis} in a biofilm.\\
\\
In the followup article, we will present the results of the validation
of this model and calibration to several experimental scenarios.}


\keyword{Navier-Stokes equation, biofilm, immersed boundary method, computational
fluid dynamics, multigrid, viscoelastic fluid}


\section{\label{sec:Introduction-to-Biofilm}Introduction}

This is the first of two articles which detail our investigation of
the response and fragmentation of a biofilm in shear flow. Specifically,
we study the mechanisms of biofilm fluid response and detachment in
terms of spatially varying biofilm density, elasticity, and viscosity.
In the simulations, we model the surface adherent biofilms using an
extension of the immersed boundary method (IBM) (originally developed
in \cite{Peskin1977}). Our approach differs from the traditional
IBM in several ways. We use experimentally measured biofilm bacterial
cell locations as the positions for our Lagrangian nodes, whereas
traditional IBM refines the Lagrangian mesh along with the Eulerian
mesh. An important part of the IBM is in the choice of approximation
of the Dirac delta function which transfers information between the
two grids. We have accordingly adapted the approximation to scale
with the radius of the bacteria rather than with the mesh width. Lastly
we note that this work comprises the bulk of the lead author's graduate
school dissertation work. For further details of this and related
work, we direct the interested reader to his dissertation (\cite{Hammond2012phd})
as well as a previous version of this paper posted on arXiv in (\cite{HammondBiofilms}).
The second article will address validation of the scheme presented
here (\cite{Stotsky}).

In this introduction, we first provide a brief background on the biology
and biomechanics of bacterial biofilms in \S\ref{sub:Bacterial-Biofilms}.
In \S\ref{sec:Mathematical-Models}, we discuss some alternative
mathematical models that have been used to model biofilms (along with
advantages and disadvantages). In \S\ref{sec:Immersed-Boundary-Method},
we introduce the immersed boundary method, and in \S\ref{sub:Variable-Viscosity},
we discuss the significance of including variable viscosity.


\subsection{\label{sub:Bacterial-Biofilms}Biomechanics of Bacterial Biofilms}

Biofilms are a phenotype of bacteria that are found in health, industrial
and natural settings. In the medical field, biofilms occur on devices
such as contact lenses, catheters, and mechanical heart valves. In
industrial settings, they occur in and on water pipes, storage tanks,
ship hulls, filters, food preparation facilities, etc. In natural
settings, they can be found as slime on rocks in bodies of water or
as dental plaque on teeth. 

Physically, biofilms are immobile and consist of a community of bacterial
cells embedded in a dense surface-adherent extracellular matrix (ECM)
of polysaccharides. Biofilms are mechanically strong structures that
tend to deform and fragment rather than completely dislodge when subjected
to flows. Figure \ref{fig:BiofilmPicture} contains an electron micrograph
of a biofilm of \textit{Klebsiella pneumoniae}, clearly showing the
ECM interconnecting the bacterial cells. 
\begin{figure}
\begin{centering}
\includegraphics[scale=0.3]{GenomicsklebsiellaJustPic}
\par\end{centering}

\caption{\label{fig:BiofilmPicture}Scanning electron microscopy of sessile
\emph{K. pneumoniae} LM21 performed in mature biofilm formed on Thermanox
slides in microfermentor system after 48 hours of development at 20000
times magnification. This image is from \cite{Balestrino2008} (used
with permission).}
\end{figure}


An important feature of biofilms is that they are known to behave
like \textit{viscoelastic fluids} (\cite{Klapper2002}). In other
words, they exhibit both viscous and elastic responses upon deformation.
Describing the exact viscoelastic behavior has been the subject of
much experimental, theoretical, and computational research (\cite{Aravas2008,EhretBolNetworkTheory2013,Klapper2002,Kreft2001,Lau2009,Pavlovsky2013,Picioreanu2004,Picioreanu2001,Picioreanu1999,PicioreanuLoodsdrecht2000DisContMod,Rupp2005}).
For example, Klapper et al.~and Pavlosky et al.~use a linear Jeffrey\textquoteright{}s
constitutive law (\cite{Klapper2002,Pavlovsky2013}) while Lau et
al.~use a Voigt standard linear solid model for viscoelastic materials
(\cite{Lau2009}). Recently, Ehret and Böl use an approach from network
theory and model the ECM as a superposition of worm-like chain networks,
and include viscosity by considering the network junctions to be transient
(\cite{EhretBolNetworkTheory2013}). Our model includes elasticity
of the biofilm by using simple linear springs (as done in \cite{AlpkvistKlapper2007WST})
to connect the bacterial cells, and includes the viscosity of the
biofilm with a modification of the constitutive equations for stress.


\subsection{Mathematical Models of Biofilms\label{sec:Mathematical-Models}}

Much research into the mathematical modeling of biofilm growth and
fluid/structure interactions has been conducted in the last three
decades (\cite{Kreft1998,Kreft2001,Picioreanu2001,Picioreanu1999,PicioreanuLoodsdrecht2000DisContMod,ZhangCoganWang2008One,ZhangCoganWang2008Two}).
Below, we summarize several modeling and simulation strategies. This
is not intended to be exhaustive and we direct the interested reader
to \cite{Klapper2010,WangZhang2010Review} for more in-depth reviews. 

The first attempts at mathematical modeling of biofilms were conducted
in the early 1980s (\cite{Kissel1984,Rittmann1980,Rittmann1982}).
Picioreanu and others (\cite{Kreft1998,Kreft2001,Picioreanu2004})
advocated for an individual based (IB) approach, which models the
behavior of each bacteria, encompassing ideas such as cell division,
cell motility, metabolism, and death to simulate the growth and formation
of colonies. Hybrid discrete-continuum models were the first methods
to couple the flow with the the biofilm computationally in 2D and
3D simulations. Picioreanu, van Loodsdrecht, and Heijnen developed
and used these hybrid discrete-continuum models to incorporate the
flow over the irregular biofilm's surfaces, convective and diffusive
mass transfer of substrate, bacterial growth, and biomass spreading
(\cite{Picioreanu2001,Picioreanu1999,PicioreanuLoodsdrecht2000DisContMod}). 

The most sophisticated (purely) continuum models developed are the
phase-field models, which use a one-fluid/two-component formulation
in which the ECM and the bacteria are modeled as one fluid component,
while the collective ensemble of nutrient substrates and the surrounding
fluid are the other (\cite{ZhangCoganWang2008One,ZhangCoganWang2008Two}).
Two-dimensional simulations of both biofilm growth and biofilm-flow
interaction are presented in \cite{ZhangCoganWang2008Two}, in which
shear induced deformation and detachment are illustrated. 

We note that our model differs from both these approaches in the way
that we model the biofilm. We treat the bacteria in the biofilm as
discrete points, where the nodal locations in our simulations correspond
to the locations of the bacterial cells within the biofilm. This contrasts
from the continuum phase-field models that only include averaged biomechanical
properties of the biofilm. With our mathematical formulation, just
as in the individual based models, we can obtain the cumulative local
stresses as well as attribute different local properties to the biofilm.
Our model can be thought of as an extension of the individual based
models, where we accurately account for the interactions with the
fluid as well as include the possibility of fragmentation. We also
assume that on the time scale of our simulations there is no biofilm
growth; so we ignore such factors as nutrient concentrations and growth
rates. 


\subsection{\label{sec:Immersed-Boundary-Method}Immersed Boundary Method}

The immersed boundary method (IBM) was originally developed by Peskin
to study blood flow in the heart (\cite{Peskin1977}). The IBM has
been used previously to model and simulate biofilm/fluid interactions
by \cite{Dillon1996} and \cite{AlpkvistKlapper2007WST}. The authors
successfully coupled the fluid to the biofilm; however, they make
the assumption that the biofilm has the same density and viscosity
as the surrounding fluid. This choice substantially simplifies the
task of solving the N-S equations but does not account for the fact
that biofilms typically have $500\times$ larger viscosity and $12\%$
larger density than water (\cite{Klapper2002,Ro1991}). They also
use a random distribution of points within a biofilm-shaped shell
to represent the biofilm, which does not account for the true spatial
distribution of bacterial cells within a biofilm. 

The IBM has been used more recently in the modeling of immersed elastic
structures in viscous flows in \cite{Huang2009IBM,Luo2008,Strychalski2012,Zhuo2011},
in which the authors use constitutive viscoelastic models including
Maxwell, Voigt, and Jeffrey's models to incorporate forces in the
immersed structures into the IBM. Similarly, our ultimate goal is
to establish an appropriate constitutive model for the forces in the
biofilm with the help of experimental collaborators and to include
this in our IBM formulation. 


\subsection{\label{sub:Variable-Viscosity}Variable Viscosity}

It is generally agreed that biofilms behave like a viscoelastic fluid
and there has been a several efforts to match the behavior of biofilms
with conventional mechanical viscoelastic models (\cite{Aravas2008,Klapper2002,Lau2009,Pavlovsky2013}).%
\footnote{We also note that adding viscosity through the use of local damping
forces (a typical mechanical model for a viscoelastic material) leads
to problematic stability restrictions. %
} However, these efforts have not produced a consensus on the best
mathematical model. This is, in part, due to the fact that the viscoelastic
properties in biofilms are highly variable with different growth conditions
(\cite{Chen2005effectsAdhesiveStrength}) and even in the same growth
conditions (\cite{Aggarwal2010}).

In this work, we chose to treat the fluid in the entire domain as
a Newtonian viscous fluid with a spatially varying viscous coefficient.
We couple the biofilm to the fluid within the entire biofilm region
via the viscous term in the N-S equations. We note that a similar
approach has recently been attempted in a single fluid IBM (\cite{FaiPeskin2013,Fai2014}).
Their approach, however, is not directly applicable to a system with
continuously varying viscosity.%
\footnote{They consider the simulation of a tumbling red blood cell with an
interior viscosity higher than the surrounding fluid. Mathematically
this means there is a discontinuity in the viscosity across the cell
membrane.%
} Others have used two materials (fluid-fluid or fluid-solid), but
couple them only at the interface (\cite{Luo2008,ZhangCoganWang2008Two}).

We now describe the organization of this paper. In \S\ref{sec:Mathematical-Formulation}
we provide our mathematical formulation, which is a variation of the
immersed boundary method literature. In \S\ref{sec:Numerical-Method},
we describe our numerical method, based on a multigrid approach. In
\S\ref{sec:Validation}, we provide numerical convergence results
for our method. In \S\ref{sec:Simulations-Results}, we provide simulation
results in both two and three dimensions, running our simulations
for a variety of experimentally obtained biofilms with varying parameters
such as spring constants, densities, viscosities. Finally, we provide
conclusions in \S\ref{sec:Biofilm-Simulation-Conclusions} and a
discussion of possibilities for future work in \S\ref{sec:FW}.


\section{Mathematical Formulation\label{sec:Mathematical-Formulation}}

In this section, we provide the mathematical formulation for our simulations.
We use an Eulerian mesh to describe the system as a whole and solve
the dimensionless N-S equations at each time step on the mesh. The
Lagrangian nodes are used only to compute information about the bacteria/biofilm
(location, velocity, local density, force) and then transfer the information
back onto the Eulerian mesh using the Dirac delta function.%
\footnote{The Dirac Delta function is approximated in the actual implementation
(see Equation (\ref{eq:Dirac Delta Approx})).%
}\negthinspace{}\negthinspace{} For convenience, we provide a list
in Appendix A of the variables and parameters used in this work. 

We now introduce the mathematical equations used in our model. The
dependent Eulerian variables are velocity $\mathbf{u}(\mathbf{x},\, t)$,
pressure $p(\mathbf{x},\, t)$, density $\rho(\mathbf{x},\, t)$,
and Eulerian force density $\mathbf{f}(\mathbf{x},\, t)$, where $\mathbf{x}$
is the independent Eulerian variable and $t$ is time. The dependent
Lagrangian variables are position of the nodes $\mathbf{X}(\mathbf{q},\, t)$,
velocity of the nodes $\mathbf{U}(\mathbf{q},\, t)$, and the Lagrangian
force density $\mathbf{F}(\mathbf{q},\, t)$, where $\mathbf{q}=(q,r,s)$
is the independent Lagrangian variable. The equations of motion for
the biofilm-fluid interaction are 
\begin{eqnarray}
\rho(\mathbf{x},\, t)\left(\frac{\partial\mathbf{u}}{\partial t}+\mathbf{u}\cdot\triangledown\mathbf{u}\right) & = & -\triangledown p+\triangledown\cdot\left(\mu(\mathbf{x},\, t)\left(\triangledown\mathbf{u}+\left(\triangledown\mathbf{u}\right)^{T}\right)\right)+\mathbf{f}(\mathbf{x},\, t)\label{eq:N-S1VarVisc}\\
\triangledown\cdot\mathbf{u} & = & 0,\label{eq:Incompressible}\\
\frac{\partial\mathbf{X}}{\partial t}(\mathbf{q},\, t) & = & \mathbf{U}(\mathbf{X}(\mathbf{q},\, t),\, t),\label{eq:LagVel}\\
\mathbf{f}(\mathbf{x},\, t) & = & \int_{\Omega_{b}}\mathbf{F}(\mathbf{q},\, t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{q},\, t))\textrm{d}\mathbf{q},\label{eq:ForceCouple}\\
\mathbf{\rho}(\mathbf{x},\, t) & = & \rho_{0}+\int_{\Omega_{b}}\rho_{b}\delta(\mathbf{x}-\mathbf{X}(\mathbf{q},\, t))\textrm{d}\mathbf{q},\label{eq:DensCouple}\\
\mathbf{U}(\mathbf{X}(\mathbf{q},\, t),\, t) & = & \int_{\Omega}\mathbf{u}(\mathbf{x},\, t)\delta(\mathbf{x}-\mathbf{X}(\mathbf{q},\, t))\textrm{d}\mathbf{x},\label{eq:VelCouple}
\end{eqnarray}
where $\mu$ is the dynamic viscosity, $\rho_{0}$ is the mass density
of the fluid, $\rho_{b}$ is the additional mass density of the biofilm
from that of the surrounding fluid, $\Omega$ is the flow domain,
$\Omega_{b}\subset\Omega$ is the space occupied by only the biofilm,
and $\delta(\mathbf{x})$ is the Dirac delta function. Equations (\ref{eq:N-S1VarVisc})
and (\ref{eq:Incompressible}) form the incompressible Navier-Stokes
(N-S) equations with spatially varying viscosity and a forcing term
that represents the forces applied by the biofilm on the fluid. We
omit the force of gravity from (\ref{eq:N-S1VarVisc}) since the biofilms
we wish to model are at most 20\% greater density than water (\cite{Masuda1991,Ro1991});
thus, the gravitational force is negligible compared to the other
forces involved. Equation (\ref{eq:LagVel}) is the equation of motion
of the biofilm, where $\mathbf{U}(\mathbf{q},\, t)$ is the velocity
of the biofilm. The systems of PDE's given by (\ref{eq:N-S1VarVisc})-(\ref{eq:Incompressible})
is coupled to (\ref{eq:LagVel}) by the integrals given in (\ref{eq:ForceCouple})-(\ref{eq:VelCouple}).

To avoid numerical inaccuracies due to roundoff errors, we non-dimensionalize
these equations using the non-dimensional variables defined as 

\begin{center}
\begin{tabular}{cccc}
$t^{*}=\frac{t}{T}$,  & $\mathbf{x}^{*}=\frac{\mathbf{x}}{L}$,  & $\mathbf{u}^{*}=\frac{\mathbf{u}}{u_{0}}$, & $p^{*}=\frac{p-p_{L_{tube}}}{p_{0}-p_{L_{tube}}}$,\tabularnewline
$\mathbf{\triangledown}^{*}=L\mathbf{\triangledown}$, & $\rho^{*}=\frac{\rho}{\rho_{0}}$, & $\mathbf{f}^{*}=\frac{\mathbf{f}}{f_{0}}$, & $\mu^{*}=\frac{\mu}{\mu_{0}}$,\tabularnewline
\end{tabular} 
\par\end{center}

\noindent where $p_{0}$ is the pressure at the upstream end of the
tube, $p_{L_{tube}}$ is the pressure at the downstream end of the
tube, $T$ is the characteristic time scale, $f_{0}$ is the characteristic
force density, and $L$ is the characteristic length. We use the scaling
parameters defined in Table \ref{tab: 2D sim params-1}. Dropping
the stars from the dimensionless variables, Equations (\ref{eq:Incompressible})
and (\ref{eq:ForceCouple})-(\ref{eq:VelCouple}) remain the same
as in the case with dimensions, while Equations (\ref{eq:N-S1VarVisc})
and (\ref{eq:LagVel}) become
\begin{eqnarray}
\sigma\rho(\mathbf{x},\, t)\frac{\partial\mathbf{u}}{\partial t}+\rho(\mathbf{x},\, t)\mathbf{u}\cdot\triangledown\mathbf{u} & = & -\varepsilon\triangledown p+Re^{-1}\triangledown\cdot\left(\mu(\mathbf{x},\, t)\left(\triangledown\mathbf{u}+\left(\triangledown\mathbf{u}\right)^{T}\right)\right)\label{eq:N-SnondimFull}\\
 &  & \qquad+\frac{Lf_{0}}{\rho_{0}u_{0}^{2}}\mathbf{f}(\mathbf{x},\, t),\label{eq:N-SnondimFull2}\\
\sigma\frac{\partial\mathbf{X}}{\partial t}(\mathbf{q},\, t) & = & \mathbf{U}(\mathbf{q},\, t),
\end{eqnarray}
where $\sigma=\frac{L}{Tu_{0}}$ is the Strouhal number, $\varepsilon=\frac{p_{0}-p_{L_{tube}}}{\rho_{0}u_{0}^{2}}$
is the Euler number, and $Re=\frac{\rho_{0}Lu_{0}}{\mu}$ is the Reynolds
number of the fluid. 

The initial velocity profile is the exact solution to the incompressible
Navier-Stokes equations in a square or circular tube with rigid walls
and no-slip conditions at the walls. The velocity profile for a circular
cylinder can be found in many textbooks in fluid dynamics (such as
\cite{Zamir2000}), and a series solution for the laminar flow velocity
profile for a square tube was derived by \cite{Spiga1994}.


\section{Numerical Method\label{sec:Numerical-Method}}

In this section, we describe the numerical formulation for our simulations,
which is based on the Immersed Boundary Method. Our numerical task
is to solve the system defined by Equations (\ref{eq:N-S1VarVisc})-(\ref{eq:VelCouple}),
and we now provide the details of our numerical approach. 

The incompressible flow Navier-Stokes equations, (\ref{eq:N-S1VarVisc})-(\ref{eq:Incompressible}),
are discretized on a fixed uniform Eulerian lattice, while the biofilm
equations are discretized on a moving Lagrangian array of points that
do not necessarily coincide with the fixed Eulerian mesh points of
the fluid computation. We represent the interaction equations (\ref{eq:ForceCouple})-(\ref{eq:VelCouple})
with a smoothed approximation $\tilde{\delta}$ to the Dirac delta
function (see Equation (\ref{eq:Dirac Delta Approx})). Our numerical
approach was inspired by the solving technique used by \cite{Zhu2002}
to simulate a flapping filament in a soap film. 

The discretized equations corresponding to Equations (\ref{eq:ForceCouple})-(\ref{eq:VelCouple})
are given by
\begin{eqnarray}
\mathbf{f}^{n}(\mathbf{x}) & = & \sum_{s=1}^{\eta}\mathbf{F}^{n}(s)\tilde{\delta}(\mathbf{x}-\mathbf{X}^{n}(s),\,\omega),\label{eq:discrForceCouple}\\
\mathbf{\rho}^{n}(\mathbf{x}) & = & \rho_{0}+\sum_{s=1}^{\eta}\rho_{b}\tilde{\delta}(\mathbf{x}-\mathbf{X}^{n}(s),\,\omega)d_{0}^{3},\label{eq:discrDensCouple}\\
\mathbf{U}^{n+1}(s) & = & \sum_{\mathbf{x}}\mathbf{u}^{n+1}(\mathbf{x})\tilde{\delta}(\mathbf{x}-\mathbf{X}^{n}(s),\,\omega)h^{3},\label{eq:discrVelCouple}
\end{eqnarray}
where the superscript $n$ denotes numerical approximations at a particular
time step $n$, $\eta$ is the total number of Lagrangian discretization
points, the sum in Equation (\ref{eq:discrVelCouple}) is over all
the discrete points of the form $\mathbf{x}=(ih,\, jh,\, kh)$ with
$i,\, j,$ and $k$ are integers, $h$ is the Eulerian mesh width,
and $d_{0}^{3}$ is the average volume element of the Lagrangian nodes
(computed by dividing the total volume of the biofilm by the total
number of Lagrangian nodes distributed within it). Following convention,
we replace $(q,\, r,\, s)$ from the mathematical formulation with
only $s$, which we use as an indexed label with a unique number assigned
to each Lagrangian point (\cite{Zhu2002}). In Equation (\ref{eq:discrForceCouple}),
$\mathbf{F}(s)$ is now the total elastic force on the Lagrangian
node associated with marker $s$, as opposed to an elastic force density.
This is because we calculate the force explicitly depending on which
other nodes it is connected to. 


\subsection{\label{sub:Dirac-Delta-Approximation}Dirac Delta Approximation}

In \cite{Peskin2002}, he defines $\delta_{h}(\mathbf{x})$ as
\begin{eqnarray}
\delta_{h}(\mathbf{x})=h^{-3}\phi\left(\frac{x}{h}\right)\phi\left(\frac{y}{h}\right)\phi\left(\frac{z}{h}\right) &  & ,\label{eq:Dirac Delta Post 1}
\end{eqnarray}
where $\phi(r)$ is a symmetric function with compact support such
that $\delta_{h}$ satisfies a \textit{unity condition,} 
\begin{equation}
\sum_{\mathbf{x}\in g_{h}}\delta_{h}(\mathbf{x}-\mathbf{X})h^{3}=1,\:\forall\mathbf{X},\label{eq:unityConditionDirac}
\end{equation}
and a \textit{first-moment condition,} 
\begin{equation}
\sum_{\mathbf{x}\in g_{h}}(\mathbf{x}-\mathbf{X})\delta_{h}(\mathbf{x}-\mathbf{X})h^{3}=0,\:\forall\mathbf{X}\,.\label{eq:1stMomentConditionDirac}
\end{equation}
We replace this $\delta_{h}$, that is used in standard IBM implementations,
with one that scales with $\omega$ instead of the grid spacing $h$
as
\begin{equation}
\tilde{\delta}(\mathbf{x},\,\omega)=\omega^{-3}\phi\left(\frac{x}{\omega}\right)\phi\left(\frac{y}{\omega}\right)\phi\left(\frac{z}{\omega}\right).\label{eq:Dirac Delta Approx}
\end{equation}
We deviate from the standard scaling of the Dirac Delta approximation
for two reasons. The first is that we wish to give a presence to the
bacterial cells that is representative of the true volume of the cells.
Thus, in the simulations, we make $\omega$ in (\ref{eq:discrForceCouple})-(\ref{eq:discrVelCouple})
equal to the radius of a bacterial cell that we are modelling. Equation
(\ref{eq:discrForceCouple}) then spreads the force over a volume
that is slightly larger than the cell, ensuring that the entire space
occupied by the cell in the fluid is influenced by the force. The
second reason we use this scaling is because, during the mesh refinement
analysis described in \S\ref{sub:Eulerian-Grid-Refinement}, we discovered
that the implementation with the scaling by $h$ restricts us to less
than first-order convergence of the velocity, $\mathbf{u}$. Using
a scaling that is independent of the mesh-width fixes this issue and
leads to greater than first order convergence. We also note that this
class of modification is not a new practice and was used by Lim and
Peskin to improve accuracy and to introduce material length scales
in IBM in \cite{LimPeskin2012}. However, using $\tilde{\delta}$
in place of $\delta_{h}$, these conditions are simultaneously satisfied
only when $\omega=n\, h$ for some $n\in\mathbb{N}^{+}$. In practice,
this is not a major concern as many IBM formulations use a Dirac delta
approximation that satisfies the unity condition, but does not satisfy
the first-moment condition. Accordingly, we choose the function 
\begin{equation}
\phi(r)=\phi_{2}=\left\{ \begin{array}{cc}
\frac{1}{4}\left(1+\cos\left(\frac{\pi r}{2}\right)\right); & \textrm{if }|r|\le2,\\
0; & \textrm{if }|r|>2.
\end{array}\right.\label{eq:PhiCosAlternative}
\end{equation}
as is done in \cite{Zhu2002} because it is a better match with the
choices made for $\omega$ and $h$.%
\footnote{For a thorough analysis of the errors induced by using $\tilde{\delta}$,
we direct the interested reader to \cite{Hammond2012phd,HammondBiofilms}%
}


\subsection{Elastic Forces and Breaking Criteria}

For a model of the elastic forces, we follow \cite{AlpkvistKlapper2007WST}
who used Hooke's Law to describe the elastic force between the connected
Lagrangian nodes. Thus, the elastic force on each Lagrangian point
using Hooke's Law is
\begin{equation}
\mathbf{F}^{n}(s)=\sum_{k=1}^{\eta}I_{s,k}\frac{\mathbf{d}_{s,k}}{d_{s,k}}T_{s,k}\,,\label{eq:springF}
\end{equation}
where $T$ is the tension between nodes $s$ and $k$, $I$ is the
connectivity matrix defined as 
\begin{eqnarray*}
I_{s,k} & = & \left\{ \begin{array}{cc}
1 & \textrm{ bacteria }s\textrm{ connected to bacteria }k\\
0 & \textrm{otherwise}\:,
\end{array}\right.
\end{eqnarray*}
and $\mathbf{d}_{s,k}$ is the vector pointing from Lagrangian node
$s$ to $k$ with magnitude $d_{s,k}$. The tension from the spring
connecting node $s$ and $k$ is formulated as 
\[
T_{s,k}=K_{s,k}(d_{s,k}-r_{s,k}),
\]
where $r_{s,k}$ is the rest length of the spring connecting nodes
$s$ and $k$, and $K_{s,k}$ is its Hookean spring coefficient. We
choose to define each spring coefficient as
\begin{equation}
K_{s,k}=\frac{F_{max}}{r_{s,k}},\label{eq:defineK}
\end{equation}
where $F_{max}$ is the force required to break the spring. We define
the spring coefficients in this way to ensure that all of the springs,
regardless of initial length, break with a force of $F_{max}$ when
they are stretched to a length of $2r_{s,k}$. In our simulations,
we vary $F_{max}$ to attain specific results (such as detachment;
see \S\ref{sub:Discussion-of-Elastic} more details). As is done
in \cite{AlpkvistKlapper2007WST}, we model the failure of the ECM
by breaking the connections between the Lagrangian nodes as the springs
used to connect them exceed twice their resting length. We note that
this condition, however, is not based on experimental evidence, and
in future work we will adapt this breaking criteria according to experimental
results. In \secref{FW}, we discuss future adaptations to the breaking
criteria in terms of the yield stress of polymers. 


\subsection{Variable Viscosity\label{sub:varVisc}}

It is known that ECM density decreases with distance from an individual
cell. To account for this, the exact form of $\mu(\mathbf{x})$ used
in our simulations is
\begin{equation}
\mu(\mathbf{x})=\max_{1\le s\le\eta,\, s\in\mathbb{N}}\left[\left(2\omega\right)^{D}\left(\mu_{max}-\mu_{out}\right)\tilde{\delta}(\mathbf{x}-\mathbf{X}(s),\,\omega)+\mu_{out}\right],\label{eq:ViscExp}
\end{equation}
where $\mu_{max}$ is the viscosity at a bacterial node, $\mu_{out}$
is the viscosity of the surrounding fluid, $D$ is the spatial dimension,
and $\omega$ is a parameter we can use to stretch the influence of
the additional viscosity. We made this choice for $\mu(\mathbf{x})$
because we wanted a viscosity that would decrease at the same rate
as the elastic force with the distance from the bacterial cell. To
illustrate how the viscosity will decay, in Figure \ref{fig:ViscEx}
we depict a 1D example of the effect of $\omega$ and $h$ on the
viscosity distribution, $\mu(\mathbf{x})$, from \emph{two} interacting
cells. In the subsequent work, we will change this function to suit
the specific viscous properties of the particular biofilm.
\begin{figure}
\begin{centering}
(a)\includegraphics[width=0.4\columnwidth]{ViscExh_1_32}(b)\includegraphics[width=0.4\columnwidth]{ViscExh_1_64}\\
(c)\includegraphics[width=0.4\columnwidth]{ViscExh_1_128}(d)\includegraphics[width=0.4\columnwidth]{ViscExh_1_512}
\par\end{centering}

\caption{\label{fig:ViscEx}Examples of 1D $\mu(x)$ with two Lagrangian nodes,
one at $x=\nicefrac{5}{32}$ on an Eulerian node and the other at
$x=\frac{5}{32}+\frac{2\pi}{150}$, with $\omega=\frac{1}{50}$. These
Lagrangian nodes (cells) are close enough that there is a region of
interaction. These plots illustrate the effect of using different
spatial steps: (a) $h=\frac{1}{32}$, (b) $h=\frac{1}{64}$ (c) $h=\frac{1}{128}$
(d) $h=\frac{1}{512}$}
\end{figure}



\subsection{Solution Strategy}

We employ a \textit{projection method} (\cite{BrownCortezMinion2001})
to solve the incompressible Navier-Stokes equations numerically, building
on the method used by \cite{Zhu2002}. This method introduces a velocity
field (at an intermediate time), $\mathbf{\tilde{u}}(\mathbf{x},\, t)$,
which is the solution to the difference equation
\begin{equation}
\begin{array}{c}
\rho^{n}\left(\sigma\frac{\tilde{\mathbf{u}}_{k}^{n+1}-\mathbf{u}_{k}^{n}}{\triangle t}+\frac{1}{2}(\mathbf{u}\cdot\mathbf{D}^{0}\mathbf{u}_{k}+\mathbf{D}^{0}\cdot(\mathbf{u}\mathbf{u}_{k}))^{n}\right)\qquad\qquad\qquad\qquad\qquad\\
\qquad\qquad\qquad\qquad=\frac{1}{Re}\mathbf{D}^{0}\cdot\left(\mu^{n}\left(\mathbf{D}^{0}\tilde{\mathbf{u}}_{k}^{n+1}+D_{h,k}^{0}\tilde{\mathbf{u}}^{n+1}\right)\right)+\frac{Lf_{0}}{\rho_{0}u_{0}^{2}}\mathbf{f}_{k}^{n}\,,
\end{array}\label{eq:NSdis1-1}
\end{equation}
where $k$ denotes the $k^{\textrm{th}}$ component of that vector.
In this discretization, $\mathbf{D}^{0}\cdot(a\mathbf{D}^{0}\phi)$
is defined for scalar functions $a(\mathbf{x})$ and $\phi(\mathbf{x})$
using the midpoint values of $a$ as 
\begin{equation}
\mathbf{D}^{0}\cdot\left(a\mathbf{D}^{0}\phi\right)=\sum_{i=1}^{3}\frac{a\left(\mathbf{x}+\frac{h}{2}\mathbf{e}_{i}\right)\frac{\phi(\mathbf{x}+h\mathbf{e}_{i})-\phi(\mathbf{x})}{h}-a\left(\mathbf{x}-\frac{h}{2}\mathbf{e}_{i}\right)\frac{\phi(\mathbf{x})-\phi(\mathbf{x}-h\mathbf{e}_{i})}{h}}{h}\,,\label{eq:divergenceGrad}
\end{equation}
 and $\mathbf{D}^{0}\cdot\left(aD_{h,k}^{0}\mathbf{u}\right)$ is
defined as
\begin{eqnarray}
\mathbf{D}^{0}\cdot\left(aD_{h,k}^{0}\mathbf{u}\right) & = & \frac{a\left(\mathbf{x}+\frac{h}{2}\mathbf{e}_{k}\right)\frac{\mathbf{u}_{k}(\mathbf{x}+h\mathbf{e}_{k})-\mathbf{u}_{k}(\mathbf{x})}{h}-a\left(\mathbf{x}-\frac{h}{2}\mathbf{e}_{k}\right)\frac{\mathbf{u}_{k}(\mathbf{x})-\mathbf{u}_{k}(\mathbf{x}-h\mathbf{e}_{k})}{h}}{h}+\nonumber \\
 &  & +\sum_{i\ne k}^{3}\left(\frac{a\left(\mathbf{x}+h\mathbf{e}_{i}\right)\frac{\mathbf{u}_{i}(\mathbf{x}+h\mathbf{e}_{i}+h\mathbf{e}_{k})-\mathbf{u}_{i}(\mathbf{x}+h\mathbf{e}_{i}-h\mathbf{e}_{k})}{2h}}{2h}\right.\label{eq:divergencePartial}\\
 &  & -\left.\frac{a\left(\mathbf{x}-h\mathbf{e}_{i}\right)\frac{\mathbf{u}_{i}(\mathbf{x}-h\mathbf{e}_{i}+h\mathbf{e}_{k})-\mathbf{u}_{i}(\mathbf{x}-h\mathbf{e}_{i}-h\mathbf{e}_{k})}{2h}}{2h}\right)\,.\nonumber 
\end{eqnarray}
To complete the discretized incompressible Navier-Stokes system, we
have the following two equations:
\begin{eqnarray}
\sigma\rho^{n}\left(\frac{\mathbf{u}^{n+1}-\mathbf{\tilde{u}}^{n+1}}{\triangle t}\right) & = & -\varepsilon\mathbf{D}^{0}p^{n+1}\,,\label{eq:NSdis2}\\
\mathbf{D}^{0}\cdot\mathbf{u}^{n+1} & = & 0\,.\label{eq:NSdis3}
\end{eqnarray}
We point out here that summing Equations (\ref{eq:NSdis1-1}) and
(\ref{eq:NSdis2}) leads to the discretized version of Equations (\ref{eq:N-SnondimFull})-(\ref{eq:N-SnondimFull2}),
with the exception that the evaluation of the viscous term is at the
intermediate value of the velocity $\tilde{\mathbf{u}}^{n+1}$. We
solve for pressure by applying $\mathbf{D}^{0}$ to both sides of
Equation (\ref{eq:NSdis2}) and using Equation (\ref{eq:NSdis3})
to obtain
\begin{equation}
\mathbf{D}^{0}\cdot\left(\frac{1}{\rho^{n}}\mathbf{D}^{0}p^{n+1}\right)=\frac{\sigma}{\varepsilon}\frac{\mathbf{D}^{0}\cdot\tilde{\mathbf{u}}^{n+1}}{\Delta t}.\label{eq:NSdis4}
\end{equation}


To solve equations (\ref{eq:NSdis1-1}) and (\ref{eq:NSdis4}), we
use Gauss-Seidel as a smoother in a multigrid solver. At each time
step, we solve Equations (\ref{eq:N-SnondimFull})-(\ref{eq:N-SnondimFull2})
for $\mathbf{\tilde{u}}^{n+1}$, substitute it into (\ref{eq:NSdis4}),
solve for $p^{n+1}$, and finally solve for $u^{n+1}$ using (\ref{eq:NSdis2}).
Then the velocity is transferred from the Eulerian points to the Lagrangian
points using (\ref{eq:discrVelCouple}). With $\mathbf{U}^{n+1}$
computed, the new Lagrangian node locations are computed using Euler's
method as
\[
\mathbf{X}^{n+1}(s)=\frac{\Delta t}{\sigma}\mathbf{U}^{n+1}(s)+\mathbf{X}^{n}(s).
\]
The forces between the Lagrangian points are then recalculated and
transferred to the Eulerian points using Equation (\ref{eq:discrForceCouple}).
Finally, the values of $\rho^{n}$ and $\mu^{n}$ are evaluated using
the new Lagrangian locations.


\subsection{Multigrid}

In this section, we discuss the elements of multigrid that we use
in our solution strategy. For more details on multigrid, see \cite{Briggs2000}. 

In our solver, we use the conventional Gauss-Seidel iterative method
with red-black ordering. In the multigrid scheme, we use full-weighting
restriction to go from fine to coarse grids, and we use linear interpolation
to go from coarse back to fine grids. The finest grid is the grid
with step size $h$ and the grids become coarser by increasing the
step size by a factor of 2. This halves the number of nodes in each
dimension, allowing for significantly faster computations on the coarser
grids. The number of levels in the multigrid solver depends on both
the dimensions of the computational domain as well as $h$. In our
simulations, we iterate using multigrid V-cycles until we reach a
sufficiently low value for the norm of the residual, 
\[
\left\Vert f^{h}-A^{h}\tilde{v}^{h}\right\Vert ,
\]
at each time step. Here, $A^{h}v^{h}=f^{h}$ is the linear discretization
of a PDE, and the residual is $r^{h}=f^{h}-A^{h}\tilde{v}^{h}$, where
$\tilde{v}$ is an approximation to $v$. The residual provides a
bound on the true error in the solution of the linear system since
we have this relationship between the error and the relative residual
error:
\begin{equation}
\frac{\left\Vert e^{h}\right\Vert }{\left\Vert v^{h}\right\Vert }\le cond(A^{h})\frac{\left\Vert r^{h}\right\Vert }{\left\Vert f^{h}\right\Vert }\,,\label{eq:resCondrelationship}
\end{equation}
where $e^{h}=v^{h}-\tilde{v}^{h}$, $r^{h}=f^{h}-A^{h}\tilde{v}^{h}$,
and $cond(A^{h})$ is the condition number of $A^{h}$. In \S\ref{sec:Validation},
we give approximations for the condition numbers for our matrices.


\subsection{Boundary Conditions}

The computational domain used in our example simulations is a section
of a tube with the biofilm centered in the direction along the axis
of the tube (see sigure in \S \ref{sec:Simulations-Results}). In
the 2D case, flow is along the $x$-axis and, in 3D, it is along the
$z$-axis. The boundary conditions we used in these simulations were
derived from exact solutions for the velocity and pressure in the
case of laminar flow. We now provide the boundary conditions in both
the 2D and 3D cases.


\subsubsection{2D Boundaries\label{sub:2D-Boundaries}}

The no-slip boundary condition exists at the walls of tube and requires
that the velocity be zero there, so we use that as the boundary condition
at the walls. The velocity at the upstream boundary ($x=0$) is held
at the conventional laminar flow velocity given by 
\begin{equation}
u_{1}(y)=\frac{\kappa}{2\mu}(y^{2}-2ay),\label{eq:2DlaminarSoln}
\end{equation}
where $a$ is the radius of the tube, $y$ is the displacement from
the bottom edge of the tube, $\kappa$ is the linear rate at which
the pressure decreases through the tube, and $u_{1}$ is the x-component
of the velocity (i.e., $\mathbf{u}=\left(u_{1},\, u_{2}\right)$).
At the downstream boundary, a Neumann condition is applied to the
velocity by enforcing that 
\[
\left(\frac{\partial}{\partial x}\mathbf{u}(x,y)\right)_{x=x_{down}}=0\qquad\forall y,
\]
where $x_{down}$ represents the $x$ value at the downstream boundary.

The boundary conditions for pressure come from the laminar flow equation
for pressure given by
\begin{equation}
p(x)=\kappa x+p(0).\label{eq:pressLam}
\end{equation}
In our simulations, we hold the pressure at the upstream boundary
at $p(0)$ and at $p(x_{down})$ at the downstream. At the top boundary,
we hold the pressure at the values given by Equation (\ref{eq:pressLam})
and, at the bottom boundary (the boundary on which the biofilm is
attached), we use a Neumann boundary
\[
\left(\frac{\partial}{\partial y}p(x,y)\right)_{y=0}=0,\qquad\forall x.
\]



\subsubsection{3D Boundaries}

In the 3D simulations, we orient the square tube along the $z$-axis.
The no-slip boundary condition exists at the walls of tube and requires
that the velocity be zero there so we use that as the boundary condition
at the walls. Derived by \cite{Spiga1994}, the velocity at the upstream
boundary is held at the laminar flow velocity given by 
\begin{equation}
u_{3}(x,y)=-\frac{16\kappa a^{2}}{\mu\pi^{4}}\sum_{n,m>0,\,\textrm{odd}}\frac{\sin\left(n\pi\nicefrac{x}{a}\right)\sin\left(m\pi\nicefrac{y}{a}\right)}{nm\left(n^{2}+m^{2}\right)},\label{eq:3DlaminarFlow}
\end{equation}
where $a$ is the width of the tube and $u_{3}$ is the z-component
of the velocity (i.e., $\mathbf{u}=\left(u_{1},\, u_{2},\, u_{3}\right)$).
At the downstream boundary, a Neumann condition is applied to the
velocity by enforcing that 
\[
\left(\frac{\partial}{\partial z}\mathbf{u}(x,y,z)\right)_{z=z_{down}}=0\qquad\forall x,\, y.
\]


The boundary conditions for pressure come from the laminar flow equation
for pressure given by
\begin{equation}
p(z)=\kappa z+p(0),\label{eq:pressLam3D}
\end{equation}
where $z=0$ is the upstream boundary. In our simulations, we hold
the pressure at the upstream boundary at $p(0)$ and at $p(z_{down})$
at the downstream. At the top and side boundaries, we hold the pressure
at the values given by Equation \ref{eq:pressLam3D} and, at the bottom
boundary (side with attached biofilm), we use the Neumann condition
given by
\[
\left(\frac{\partial}{\partial y}p(x,y,z)\right)_{y=0}=0\qquad\forall x,\, z.
\]



\section{\label{sec:Validation}Convergence }

In this section, we provide numerical evidence for the convergence
of our simulation strategy. For the purposes of the 2D and 3D convergence
analysis conducted in later sections, we require the following notation.
We present the following notation in 3D (the 2D versions are analogous
but without the $z$ elements). Define the \textit{Eulerian grid function
$p$-norm} for an arbitrary 3D vector field, $\mathbf{w}(\mathbf{x})=(w_{1}(\mathbf{x}),w_{2}(\mathbf{x}),w_{3}(\mathbf{x}))$,
by
\begin{equation}
\left\Vert \mathbf{w}\right\Vert _{p}=\left(\sum_{i,j,k}\left|\mathbf{w}(x_{i},y_{j},z_{k})\right|{}^{p}h^{D}\right)^{\nicefrac{1}{p}},\label{eq:EulPnorm}
\end{equation}
where $D$ is the spatial dimension, $1\le p<\infty$, and 
\[
\left|\mathbf{w}(x_{i},y_{j},z_{k})\right|=\sqrt{w_{1}(x_{i},y_{j},z_{k})^{2}+w_{2}(x_{i},y_{j},z_{k})^{2}+w_{3}(x_{i},y_{j},z_{k})^{2}}.
\]
Then 
\[
\left\Vert \mathbf{w}\right\Vert _{\infty}=\max_{i,j,k}\left|\mathbf{w}(x_{i},y_{j},z_{k})\right|.
\]
Additionally, on the Lagrangian grid define the \textit{Lagrangian
grid function $p$-norm} for a vector field, $\mathbf{X}=(X_{1}(s),X_{2}(s),X_{3}(s))$,
as 
\[
\left\Vert \mathbf{X}\right\Vert _{p}=\left(\sum_{s=1}^{\eta}\left|\left(X_{1}(s),\, X_{2}(s),\, X_{3}(s)\right)\right|^{p}d_{0}^{D}\right)^{\nicefrac{1}{p}},
\]
where $1\le p<\infty$ and $d_{0}^{D}$ is the average volume element
of the Lagrangian nodes. Then 
\[
\left\Vert \mathbf{X}\right\Vert _{\infty}=\max_{1\le s\le\eta}\left|\left(X_{1}(s),\, X_{2}(s),\, X_{3}(s)\right)\right|.
\]
Note that both of these grid function norms are derived from using
discretizations of the integrals used in a typical function p-norm
(see Appendix A of \cite{LeVeque2007} for more details). 

There are three parts to our simulation validation process: 1) we
illustrate that in the absence of the biofilm our numerical simulation
converges to the analytical solution; 2) we verify that our multigrid
technique is correctly accelerating the convergence of our chosen
relaxation scheme; and 3) we determine the convergence rate of the
simulations with a biofilm using a mesh refinement convergence analysis. 

Before discussing the results of our validation process, we provide
a brief description of the two primary sources of error present in
our simulations, \S\ref{sub:Discussion-of-Errors}. We also setup
our simulations with a detailed description of initial Lagrangian
node positions in \S\ref{sub:SimSetup}. Then we provide 2D simulation
validation in \S\ref{sub:Two-Dimensional-Validation} and 3D validation
in \S\ref{sub:Three-Dimensional-Validation}. 


\subsection{\label{sub:Discussion-of-Errors}Discussion of Errors}

In our numerical scheme, we have two sources of error: 1) \textit{discretization
error} is introduced by discretizing the Navier-Stokes equations in
space and time; and 2) \textit{algebraic error} is introduced when
we attempt to solve the resultant systems of linearized equations. 

As it is impossible to compute the true algebraic error, we use the
norm of the residual to deduce an upper bound on the algebraic error
using Equation \ref{eq:resCondrelationship}. Recall that Equation
\ref{eq:resCondrelationship} indicates that the relative algebraic
error at each timestep is no larger than the condition number of the
matrix times the relative residual norm (recall that $\frac{\left\Vert r\right\Vert }{\left\Vert f\right\Vert }$
is the relative residual norm). We do not construct these matrices
during the actual simulations because we do not need them to solve
the systems. However, we did construct them to find their condition
numbers and found that the condition numbers for the matrices used
in the computations for $\tilde{\mathbf{u}}^{n+1}$ and $p^{n+1}$
are $O\left(h^{-2}\right)$ (this is true for both 2D and 3D simulations).
The simulations that resulted in the plots given in \S\ref{sub:Two-Dimensional-Simulations}
and \S\ref{sub:Three-Dimensional-Simulations} were run using $h=\frac{1}{128}$,
and thus the matrix condition numbers were approximately $10^{4}$.

Our goal in the simulations is to ensure that the algebraic error
falls well below the discretization error at each time step, so the
total error will be dominated by the discretization error. In theory,
the discretization error is at best $O(h^{2})\approx C\left(\nicefrac{1}{128}\right)^{2}$$\approx C\times6\times10^{-5}$,
for $C>0$, with our discretization. Using a stopping criteria of
$10^{-9}$ for the relative residual at each timestep should suffice
(i.e., from Equation (\ref{eq:resCondrelationship})). We continue
to the next time step only when the computed relative residual, $\frac{\left\Vert r^{h}\right\Vert }{\left\Vert f^{h}\right\Vert }\le10^{-9}$,
because this implies $\left\Vert e^{h}\right\Vert \le cond(A)*10^{-9}\approx10^{-5}$. 

Another factor influencing the capability of our simulations is that
after, extensive simulation, we discover that our linear solver is
limited to converging to a relative residual norm of about $10^{-11}$
(possibly from machine precision issues). With $h=\frac{1}{512}$,
the condition number is $O(10^{5})$ and the discretization error
is $O(10^{-6})$, so the algebraic error is at best bounded by about
$10^{-11}\times10^{5}=10^{-6}$ (see Equation (\ref{eq:resCondrelationship})),
and we can no longer be certain that the algebraic error falls below
the discretization error at each timestep. For this reason, we restrict
$h$ to be larger than $\frac{1}{512}$ in all of the simulations
and convergence analysis.


\subsection{\label{sub:SimSetup}Simulation Setup}

In these convergence simulations, we constructed an experimentally
motivated mushroom shaped biofilm (shown in Figure \ref{fig:Mushroom-shaped-biofilm2Dsims}(a)).
We carved this shape from a $1.6\,\mu\textrm{m}$ slice cut from data
points generated in the Younger and Solomon labs at the University
of Michigan. These data points are 3D bacterial cell locations from
3D Leica SP2 confocal laser scanning microscopy images taken of \textit{Staphylococcus
epidermidis} RP62A (ATCC 35984) grown in a Stovall 3 channel flow
cell for 24 hours at 37$^{\circ}$C in tryptic soy broth with 1\%
glucose added under a wall shear stress of $0.01\,\textrm{Pa}$. For
further details of how the coordinates were computed, see \cite{Stewart}.

From this data, the average Lagrangian volume element, $d_{0}^{3}$,
is calculated to be approximately $4.036\,\mu\textrm{m}^{3}$, and
thus we use $d_{0}=1.59\,\mu\textrm{m}$ in both the 2D and 3D simulations.
We connect the initial distribution of cells with a distance based
connection criteria. Our inspiration for the connection distance criteria
came from the closeup images of biofilms such as the one shown in
Figure \ref{fig:BiofilmPicture}. We observed that each bacterial
cell is connected to neighboring cells that are within about $2d_{0}$.
Thus, we varied the connection criteria in our algorithm between $1.5$-$2.5\times d_{0}$
in an effort to find one that resulted in a biofilm that was sufficiently
connected but not overcrowded. This resulted in the choice of a connection
criteria of $d_{c}=2.8\,\mu\textrm{m}$. In other words, we placed
spring connections between Lagrangian nodes at the beginning of the
simulation with every node connected to every other node less than
$2.8\,\mu\textrm{m}$ away. Admittedly, this value of $d_{c}$ is
arbitrary, and future work will include deriving a method to determine
this connection criteria through image analysis of closeup images
of biofilms similar to \figref{BiofilmPicture}. The mushroom shaped
biofilm has a height of about $8.5\,\mu\textrm{m}$ and width of about
$8\,\mu\textrm{m}$ (see \figref{Mushroom-shaped-biofilm2Dsims}).
In the convergence simulations, the maximum spring force, $F_{max}$,
is set to $5\times10^{-6}\,\textrm{N}$. The fluid parameters for
these convergence simulations are provided later in Table \ref{tab: 2D sim params}.

\begin{figure}
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{Easyshroom2DnoAddl_t_0}(b)\includegraphics[width=0.45\columnwidth]{sample3Dbiofilm1}
\par\end{centering}

\caption{\label{fig:Mushroom-shaped-biofilm2Dsims}Mushroom-shaped biofilm
at $t=0$ in the middle of the computational domain attached to the
bottom $(y=0)$ of the tube. (a) This is the shape used in the 2D
simulations, and (b) 3D mushroom shaped biofilm at $t=0$.}
\end{figure}


Note that $\tilde{\delta}$ is a function of $\omega$, a scaling
parameter we must choose that determines the volume/area of influence
when the forces and density are transferred to the Eulerian grid.
We must also point out here that a more accurate representation of
the Dirac delta function occurs when $\omega\ge h$. Thus, for the
purpose of the convergence simulations, we use $\omega=1.0\,\mu\textrm{m}$
in the transfer equations, (\ref{eq:discrForceCouple}) and (\ref{eq:discrDensCouple}).
However, in our simulations, we use $\omega=0.5\,\mu\textrm{m}$ since
the actual radius of \textit{Staphylococcus epidermidis} is known
to be about $0.5\,\mu\textrm{m}$ (\cite{Todar2012}). Using a characteristic
length of $L=50\,\mu\textrm{m}$, we have the non-dimensionalized
$\omega^{*}=\frac{\omega}{L}=\frac{1}{50}$. Dropping the star from
the dimensionless variable, we use $\omega=\frac{1}{50}$ in the convergence
simulations and $\omega=\frac{1}{100}$ in the results simulations.
We desire that $\omega\ge h$, so that the Lagrangian forces are spread
at least two Eulerian mesh widths in every direction (as is done in
the traditional IBM (\cite{Peskin2002})). Using $\omega=\frac{1}{50}$
in the convergence simulations allows $h=\frac{1}{64},\,\frac{1}{128},\,\frac{1}{256}$
to obey these criteria. We again note that one of the reasons for
using $\omega$ in the scaling of Equation (\ref{eq:Dirac Delta Approx})
as opposed to $h$ is that better spatial convergence rates are achieved
since the scaling is independent of $h$.


\subsection{\label{sub:Two-Dimensional-Validation}Two-Dimensional Validation}

In the absence of a biofilm, we expect that using a centered finite
difference approximation for the second derivatives allows \textit{exact}
convergence to the second-order polynomial solution (Equation (\ref{eq:2DlaminarSoln})).
That is to say, we expect the numerical solution to converge to the
analytical within machine precision. Reassuringly, we find that the
biofilm-free simulations converge exactly to the steady state laminar
flow.%
\footnote{In the 3D simulations, we do not see exact convergence since the laminar
solution is not a second-order polynomial. See \S\ref{sub:Three-Dimensional-Simulations}
for details on the convergence properties of the 3D laminar flow case. %
} To illustrate, we started with an initial velocity profile that is
one-half of that of the laminar flow velocity profile. The error in
the simulation converged (within machine precision) in less than 300
time iterations for all spatial resolutions (see Figure \ref{fig:2DLaminarConvergence}
for example with $h=\nicefrac{1}{128}$ and $dt=0.0001$). 
\begin{figure}
\begin{centering}
\includegraphics[width=4in]{ConvergenceToLaminarFlow}
\par\end{centering}

\caption{\label{fig:2DLaminarConvergence}Exact error in biofilm-free 2D simulation
with $h=\frac{1}{128}$. The solution is compared to the exact solution,
\eqref{2DlaminarSoln}, using a maximum norm. }
\end{figure}



\subsubsection{\label{sub:Multigrid-performance}Multigrid performance}

Next, we provide numerical evidence that the multigrid technique convergences
optimally to the solutions of Equations (\ref{eq:NSdis1-1}) and (\ref{eq:NSdis4}).
We define a \textit{work unit} as the cost of performing one relaxation
on the finest grid (see \cite{Briggs2000}). In Figure \ref{fig:Work Units Decrease 2D}(a),
we depict (for the pressure computation) the work units required to
reach the minimum residual error as a function of allowed levels in
the multigrid. This result shows that the number of work units required
decreases significantly with each added multigrid level. This means
that the multigrid method correctly accelerates the convergence of
our iterative method by doing computations on the coarser grids. For
example, with just one allowed level of multigrid, the relaxation
uses only the finest resolution grid and requires about $10^{5}$
work units, whereas with 6 multigrid levels we only require about
$10^{2}$ work units to achieve the same error. Note that there is
no reduction in the number of required work units with the addition
of a $7^{\textrm{th}}$ level in the multigrid, so we use at most
6 levels in our 2D solvers. The data in this plot was obtained using
our 2D simulation with a mushroom shaped biofilm similar to those
shown in \S\ref{sub:Two-Dimensional-Simulations}.

\begin{figure}[h]
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{2DmultConvWithLevels}(b)\includegraphics[width=0.45\columnwidth]{3DmultConvWithLevels}
\par\end{centering}

\caption{\label{fig:Work Units Decrease 2D}Decrease in work units required
to reach the minimum residual error as the number of multigrid levels
is increased in the (a) 2D simulations, (b) and 3D simulations. }
\end{figure}



\subsubsection{Empirical Estimate of Convergence Rate in Time}

Similar to the development in \cite{Mori2008}, we define a measure
of error by 
\begin{equation}
E_{p}(q(T);\Delta t)=\left\Vert q^{\Delta t}(T)-q^{\Delta t/2}(T)\right\Vert _{p},\label{eq:ErrorTemporal}
\end{equation}
which is the error difference at time $t=T$ in a computed quantity,
$q$, using a temporal refinement of a half timestep. Then, an \textit{empirical
estimate} for the convergence rate is calculated using 
\begin{equation}
r_{p}(q(T);\Delta t)=\log_{2}\left(\frac{E_{p}(q(T);\Delta t)}{E_{p}(q(T);\frac{\Delta t}{2})}\right).\label{eq:temporal convergence rate}
\end{equation}
We compute the approximate convergence rate in time using the $E_{2}$
and $E_{\infty}$ errors in the Eulerian variable, $\mathbf{u}$,
and in the Lagrangian variable, $\mathbf{X}$. We simulate until $t=T=0.01\,\textrm{s}$
using temporal step sizes that ranged from $\Delta t=\nicefrac{1}{5000}$
to $\Delta t=\nicefrac{1}{80000}$, decreasing by a factor of $2$
at each level. The Eulerian grid is discretized with a step size of
$h=\nicefrac{1}{256}$.

The empirical convergence rates from our temporal refinement are provided
in Table \ref{tab:ConvergenceTimeRefinement}. The immersed boundary
method, as we have implemented it, is formally second-order in space
and first order in time, but, for problems with sharp interfaces that
do not have smooth solutions, it is limited to first-order accuracy
in space and time. Thus for our problem we expect only first order
accuracy. The convergence rates in time given in Table \ref{tab:ConvergenceTimeRefinement}
show first-order convergence in time as is expected. In Figure \ref{fig:ErrRef}(a),
we depict the exact values of $E_{p}(q(T);\Delta t)$ for $q=\mathbf{X}$
and $q=\mathbf{u}$. We show $\log_{2}$ in the $x$ and $y$ axes
so that the empirical convergence rates from Table \ref{tab:ConvergenceTimeRefinement}
appear as the slope of the line segments. 


\subsubsection{\label{sub:Eulerian-Grid-Refinement}Empirical Estimate of Convergence
Rate in Space}

For this refinement study, we define a measure of error by 
\begin{equation}
E_{p}(q(T);h)=\left\Vert q^{h}(T)-I_{h}^{2h}\left(q^{h/2}(T)\right)\right\Vert _{p},\label{eq:ErrorSpatial}
\end{equation}
which is the error difference at time $t=T$ in a computed quantity,
$q$, using a spatial refinement of a half. In this definition, $I_{h}^{2h}$
is the restriction operator from a fine to a coarse grid. Then, an
empirical estimate for the convergence rate is calculated using 
\begin{equation}
r_{p}(q(T);h)=\log_{2}\left(\frac{E_{p}(q(T);h)}{E_{p}(q(T);\frac{h}{2})}\right).\label{eq:convergenceRate}
\end{equation}
We note that the estimates for convergence rates given by Equations
(\ref{eq:temporal convergence rate}) and (\ref{eq:convergenceRate})
have a fairly simple derivation using a Taylor series expansion (see
\cite{Ferziger2002} or \cite{LeVeque2007}). 

In the spatial refinement analysis, we did not refine the Lagrangian
grid with the Eulerian grid, so the same number of Lagrangian points
were present in all of the simulations. In addition, full weighting
restriction is used in the definition of the error, Equation (\ref{eq:ErrorSpatial}),
for the error in $\mathbf{u}$. We also used a fixed timestep of $\Delta t=10^{-4}$
until $t=T=0.01\,\textrm{s}$ for all of these simulations. The computed
convergence rates from this refinement are provided in Table \ref{tab:ConvergenceEulerianRefinement}.
The $\infty$-norm convergence rates given in Table \ref{tab:ConvergenceEulerianRefinement}
show greater than first-order convergence in space for the error in
the Lagrangian variable $\mathbf{X}$ and in the Eulerian variable
$\mathbf{u}$. The seemingly large convergence rates for the lower
resolution grids ($h=\frac{1}{16},\,\frac{1}{32},\,\frac{1}{64}$
) can be explained by the fact that using $\omega=\frac{1}{50}$ in
the Dirac delta approximations does not allow the Lagrangian forces
to be adequately represented in the Eulerian grid. This leads to larger
errors in the coarse-grid simulations. Therefore, the best estimates
for the convergence rates are the ones using the three resolutions
all obeying $\omega>h$ given in the 4\textsuperscript{th} and 7\textsuperscript{th}
columns of Table \ref{tab:ConvergenceEulerianRefinement}. In Figure
\ref{fig:ErrRef}(b), we depict the exact values of $E_{p}(q(T);h)$
for $q=\mathbf{X}$ and $q=\mathbf{u}$. We show $\log_{2}$ in the
$x$ and $y$ axes so that the empirical convergence rates from Table
\ref{tab:ConvergenceEulerianRefinement} appear as the slope of the
line segments. We discuss possibilities for improvement in the convergence
rates later in the conclusion sections. 

We also used a grid refinement analysis to find the empirical convergence
rate with spatial refinement when the density of the biofilm is two
times that of the surrounding fluid. This analysis was done to show
that the first order convergence rate is maintained with the increased
density in the biofilms. The results of this convergence analysis
are shown in Table \ref{tab:ConvergenceEulerianRefinementDensity}
and Figure \ref{fig:ErrRef}(c).

Finally, we compute the empirical convergence rates for our 2D simulation
with variable viscosity. In this convergence study, (\tabref{ConvergenceEulerianRefinementViscSpr}
and \figref{ErrRef}(d)) we use a non-dimensionalized value of biofilm
viscosity of $\mu_{max}=500$, which means that the viscosity at the
location of a Lagrangian node is 500 times that of the surrounding
fluid. First-order convergence in space is maintained, even with this
very large biofilm viscosity. 
\begin{figure}[H]
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{2DConvRateTemporalRefineWis1_50}(b)\includegraphics[width=0.45\columnwidth]{2DConvRateSpatialRefineWis1_50}\\
(c)\includegraphics[width=0.45\columnwidth]{2DConvRateSpatialRefineWis1_50addldens1}(d)\includegraphics[width=0.45\columnwidth]{2DConvRateSpatialRefineWis1_50addlvisc500}
\par\end{centering}

\caption{\label{fig:ErrRef}Empirical error estimates with (a) temporal refinement:
$E_{p}(q(T);\Delta t)$ is the $p$-norm of the error as defined by
\eqref{ErrorTemporal}, (b) spatial refinement with constant density
and viscosity: $E_{p}(q(T);h)$ is the $p$-norm of the error as defined
by \eqref{ErrorSpatial}, (c) spatial refinement and increased biofilm
density, (d) spatial refinement and increased biofilm viscosity. In
all plots, we show $\log_{2}$ in the $x$ and $y$ axes so that the
empirical convergence rate appears as the slope of the line segments. }
\end{figure}
\begin{table}[H]
\begin{centering}
\begin{tabular}{|l|l|l|l|l|l|l|}
\hline 
q & \begin{sideways}
$r_{2}(q(T);2\times10^{-4})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);10^{-4})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{10^{-4}}{2})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);2\times10^{-4})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);10^{-4})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{10^{-4}}{2})$
\end{sideways}\tabularnewline
\hline 
$\mathbf{u}$ & 1.32 & 1.31 & 1.08 & 1.29 & 1.28 & 1.07\tabularnewline
\hline 
$\mathbf{X}$ & 1.12 & 1.45 & 0.54 & 1.04 & 1.23 & 1.07\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{\label{tab:ConvergenceTimeRefinement}Empirical convergence rates
with temporal refinement. $r_{p}(q(T);dt)$ is the convergence rate
in the variable, $q$, at $t=T$ using the $p$-norm and the three
time steps $dt,\,\nicefrac{dt}{2},\,\nicefrac{dt}{4}$.}
\end{table}
\begin{table}[H]
\begin{centering}
\begin{tabular}{|l|l|l|l|l|l|l|}
\hline 
q & \begin{sideways}
$r_{2}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{64})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{128})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{64})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{128})$
\end{sideways}\tabularnewline
\hline 
$\mathbf{u}$ & 2.03 & 2.10 & 2.25 & 1.83 & 1.90 & 1.67\tabularnewline
\hline 
$\mathbf{X}$ & 1.24 & 4.00 & 3.53 & 1.95 & 3.30 & 3.77\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{\label{tab:ConvergenceEulerianRefinement}Empirical convergence rates
with spatial refinement. $r_{p}(q(T);h)$ is the convergence rate
in the variable, $q$, at $t=T$ using the $p$-norm and the three
Eulerian step sizes $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$.}
\end{table}
\begin{table}[H]
\begin{centering}
\begin{tabular}{|l|l|l|l|l|l|l|}
\hline 
q & \begin{sideways}
$r_{2}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{64})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{128})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{64})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{128})$
\end{sideways}\tabularnewline
\hline 
$\mathbf{u}$ & 1.42 & 1.43 & 1.19 & 1.01 & 1.54 & 1.23\tabularnewline
\hline 
$\mathbf{X}$ & 0.50 & 2.97 & 1.63 & 1.19 & 2.92 & 1.63\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{\label{tab:ConvergenceEulerianRefinementDensity}Empirical convergence
rates with spatial refinement and increased biofilm density. $r_{p}(q(T);h)$
is the convergence rate in the variable, $q$, at $t=T$ using the
$p$-norm and the three Eulerian step sizes $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$.
In this experiment, the density of the biofilm is double that of the
surrounding fluid.}
\end{table}
\begin{table}[H]
\begin{centering}
\begin{tabular}{|l|l|l|l|lll|}
\hline 
q & \begin{sideways}
$r_{2}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{64})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{128})$
\end{sideways} & \multicolumn{1}{l|}{\begin{sideways}
$r_{\infty}(q(T);\frac{1}{32})$
\end{sideways}} & \multicolumn{1}{l|}{\begin{sideways}
$r_{\infty}(q(T);\frac{1}{64})$
\end{sideways}} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{128})$
\end{sideways}\tabularnewline
\hline 
$\mathbf{u}$ & 0.91 & 0.89 & 0.85 & 0.88 & 1.62 & 1.08\tabularnewline
\hline 
$\mathbf{X}$ & 2.02 & 1.12 & 1.44 & 1.87 & 1.21 & 1.59\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{\label{tab:ConvergenceEulerianRefinementViscSpr}Empirical convergence
rates with spatial refinement and increased biofilm viscosity. $r_{p}(q(T);h)$
is the convergence rate in the variable, $q$, at $t=T$ using the
$p$-norm and the three Eulerian step sizes $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$.
In this experiment the viscosity of the biofilm is 500 times that
of the surrounding fluid.}
\end{table}



\subsubsection{\label{sub:Time-Step-Stability-Restrictions}Time-Step Stability
Restrictions}

Finally, we investigated the stability of the method computationally
as it depends on the spatial and temporal refinement and the stiffness
of the springs. Analytically, stability applies to a numerical scheme
and not to a computational run, but here we follow \cite{Mori2008}
and give a simple definition of the stability for each computational
run. Using the square of the $2$-norm defined by \eqref{EulPnorm}
on $\mathbf{u}$ (i.e.~$\left\Vert \mathbf{u}\right\Vert _{p}^{2}$)
gives a value which is proportional to the kinetic energy in the system.
We call the simulation \textit{stable} if magnitude of the total velocity
(as measured by the total kinetic energy) does not have a time of
extreme growth during the simulation. Moreover, this kinetic energy
should remain relatively close to the value of the total kinetic energy
in the case of no biofilm. Using this definition of stability, we
found, through experimentation with many combinations of $h$, $\Delta t$,
and $F_{max}$, that we have timestep restrictions that scale with
the mesh-width, $h$, and with the maximum Lagrangian force, $F_{max}$.
The restrictions are approximately given by 
\[
\triangle t\le C_{1}h\,
\]
and 
\[
\triangle t\le\frac{C_{2}}{F_{max}}\,,
\]
where $C_{1}$ and $C_{2}$ are positive proportionality constants.
Specific values of $C_{1}$ and $C_{2}$ change depending on the parameters
of the simulation. In future simulations, we hope to avoid these timestep
restrictions by using an implicit or semi-implicit method as is done
in \cite{Mori2008} and \cite{Newren2007}. All of the simulations
shown in this work and used in the convergence testing used time-steps
satisfying these two restrictions. 


\subsection{\label{sub:Three-Dimensional-Validation}Three-Dimensional Validation}

In this subsection, we provide some numerical evidence validating
the 3D simulations. We first validate in the absence of a biofilm
using the exact laminar flow solution. Then, we validate the multigrid
method in the presence of a biofilm and, finally, we provide the empirical
convergence rates for the simulation in the presence of a biofilm. 

We first tested the rate of convergence of our method on the laminar
flow case without the interference of a biofilm. To illustrate the
convergence rate in the absence of a biofilm, we started with an initial
velocity profile that is one-half of that of the laminar flow velocity
profile, given by Equation (\ref{eq:3DlaminarFlow}). We ran the simulation
enough timesteps until the approximate solution converged, with only
discretization error remaining, to the exact solution for six spatial
step sizes, $h=\left\{ \frac{1}{4},\,\frac{1}{8},\,\frac{1}{16},\,\frac{1}{32},\,\frac{1}{64},\,\frac{1}{128}\right\} $.
We computed the discretization error (using the exact laminar solution,
Equation (\ref{eq:3DlaminarFlow}), for computations) for each of
the step sizes and found that the error is $O(h^{2})$. This can be
seen in Figure \ref{fig:Laminar convergence rate}, where on the vertical
axis we have the $\log_{2}$ of the error so that the convergence
rate appears as the slope in the plot. 

Next, in Figure \ref{fig:Work Units Decrease 2D}(b), we depict (for
the pressure computation) the work units required to reach the minimum
residual error as a function of allowed levels in the multigrid approach.
This again implies that the multigrid method correctly accelerates
the convergence of our iterative method for the 3D simulations with
a biofilm. Note that there is only a slight reduction in the number
of required work units with the addition of a $6^{\textrm{th}}$ level
in the multigrid, and we saw no reduction with 7 levels, so we use
at most 6 levels in our 3D solvers.

\begin{figure}[h]
\begin{centering}
\includegraphics[width=4in]{Fig4}
\par\end{centering}

\caption{\label{fig:Laminar convergence rate}We show the convergence rate
in the laminar flow case. These points are discretization errors for
each of the spatial step sizes ($\frac{1}{4},\,\frac{1}{8},\,\frac{1}{16},\,\frac{1}{32},\,\frac{1}{64},\,\frac{1}{128}$). }
\end{figure}


Finally, as was done for the 2D case in \S\ref{sub:Eulerian-Grid-Refinement},
we compute the empirical convergence rates for our 3D simulation in
the presence of the biofilm shown in Figure \ref{fig:Mushroom-shaped-biofilm2Dsims}(b)
with all of the same fluid parameters used in the 2D analysis. Using
the $p$-norms defined above, we can compute the convergence rates
using Equations (\ref{eq:temporal convergence rate}) and (\ref{eq:convergenceRate})
(see Figure \ref{fig:EmpConvErr3D}(a) and Table \ref{tab:ConvergenceTemporalRefinement3D}).
For the temporal convergence analysis, we used $\omega=\frac{1}{50}$
and $h=\frac{1}{64}$. This analysis resulted in first-order convergence
in all measures except $r_{p}(q(T);\Delta t)$ in which it has an
average convergence rate of about $0.6$. Next, we found empirical
convergence rates for spatial refinement (see Table \ref{tab:ConvergenceEulerianRefinement3D}
and Figure \ref{fig:EmpConvErr3D}(b)). As expected, we observe a
greater than first-order convergence rate in both the Eulerian velocity,
$\mathbf{u}$, and the Lagrangian position, $\mathbf{X}$. Next, we
conducted a spatial refinement analysis with a biofilm that has double
the density of the surrounding fluid (see Table \ref{tab:ConvergenceEulerianRefinementDensity3D}
and Figure \ref{fig:EmpConvErr3D}(c)). Finally, we did the spatial
refinement study for our simulations with $\mu_{max}=500$, and again
achieved first-order spatial convergence (see Table \ref{tab:ConvergenceEulerianRefinementViscSpr3D}
and Figure \ref{fig:EmpConvErr3D}(d)). 
\begin{figure}[h]
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{3DConvRateTemporalRefineWis1_50}(b)\includegraphics[width=0.45\columnwidth]{3DConvRateSpatialRefineWis1_50}\\
(c)\includegraphics[width=0.45\columnwidth]{3DConvRateSpatialRefineWis1_50addldens1}(d)\includegraphics[width=0.45\columnwidth]{3DConvRateSpatialRefineWis1_50addlvisc500}
\par\end{centering}

\caption{\label{fig:EmpConvErr3D}Empirical errors in the 3D simulations with
(a) temporal refinement: $E_{p}(q(T);\Delta t)$ is the $p$-norm
of the error as defined by Equation (\ref{eq:ErrorTemporal}), (b)
spatial refinement with constant density and viscosity: $E_{p}(q(T);h)$
is the $p$-norm of the error as defined by Equation (\ref{eq:ErrorSpatial}),
(c) spatial refinement and increased biofilm density, (d) spatial
refinement and increased biofilm viscosity. We show $\log_{2}$ in
the $x$ and $y$ axes so that the empirical convergence rate appears
as the slope of the line segments.}
\end{figure}
\begin{table}[H]
\begin{centering}
\begin{tabular}{|l|l|l|l|l|l|l|}
\hline 
q & \begin{sideways}
$r_{2}(q(T);.0004)$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);.0002)$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);10^{-4})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);.0004)$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);.0002)$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);10^{-4})$
\end{sideways}\tabularnewline
\hline 
$\mathbf{u}$ & 0.71 & 0.35 & 0.64 & 1.04 & 1.18 & 0.83\tabularnewline
\hline 
$\mathbf{X}$ & 0.90 & 1.03 & 1.11 & 0.90 & 1.02 & 0.88\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{\label{tab:ConvergenceTemporalRefinement3D}Empirical convergence
rates in the 3D simulations with temporal refinement are shown for
$\mathbf{u}$ and $\mathbf{X}$. $r_{p}(q(T);\Delta t)$ is the convergence
rate in the variable, $q$, at $t=T$ using the $p$-norm and the
three Eulerian step sizes $\Delta t,\,\nicefrac{\Delta t}{2},\,\nicefrac{\Delta t}{4}$.}
\end{table}
\begin{table}[H]
\begin{centering}
\begin{tabular}{|l|l|l|l|l|l|l|}
\hline 
q & \begin{sideways}
$r_{2}(q(T);\frac{1}{16})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{64})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{16})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{64})$
\end{sideways}\tabularnewline
\hline 
$\mathbf{u}$ & 1.46 & 1.47 & 1.11 & 0.97 & 0.98 & 0.99\tabularnewline
\hline 
$\mathbf{X}$ & 3.25 & 1.84 & 3.11 & 3.91 & 1.75 & 3.17\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{\label{tab:ConvergenceEulerianRefinement3D}Empirical convergence
rates in the 3D simulations with spatial refinement are shown for
$\mathbf{u}$ and $\mathbf{X}$. $r_{p}(q(T);h)$ is the convergence
rate in the variable, $q$, at $t=T$ using the $p$-norm and the
three Eulerian step sizes $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$.}
\end{table}
\begin{table}[H]
\begin{centering}
\begin{tabular}{|l|l|l|l|l|l|l|}
\hline 
q & \begin{sideways}
$r_{2}(q(T);\frac{1}{16})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{64})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{16})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{64})$
\end{sideways}\tabularnewline
\hline 
$\mathbf{u}$ & 1.44 & 1.47 & 1.15 & 1.05 & 0.94 & 0.74\tabularnewline
\hline 
$\mathbf{X}$ & 2.61 & 1.94 & 2.24 & 2.72 & 1.81 & 2.91\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{\label{tab:ConvergenceEulerianRefinementDensity3D}Empirical convergence
rates with 3D spatial refinement and increased biofilm density. $r_{p}(q(T);h)$
is the convergence rate in the variable, $q$, at $t=T$ using the
$p$-norm and the three Eulerian step sizes $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$.
In this experiment, the density of the biofilm is double that of the
surrounding fluid.}
\end{table}
\begin{table}[H]
\begin{centering}
\begin{tabular}{|l|l|l|l|lll|}
\hline 
q & \begin{sideways}
$r_{2}(q(T);\frac{1}{16})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{32})$
\end{sideways} & \begin{sideways}
$r_{2}(q(T);\frac{1}{64})$
\end{sideways} & \multicolumn{1}{l|}{\begin{sideways}
$r_{\infty}(q(T);\frac{1}{16})$
\end{sideways}} & \multicolumn{1}{l|}{\begin{sideways}
$r_{\infty}(q(T);\frac{1}{32})$
\end{sideways}} & \begin{sideways}
$r_{\infty}(q(T);\frac{1}{64})$
\end{sideways}\tabularnewline
\hline 
$\mathbf{u}$ & 1.07 & 0.82 & 0.45 & 0.54 & 0.96 & 1.40\tabularnewline
\hline 
$\mathbf{X}$ & 2.31 & 1.15 & 1.43 & 2.70 & 1.32 & 1.98\tabularnewline
\hline 
\end{tabular}
\par\end{centering}

\caption{\label{tab:ConvergenceEulerianRefinementViscSpr3D}Empirical convergence
rates with 3D spatial refinement and increased biofilm viscosity.
$r_{p}(q(T);h)$ is the convergence rate in the variable, $q$, at
$t=T$ using the $p$-norm and the three Eulerian step sizes $h,\,\nicefrac{h}{2},\,\nicefrac{h}{4}$.
In this experiment, the viscosity of the biofilm is 500 times that
of the surrounding fluid.}
\end{table}


This concludes our validation section, and we now present the results
of our numerical simulations.


\section{\label{sec:Simulations-Results}Simulations Results}

In this section, we present the results of our numerical simulations.
First, we briefly discuss the reality of elastic forces in biofilms.
Then we provide 2D results in \S\ref{sub:Two-Dimensional-Simulations}
and 3D results in \S\ref{sub:Three-Dimensional-Simulations}.


\subsection{\label{sub:Discussion-of-Elastic}Discussion of Elastic Maximum Force,
$F_{max}$}

We now provide a brief discussion of the physical reality of the values
of $F_{max}$ used in our simulations. The \textit{cohesive strength}%
\footnote{The cohesive strength is a measure of the forces that interconnect
the biofilm's cells.%
} in biofilms has been found experimentally to be highly heterogeneous,
with repeated experimental measurements on the same biofilm yielding
vastly different strength measurements. For example, 49 cohesive strength
measurements taken on only two samples of \textit{Staphylococcus epidermidis
}yielded measurements between 61-5182 Pa (\cite{Aggarwal2010}). These
biofilms were grown on a $22\,\textrm{mm}$ diameter disc rotating
at 75 $\textrm{\ensuremath{\nicefrac{rot}{min}}}$ so the fastest
speed, $\sim86\,\nicefrac{\textrm{mm}}{\textrm{s}}$, was at the perimeter
of the disc (i.e. very slow flow growth conditions). The \textit{adhesive}%
\footnote{The adhesive strength is a measure of the forces that connect a biofilm
to the surface.%
} and cohesive strengths have also been shown to vary significantly
with changes in growth conditions such as flow rate and nutrient concentration.
Changes in these growth conditions influence the amount of ECM production
in the biofilm as well as the compactness of the biofilm, which has
a direct effect on its strengths (\cite{Chen2005effectsAdhesiveStrength,Ohashi1996,chen1998directBiofilmStrengthTube}).
We note here that the required values we find for $F_{max}$ for the
biofilms to remain attached in our 2D and 3D simulations are consistent
with the cohesive strength measurements provided in \cite{Aggarwal2010}.
Since the diameter of \textit{Staphylococcus epidermidis} is about
$1\,\mu$m, in 3D, we multiply the cohesive strengths by $1\,\mu\textrm{m}^{2}$
to get an approximation for the range of forces on the surface area
of one cell. Using the range of 61-5182 Pa yields a range of forces
from $6.1\times10^{-11}$ N to $5.18\times10^{-9}$ N. In 2D, we multiply
the cohesive strengths by the cell diameter to get a rough approximation
for the range of forces on the surface perimeter surrounding one cell.
Using the range of 61-5182 Pa yields a range of forces from $6.1\times10^{-5}$
N to $5.18\times10^{-3}$ N. Our values for $F_{max}$ are at the
low end of these ranges. The actual strength of the biofilm is most
likely larger than our $F_{max}$ values since the positional data
was from a biofilm that was not fragmenting in the flow conditions
in which it was grown, and we used the same flow conditions in our
simulations. Thus, in order to see detachment under these flow conditions,
we had to lower the value of $F_{max}$. We could alternatively increase
the flow rate to necessitate a larger $F_{max}$ requirement to avoid
detachment. One eventual goal of this work is that, if the approximate
value of $F_{max}$ is known for a particular type of biofilm, then
our simulations can be used to predict the flow rates required to
break different shaped biofilms. 


\subsection{Two-Dimensional Simulations\label{sub:Two-Dimensional-Simulations}}

In this section, we provide results from our 2D simulations, which
represent a cross-section of a biofilm attached to the inside of a
tube and subjected to fluid flow in a computational domain of $150\,\mu\textrm{m}$
by $50\,\mu\textrm{m}$. The parameters for our simulations are given
in Table \ref{tab: 2D sim params}.

\begin{table}
\centering{}%
\begin{tabular}{|l|c|}
\hline 
\multicolumn{2}{|c|}{Parameter Values for the Simulations}\tabularnewline
\hline 
\hline 
Tube Radius & $25\times10^{-6}\,\textrm{m}$\tabularnewline
\hline 
Fluid Dynamic Viscosity & $1.0\times10^{-3}\,\nicefrac{\textrm{kg}}{\textrm{m\ensuremath{\cdot}s}}$\tabularnewline
\hline 
Fluid Density & $998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}}$\tabularnewline
\hline 
Maximum Fluid Velocity & $10^{-3}\,\nicefrac{\textrm{m}}{\textrm{s}}$\tabularnewline
\hline 
\end{tabular}\\
\caption{\label{tab: 2D sim params}The values of parameters used in the 2D
simulations.}
\end{table}


In all simulations, we implement a breaking condition on the springs
of two times the rest length. The initial configuration for the biofilm
in these simulations is shown in Figure \ref{fig:Mushroom-shaped-biofilm2Dsims}.
The spring connections between Lagrangian nodes are put in place at
the beginning of the simulation with every node connected to every
other node less than $d_{c}$ away (the reason for this connection
distance is given above in \S\ref{sub:SimSetup}). The mushroom shaped
biofilm has a height of about $8.5\,\mu\textrm{m}$ and width of about
$8\,\mu\textrm{m}$ (width of about $2\,\mu\textrm{m}$ at the thinnest
part) . We use a non-dimensionalized $\omega=\frac{1}{100}$ to match
the radius of \textit{Staphylococcus epidermidis} and choose $h=\frac{1}{128}$
in all of the simulations shown, so that $\omega>h$. 

In the first simulation, the maximum spring force, $F_{max}$, is
set to $5.00\times10^{-7}\,\textrm{N}$, and the results are provided
in Figure \ref{fig:ShroomNoaddl_f175}. The biofilm bends over in
the flow, and the connections in the thin part of the biofilm break
as they stretch too far. The blue streamlines in (b), (c), and (d)
of Figure \ref{fig:ShroomNoaddl_f175} and in all of the other 2D
simulation plots follow the trajectories given by the velocity field,
$\mathbf{u}$. 

We point out that the values of the spring constants are well within
physically realistic values (see the discussion in \S\ref{sub:Discussion-of-Elastic}),
although, in this work, we have chosen these values for the qualities
they give to the simulations rather than experimental evidence of
the elastic strength of biofilms. For example, in these 2D simulations,
we investigated several simulation runs with various spring constants
until we obtained those that exhibited the above described behaviors.

Next, we conducted a simulation of the same mushroom shaped biofilm
with all of the same parameter values, but we gave the biofilm additional
density of $\rho_{b}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}}$
compared to the ambient fluid. We know this density is larger than
what is seen in actual biofilms (at most 20\% greater density than
water (\cite{Masuda1991,Ro1991})), but we chose it to show an exaggerated
example of increasing the biofilm density. These result is provided
in Figure \ref{fig:ShroomAddl}(b) and illustrates that the added
density essentially adds momentum to the biofilm. This additional
momentum causes the biofilm to curl over into the slower flow region
and thus prevents detachment. 

Finally, we conducted a simulation of the same mushroom shaped biofilm
with all of the same parameter values as the first simulation, but
we increased $F_{max}$ to $5.00\times10^{-6}\,\textrm{N}$. The effect
of these stronger springs is that the thin part of the biofilm does
not stretch enough to break the connections. The result is depicted
in Figure (\ref{fig:ShroomAddl})(c). We can see from these simulations
that either increasing the biofilm density or strengthening the springs
causes similar results, but, with the increased density, the biofilm
has more of a curling action. 

In the next simulation, we use all of the same parameters described
in the first simulation, with the addition that the biofilm has a
500$\times$ larger viscosity than the surrounding fluid, so $\mu_{max}=0.5\,\nicefrac{\textrm{kg}}{\textrm{m}\cdot\textrm{s}}$.
Comparing simulation results illustrated in Figure \ref{fig:ShroomAddl}(d)
and Figure \ref{fig:ShroomAddl}(a), which show the biofilm configurations
just before detachment, we observe a longer time until detachment
in the high viscosity case. This is the expected outcome of increasing
the viscosity in the biofilm. We note here that we used $\omega=\frac{1}{100}$
in the equation for $\mu(\mathbf{x})$ in Equation (\ref{eq:ViscExp})
because we wanted to spread additional viscosity over the same region
that the elastic forces are spread to. We achieve an even longer detachment
time in the simulation by widening the influence of additional viscosity
by using, for example $\omega=\frac{1}{50}$. 

\begin{figure}[H]
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{shroom2Dnondim_noAddl_t_0_00_f10}(b)\includegraphics[width=0.45\columnwidth]{shroom2Dnondim_noAddl_t_0_02_f10}\\
(c)\includegraphics[width=0.45\columnwidth]{shroom2Dnondim_noAddl_t_0_028_f10}(d)\includegraphics[width=0.45\columnwidth]{shroom2Dnondim_noAddl_t_0_04_f10}
\par\end{centering}

\caption{\label{fig:ShroomNoaddl_f175}2D Simulation of a mushroom shaped biofilm
with the same density as the surrounding fluid. Time $t$ is in seconds
and the distance is in microns. In this simulation, $\rho_{0}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}},\:\rho_{b}=0,\: F_{max}=5.00\times10^{-7}\,\textrm{N}$.
The blue streamlines follow the velocity field. In this simulation,
the top of the biofilm stretches in the flow, and the top breaks off
as the connections in the the middle separate as they exceed the breaking
criteria of twice the rest length. As expected in a laminar shear
flow, the broken piece then tumbles end over end through the flow.}
\end{figure}


\begin{figure}[H]
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{shroom2Dnondim_noAddl_t_0_028_f10}(b)\includegraphics[width=0.45\columnwidth]{shroom2Dnondim_Addl0_0visc1_0dens_t_0_14_f10}\\
(c)\includegraphics[width=0.45\columnwidth]{shroom2Dnondim_noAddl_t_0_16_f100}(d)\includegraphics[width=0.45\columnwidth]{shroom2Dnondim_Addl500_0visc0_0dens_t_0_048_f10}
\par\end{centering}

\caption{\label{fig:ShroomAddl} Snapshots in time ($t$ in seconds) of cell
distributions resulting from 2D simulation of mushroom shaped biofilm
with four different property configurations. In (a), the biofilm has
the same density and viscosity as the surrounding fluid (just before
detachment), (b) increased $F_{max}$, (c) density twice as large
as the surrounding fluid density, and (d) viscosity is $500\times$
that of the surrounding fluid (just before detachment). The blue streamlines
follow the velocity field.}
\end{figure}



\subsection{Three-Dimensional Simulations\label{sub:Three-Dimensional-Simulations}}

In this section, we provide results from our 3D simulations, which
use the same parameter values as in the two dimensional simulations
(see Table \ref{tab: 2D sim params}). The difference is that the
simulation in 3D represents flow through a square shaped tube with
a side length of $50\,\mu\textrm{m}$. Note that these 3D simulations
reproduce qualitatively the same results as in the 2D ones.

Our 3D simulations were run on a $50\times50\times150\,\mu\textrm{m}$
computational domain. We simulate on a mushroom shaped biofilm with
a height of about $8.5\,\mu\textrm{m}$ and a diameter of about $7.5\,\mu\textrm{m}$.
This shape is carved from the same set of data points described in
\S\ref{sub:SimSetup}. The spring connections between Lagrangian
nodes are put in place at the beginning of the simulation, with every
node connected to every other node less than $d_{c}=3\,\mu\textrm{m}$
away. Note that, for the 3D simulations, we increased $d_{c}$ slightly
to establish enough connections in the biofilm. We again use $\omega=\frac{1}{100}$
to match the radius of \textit{Staphylococcus epidermidis} and choose
$h=\frac{1}{128}$ in all of the simulations shown, so that $\omega>h$.
In the first simulation, the maximum spring force, $F_{max}$, is
set to $1.25\times10^{-12}\,\textrm{N}$. %
\begin{comment}
Typically the adhesive strength is on the order of $nN$,nano-Newtons,
but since our input velocity $v_{0}$ is $10^{-3}\textrm{m/s}$ our
$F_{max}$ is lower. I expect $F_{max}$ would increase if we increased
the $v_{0}$ to $1m/s$. Alpkvist and Klapper paper had a Re=.3 so
that's why ours is low also, just Re=.05, but typical experiments
have Re>50 so this would be consistent if we increase the speed to
$v_{0}=1m/s$.
\end{comment}
{} We again chose the value of these spring constants in order to illustrate
specific behaviors. The results of the first simulation are shown
in \S\ref{fig:Shroom3DNoaddl_0_5}. The mushroom shaped biofilm bends
over and stretches in the flow. The connections in the midsection
of the biofilm exceed their breaking length and the top of the biofilm
breaks off into the flow. Next, we ran a simulation of the same mushroom
shaped biofilm, but we added $\rho_{b}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}}$
additional density to the biofilm compared to the surrounding fluid.
The final result is provided in Figure \ref{fig:Shroom3Daddl}(b)
and illustrates that the added density increases the momentum of the
biofilm. This allows for the mushroom to curl over into the flow and
increases the time until detachment. We also ran a simulation of the
same mushroom shaped biofilm, but we increased $F_{max}$ to $1\times10^{-11}\,\textrm{N}$
and kept the biofilm density the same as the surrounding fluid. The
result is provided in Figure \ref{fig:Shroom3Daddl}(c). The effect
of these stronger springs is that the thin part of the biofilm does
not stretch enough to break the connections. We can see from these
simulations that either increasing the biofilm density or strengthening
the springs causes similar results, but with the increased density
the biofilm just curls over.

Finally, we provide one 3D simulation to show that, with increased
biofilm viscosity, they produce qualitatively the same behavior as
in the 2D case. In the simulation result shown in Figure \ref{fig:Shroom3Daddl}(d),
we use the same parameters as the first 3D simulation, but we use
a viscosity in the biofilm that is a factor of $500$ times that of
the surrounding fluid. Just as in the 2D case, this results in a longer
time until detachment (compare time in Figure \ref{fig:Shroom3Daddl}(a)
and Figure \ref{fig:Shroom3Daddl}(d)). 

For ease of comparison, we now provide the figures in the order in
which they were discussed in this section.

\begin{figure}[H]
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{shroom3Dnondim_noAddl_t_0_00_f0_5}(b)\includegraphics[width=0.45\columnwidth]{shroom3Dnondim_noAddl_t_0_02_f0_5}\\
(c)\includegraphics[width=0.45\columnwidth]{shroom3Dnondim_noAddl_t_0_04_f0_5}(d)\includegraphics[width=0.45\columnwidth]{shroom3Dnondim_noAddl_t_0_06_f0_5}
\par\end{centering}

\caption{\label{fig:Shroom3DNoaddl_0_5}Full 3D simulation of a mushroom shaped
biofilm with the same density as the surrounding fluid. The time $t$
is in seconds and the distance is in microns. As the biofilm stretches
in the flow, the strain in the midsection exceeds the breaking length
of the connections, and the top of the biofilm breaks off into the
flow. Then the broken piece tumbles end over end through the flow,
and the base retracts back. In this simulation, $\rho_{0}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}},\:\rho_{b}=0,\: F_{max}=1.25\times10^{-12}\,\textrm{N}$. }
\end{figure}


\begin{figure}[H]
\centering{}(a)\includegraphics[width=0.45\columnwidth]{shroom3Dnondim_noAddl_t_0_04_f0_5}(b)\includegraphics[width=0.45\columnwidth]{shroom3Dnondim_Addl0_0visc1_0dens_t_0_12_f0_5}\\
(c)\includegraphics[width=0.45\columnwidth]{shroom3Dnondim_noAddl_t_0_10_f4_0}\includegraphics[width=0.45\columnwidth]{shroom3Dnondim_Addl500_0visc0_0dens_t_0_051_f0_5}\caption{\label{fig:Shroom3Daddl}Snapshots in time ($t$ in seconds) of cell
distributions resulting from 3D simulation of mushroom shaped biofilm
with four different property configurations. In (a), the biofilm has
the same density and viscosity as the surrounding fluid (just before
detachment), (b) increased $F_{max}$, (c) density twice as large
as the surrounding fluid density, and (d) viscosity is $500\times$
that of the surrounding fluid (just before detachment). }
\end{figure}


\begin{comment}
In \figref{RealShroomDiffViews} we show 4 views of the biofilm cell
locations taken from a $10\,\times\,20\,\mu\textrm{m}$ subset of
the same data set used to acquire the cell locations for the 2D representation
from \secref{Realistically-Shaped-Biofilm} and \subref{2D-SimulationsWithViscosity}.
These points were connected with a $2.5\,\mu\textrm{m}$ connection
criteria. Observation of this biofilm yields some voids in the structure
at which the biofilm has absolutely no cells. It also shows that this
segment of biofilm grew quite top-heavy leaving an obvious weak point
in its central region. 

\begin{figure}[h]
\begin{centering}
(a)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{x_y_planeRealBiofilmFrontview.eps}(b)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{x_z_planeRealBiofilmTopview.eps}\\
(c)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{y_z_planeRealBiofilmSideview.eps}(d)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{x_y_z_planeRealBiofilmDiagview.eps}
\par\end{centering}

\caption{\label{fig:RealShroomDiffViews}Illustrates the bacterial cell locations
of an real experimental section of biofilm of \textit{Staphylococcus
epidermidis} (a) upstream-view, (b) top-view, (c)side-view (d) angled-view. }
\end{figure}


In \figref{RealShroom3DNoaddl} we show the result of running the
simulation on the real section of biofilm. In this simulation we use
the same parameters that were used in the first simulation of \subref{Three-Dimensional-Simulations}. 

\begin{figure}[h]
(a)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{Fig9a.eps}(b)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{Fig9b.eps}\\
(c)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{Fig9c.eps}(d)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{Fig9d.eps}\\
(e)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{Fig9e.eps}(f)\includegraphics[width=3in,bb = 0 0 200 100, draft, type=eps]{Fig9f.eps}

\caption{\label{fig:RealShroom3DNoaddl}Full 3D simulation of a mushroom shaped
biofilm with the same density as the surrounding fluid. The time is
in seconds and the distance is in microns. As the biofilm stretches
in the flow the strain in the midsection exceeds the breaking length
of the connections, and the top of the biofilm breaks off into the
flow. Then the broken piece tumbles end over end through the flow,
and the base retracts back. In this simulation $\rho_{0}=998\,\nicefrac{kg}{m^{3}},\:\rho_{b}=0,\: F_{max}=1.25\times10^{-12}\, N$. }
\end{figure}
\end{comment}



\section{\label{sec:Realistically-Shaped-Biofilm}Realistically Shaped Biofilm
Simulation}

The biofilm shapes used in \S\ref{sub:Two-Dimensional-Simulations}
and \S\ref{sub:Three-Dimensional-Simulations} were intentionally
carved from the data in a way to provide a weak point at which it
would be most likely to break. This was done in order to verify the
expected effects of varying the different parameters in the simulation.
In this section, we provide results of the simulation on a biofilm
that is a subset of points taken directly from the real biofilm data
set. In reality, this biofilm was surrounded by more cells on all
sides, which would change the behavior of the fluid structure interactions.
However, we use this to show the results of the simulation on a \textit{real}
top heavy biofilm shape that was grown in a lab. The \textit{Staphylococcus
epidermidis} data set discussed in \S\ref{sub:SimSetup} was supplied
as positions in three $30\times30\times15\,\mu\textrm{m}$ sub-domains
of a biofilm.

In Figure \ref{fig:RealShroom2Dnoaddl}(a), we show the biofilm taken
from a $2\times30\times15\mu\textrm{m}$ subset of one data set that
has been connected with $d_{c}=2.8\,\mu\textrm{m}$. For the 2D representation,
we collapse the $2\,\mu\textrm{m}$ dimension, leaving only the $(x,y)$
coordinates of the data. The most interesting feature of this biofilm
is that in the region from $x=60\,\mu\textrm{m}$ to $x=67\,\mu\textrm{m}$
the biofilm exhibits a mushroom shape similar to the one we used in
\S\ref{sub:Two-Dimensional-Simulations}.

We now provide two simulation results on this realistically shaped
biofilm. The first simulation (see Figure \ref{fig:RealShroom2Dnoaddl})
uses a biofilm density equal to the surrounding fluid and uses $F_{max}=7.5\times10^{-7}\,\textrm{N}$.
In this simulation, the mushroom shaped part pushes against the biofilm
behind it, then rolls over the top of it as it breaks from its base,
forming a long streamer-like biofilm.%
\footnote{Streamers are a natural occurrence in biofilms. Examples in \cite{Klapper2002,Rusconi2010}.%
}Then the streamer breaks completely off leaving two distinct attached
structures. In the second simulation, we use a biofilm density of
$\rho_{b}=120\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}}$ and kept everything
else the same. Although the density is only 12\% larger than the surrounding
fluid, it has a large impact on the outcome of the simulation. In
this simulation, the effect of the increased density of the biofilm
is a longer breaking time (compare time in Figure \ref{fig:RealShroom2Daddl}(b)
and Figure \ref{fig:RealShroom2Daddl}(c)). This occurs since the
increased momentum causes the first detached piece to continue further
down, pulling the whole streamer lower (compare the height of the
detaching pieces). The fluid forces continue to push the streamer
until it breaks into the flow.

In the final simulation, we show that increasing the viscosity in
the ``realistically'' shaped biofilm has larger impact on the results
than in the case of the previous standalone mushroom shaped biofilm.
In this simulation, we increased the biofilm viscosity to 50$\times$
the surrounding fluid with $\mu_{max}=0.05\,\nicefrac{\textrm{kg}}{\textrm{m}\cdot\textrm{s}}$.
Although this is 10$\times$ less than in the previous variable viscosity
simulation, it has a larger impact on this wider biofilm, doubling
the detachment time from the case of constant viscosity (compare Figure
\ref{fig:RealShroom2Daddl}(b) and Figure \ref{fig:RealShroom2Daddl}(d)). 

\begin{figure}[H]
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_noAddl_t_0_00_f15}(b)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_noAddl_t_0_04_f15}\\
(c)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_noAddl_t_0_08_f15}(d)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_noAddl_t_0_16_f15}\\
(e)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_noAddl_t_0_24_f15}(f)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_noAddl_t_0_28_f15}
\par\end{centering}

\caption{\label{fig:RealShroom2Dnoaddl}Simulation on a 2D slice of a real
biofilm with the same density as the surrounding fluid. Time $t$
is in seconds and the distance is in microns. In this simulation,
$\rho_{0}=998\,\nicefrac{\textrm{kg}}{\textrm{m}^{3}},\:\rho_{b}=0,\: F_{max}=7.5\times10^{-7}\,\textrm{N}$.
The blue streamlines follow the velocity field. In this simulation,
the mushroom shaped part pushes against the biofilm behind it (b),
then rolls over the top of it as it breaks from its base (d). Then
a large portion of the biofilm breaks completely off leaving 2 distinct
bases (f).}
\end{figure}


\begin{figure}[H]
\begin{centering}
(a)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_Addl0_0visc0_12dens_t_0_00_f15}(b)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_Addl0_0visc0_12dens_t_0_244_f15stream}\\
(c)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_Addl0_0visc0_12dens_t_0_38_f15stream}(d)\includegraphics[width=0.45\columnwidth]{Realshroom2Dnondim_Addl0_50visc0_0dens_t_0_508_f15stream}
\par\end{centering}

\caption{\label{fig:RealShroom2Daddl}Snapshots in time ($t$ in seconds) showing
the detachment time and configuration at detachment of a 2D slice
of a real biofilm with initial configuration in (a). In (b), biofilm
has the same density and viscosity as the surrounding fluid, (c) 12\%
larger density, and (d) $50\times$ larger viscosity than the surrounding
fluid. The blue streamlines follow the velocity field. }
\end{figure}



\subsection{\label{sub:Numerical-Concerns}Numerical Concerns}

We note that there remains one pressing concern that will be the focus
of our future work. When adapting the multigrid scheme for large values
of $\mu_{max}$, we do not achieve expected speed ups in convergence
rates. We use restriction to transfer the viscosity to the coarse
grids works for small values of $\mu_{max}$, but we found that, for
larger values of $\mu_{max}$, this technique leads to a very slowly
converging solver. Intriguingly, we found that using our restriction
operator to define the coarse grid viscous values and then scaling
the values leads to faster convergence. Specifically, we define the
coarse grid viscosity as
\begin{eqnarray}
\mu_{lh}(\mathbf{x}) & = & \gamma_{lh}I_{\frac{l}{2}h}^{lh}\mu_{\frac{l}{2}h}(\mathbf{x}),\label{eq:ViscCoarseGrid}
\end{eqnarray}
where $lh$ denotes the grid whose mesh width is $l$ times $h$ ($l=2,\,4,\,8,\,16,\ldots$),
$\gamma_{lh}\in(0,1]$ is the scaling which maximizes the convergence
of the solver, and $\mu_{h}(\mathbf{x})$ is defined by Equation (\ref{eq:ViscExp}).
Through repeated experimentation, we found that using $\gamma_{lh}\in[.7,1]$
resulted in the fastest convergence rates in the 2D and 3D simulations.
This approach is admittedly ad-hoc. However, the consistency with
which we achieved dramatic speed ups strongly suggests the existence
of an underlying mathematical principle to be discovered. 

For our future work, the highest priority is to resolve the problem
of slow convergence for large $\mu_{max}$. There are three approaches
that may lead to resolving this issue. The first would be to mathematically
derive optimal values for the scaling parameters, $\gamma_{lh}$.
Second, we could ensure that our discretization satisfies the Galerkin
condition. Lastly, and probably the best choice, would be to re-implement
the geometric multigrid as an algebraic multigrid method (AMG, see
Ch. 8 of \cite{Briggs2000}). 


\section{\label{sec:Biofilm-Simulation-Conclusions}Conclusions}

In this work we developed a simulation to model the flow-induced fragmentation
of biofilms. In this simulation, we have provided a way to adjust
the biofilm density and viscosity, which had not been addressed in
previous IBM biofilm models. We also have control of the fluid flow
rate, density, viscosity, and elastic forces within the biofilm. We
used experimentally measured biofilm bacterial cell locations as initial
positions for our Lagrangian nodes. This is dramatically different
than the traditional IBM, in which methods usually refine the Lagrangian
mesh along with the Eulerian mesh. We adapted the Dirac delta approximation
to scale with the radius of the bacteria rather than with the mesh
width. This implies that the information that transfers from the Lagrangian
grid to the Eulerian grid (i.e.,~density, viscosity, and elastic
force) is spread over a set distance rather than scaling by the mesh
width, $h$. This adapted Dirac Delta approximation improves our numerical
convergence rates as well.

We used a projection method to split the incompressible Navier-Stokes
equations to solve separately for an intermediate velocity and the
pressure, and then used a Gauss-Seidel iterative method with multigrid
to solve the resulting equations. Using an iterative solver, as opposed
to a spectral method, to solve these systems was necessitated by the
fact that biofilms have spatially varying density and viscosity. With
this solver we achieved first order convergence in both space and
time. 

For the numerical simulations, we carved a mushroom shaped biofilm
from the bacterial cell locations and ran simulations with varying
parameters. We first ran the simulation on a simplistic shape in order
to validate the effect of the various parameter changes on the outcome
of the biofilm. By adjusting the maximum elastic force, $F_{max}$
in the biofilm, we controlled the detachment phenomenon. We also showed
that slight changes in the density of the biofilm has a large effect
on the outcome of the simulation. This is an important conclusion
as usually modelers ignore the differences in biofilm density. Finally,
we showed that we can increase the detachment time in the simulations
by increasing the viscosity of the biofilm. Finally, we ran simulations
on more realistically shaped biofilms, which showed how a larger biofilm
with different shapes will react to fluid flow forces. Adjusting these
parameters will be a necessary component when we attempt to match
these simulations to experimental data.


\section{\label{sec:FW} Future Work}

As mentioned in the introduction, this is the first of two articles
which detail our investigation into modeling and simulating the response
and fragmentation of a biofilm in shear flow. The second article (currently
in preparation \cite{Stotsky}) will involve using the results of
our simulation to match biofilm rheological properties (such as those
reported in \cite{Pavlovsky2013}). Below we provide an overview of
potential improvements, some of which will appear in the followup
article and some which will be pursued in subsequent work.

There are straightforward ways to include more biologically realistic
terms to interpret biofilm internal stress dynamics, cell volume,
and fragmentation dynamics. In its current form, our simulations can
be used to make predictions in detachment times of biofilms, as well
as general behavioral responses of biofilms to various flow conditions.
We do plan to include the fact that bacterial cells displace fluid.
While we have adapted the Dirac delta function approximation to transfer
the cell parameters ($F$, $\rho$, $\mu$) to the Eulerian grid,
the current simulation does not actually assign a size to the cells.
As a result, the cells are free to pass through each other. We first
plan to alter the model for the bacterial cell so that it displaces
fluid. An important step in this process will be to identify a collision
detection strategy. We will base ours on some combination of potentials
for electrostatic, steric, and Van der Waals forces.

Our current simulation also uses a spring-breaking criteria of double
the rest length, and assumes that the bonds are linearly elastic until
the breaking point. This is not an accurate assumption, as it is known
that biofilms are composed of polymer based ECMs. These structures
are linearly elastic for small strains and then experience plastic
deformation (permanently altering the bonds in the ECM and thus the
rest length) before finally fracturing. In the future, we will use
biofilm yielding data from experiments such as \cite{Aggarwal2010}
to determine accurate approximations for yield points and fracture
points in the biofilm. We plan to include plasticity into the simulations
by changing the equations for stress, Equation (\ref{eq:springF}),
when the bond has been stretched beyond its yield point.

We also have several plans for improving our numerical method. Our
current simulation is limited to first-order accuracy. Guided by the
results in \cite{BrownCortezMinion2001}, we will derive the numerical
boundary conditions for our projection method to ensure second order
accuracy for both velocity and pressure computations. To improve the
accuracy of the immersed boundary method, we could also adapt our
modeling method to either an immersed interface method (\cite{LiIto2006})
in which we adapt the finite difference approximations close to the
interface or a blob projection immersed boundary method as discussed
in \cite{Cortez2000} in order to obtain second-order spatial accuracy.
Another limitation of our current numerical scheme is the time-step
stability restrictions, which limit the size of the elastic forces
between the cells. We plan to eliminate these restrictions altogether
by changing to a semi-implicit or implicit method of transferring
the data between the Eulerian and Lagrangian grids, as is shown in
\cite{Newren2007}. 

Finally, with large biofilm densities and viscosities, our multigrid
method in its current formulation does not converge as fast as expected.
We plan to fix this by appropriately adapting our implementation of
the geometric multigrid (by satisfying the Galerkin condition) or
by changing to an algebraic multigrid approach.


\section{Acknowledgements}

We thank Stephen McCormick for his advice concerning the multigrid
method used in our simulations. We also thank Charles Peskin and Thomas
Fai for insightful comments and discussions related to a previous
draft of this work.

This work was supported in part by the National Science Foundation
grants PHY-0940991 and PHY-0941227 and NIH-NIGMS grant GM081702. This
work also utilized the Janus supercomputer, which is supported by
the National Science Foundation (award number CNS-0821794), the University
of Colorado Boulder, the University of Colorado Denver, and the National
Center for Atmospheric Research. The Janus supercomputer is operated
by the University of Colorado Boulder.

\bibliographystyle{cmes}
\bibliography{mathbioCU}


\appendix

\section{\label{sec:Appendix}~}

In this appendix we provide a list of variables and parameters used
in this paper.
\begin{description}
\item [{$d_{0}$}] Average Spring Rest Length
\item [{$\delta$}] Dirac Delta Function
\item [{$\delta_{h}$}] Discretized Dirac Delta Function from Peskin
\item [{$\tilde{\delta}$}] Our Modified Discretized Dirac Delta Function
\item [{$D$}] Spatial dimension, $D=2$ for 2D simulations and $D=3$
for 3D simulations
\item [{$\mathbf{e}_{i}$}] Unit Vector in the $i^{th}$ direction
\item [{$\eta$}] Total Number of Lagrangian Points
\item [{\textmd{$\mathbf{f}$}}] Eulerian Force Density
\item [{$\mathbf{F}$}] Lagrangian Force
\item [{$F_{max}$}] Maximum Lagrangian Force
\item [{$h$}] Spatial Discretization of finest grid
\item [{$K$}] Hookean Spring Coefficient
\item [{$\mu$}] Dynamic Fluid Viscosity
\item [{$\mu_{max}$}] Maximum Biofilm Viscosity
\item [{$p$}] Pressure
\item [{\textmd{$\mathbf{q}=(q,\, r,\, s)$}}] Lagrangian Coordinates
\item [{$\rho$}] Density
\item [{$\rho_{0}$}] Uniform Fluid Density
\item [{$\rho_{b}$}] Additional Density in Biofilm
\item [{$s$}] Lagrangian Node Marker
\item [{$t$}] Time
\item [{$T$}] Tension in Spring
\item [{$\mathbf{u}$}] Eulerian Velocity
\item [{$\mathbf{\tilde{u}}$}] Intermediate Velocity
\item [{$\mathbf{U}$}] Lagrangian Velocity
\item [{$\mathbf{x}=(x_{1},x_{2},x_{3})$}] Cartesian Coordinates
\end{description}

\section{\label{sec:Scaling-Parameters}Scaling Parameters}

\noindent 
\begin{table}[H]
\centering{}%
\begin{tabular}{|l|l|c|c|}
\hline 
\multicolumn{4}{|c}{Scaling Parameters}\tabularnewline
\hline 
\hline 
Description & Scaling  & Primary  & Specific values \tabularnewline
 & parameter & dimensions & chosen for \tabularnewline
 &  &  & simulations\tabularnewline
\hline 
Characteristic Length & $L$ & $\left\{ L\right\} $ & $50\: microns$\tabularnewline
\hline 
Characteristic Speed & $u_{0}$ & $\left\{ \nicefrac{L}{t}\right\} $ & $10^{-3}\nicefrac{\ensuremath{m}}{s}$\tabularnewline
\hline 
Characteristic Frequency & $T$ & $\left\{ t\right\} $  & $1\, s$\tabularnewline
\hline 
Reference Pressure Difference & $p_{0}-p_{L_{tube}}$ & $\left\{ mL^{-1}t^{-2}\right\} $ & $.8144\, Pa$\tabularnewline
\hline 
Characteristic Density & $\rho_{0}$ & $\left\{ mL^{-3}\right\} $ & $998\,\nicefrac{kg}{m^{3}}$\tabularnewline
\hline 
Characteristic Viscosity & $\mu$ & $\left\{ mL^{-1}t^{-1}\right\} $ & $10^{-3}\,\nicefrac{kg}{ms}$\tabularnewline
\hline 
Characteristic Force Density & $f_{0}$ & $\left\{ \nicefrac{F}{L^{3}}\right\} $ & $varies$\tabularnewline
\hline 
\end{tabular}\\
\caption{\label{tab: 2D sim params-1}Shows the scaling parameters and their
descriptions.}
\end{table}
\lastpage
\end{document}
