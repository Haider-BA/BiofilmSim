function [vhx,vhy,vhz]=relaxVEL3Dper2p(vhx,vhy,vhz,fhx,fhy,fhz,numrel,vcoef) 
%#codegen
[Em,En,Ep]=size(vhx);
Emm=Em-1;
Enm=En-1;
Emmm=Em-2;
Enmm=En-2;
Emmmm=Em-3;
Enmmm=En-3;
Epm=Ep-1;
Epmm=Ep-2;
Epmmm=Ep-3;

% w=1.36;
% w=.975;
% w=1;

% coef=ones(size(vh));

% rhsdivcoefx=fhx(2:Emm,2:Enm,2:Epm)./vcoef.coef;
% rhsdivcoefy=fhy(2:Emm,2:Enm,2:Epm)./vcoef.coef;
% rhsdivcoefz=fhz(2:Emm,2:Enm,2:Epm)./vcoef.coef;
% vhnew=vh;

%     rhsdivcoefred=fh(Indrb.red)./vcoef.coef(Indrb.redint);
%     rhsdivcoefblack=fh(Indrb.black)./vcoef.coef(Indrb.blackint);
%     rhsdivcoefboundx=fhx(2:Emm,2:Enm,Ep)./vcoef.coefbound;
%     rhsdivcoefboundy=fhy(2:Emm,2:Enm,Ep)./vcoef.coefbound;
%     rhsdivcoefboundz=fhz(2:Emm,2:Enm,Ep)./vcoef.coefbound;
vhxnew=cell(18,1);
vhynew=vhxnew;
vhznew=vhxnew;
    for c1=1:numrel

        parfor c2=1:6
            if c2==1
        %%%%%%%%%%%%  x vel
        
        
        %red even pgs  ux
        vhxnew{c2}.a=(fhx(2:2:Emm,2:2:Enm,2:2:Epm)+...
            2*vcoef.rescoefpp1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhx(2:2:Emm,3:2:En,2:2:Epm)+2*vcoef.rescoefpm1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhx(2:2:Emm,1:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhx(3:2:Em,2:2:Enm,2:2:Epm)+vcoef.rescoefpm2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhx(1:2:Emmm,2:2:Enm,2:2:Epm)+...
            vcoef.rescoefpp3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhx(2:2:Emm,2:2:Enm,3:2:Ep)+vcoef.rescoefpm3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhx(2:2:Emm,2:2:Enm,1:2:Epmm)+...
            vcoef.viscpp2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhy(3:2:Em,3:2:En,2:2:Epm)-vhy(3:2:Em,1:2:Enmm,2:2:Epm))+...
            vcoef.viscpm2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhy(1:2:Emmm,1:2:Enmm,2:2:Epm)-vhy(1:2:Emmm,3:2:En,2:2:Epm))...
            +vcoef.viscpp3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhz(2:2:Emm,3:2:En,3:2:Ep)-vhz(2:2:Emm,1:2:Enmm,3:2:Ep))+...
            vcoef.viscpm3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhz(2:2:Emm,1:2:Enmm,1:2:Epmm)-vhz(2:2:Emm,3:2:En,1:2:Epmm)))./vcoef.coefx(1:2:Emmm,1:2:Enmm,1:2:Epmm);
        
%         
        vhxnew{c2}.b=(fhx(3:2:Emmm,3:2:Enmm,2:2:Epm)+...
            2*vcoef.rescoefpp1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhx(3:2:Emmm,4:2:Enm,2:2:Epm)+2*vcoef.rescoefpm1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhx(3:2:Emmm,2:2:Enmmm,2:2:Epm)+...
            vcoef.rescoefpp2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhx(4:2:Emm,3:2:Enmm,2:2:Epm)+vcoef.rescoefpm2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhx(2:2:Emmmm,3:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhx(3:2:Emmm,3:2:Enmm,3:2:Ep)+vcoef.rescoefpm3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhx(3:2:Emmm,3:2:Enmm,1:2:Epmm)+...
            vcoef.viscpp2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhy(4:2:Emm,4:2:Enm,2:2:Epm)-vhy(4:2:Emm,2:2:Enmmm,2:2:Epm))+...
            vcoef.viscpm2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhy(2:2:Emmmm,2:2:Enmmm,2:2:Epm)-vhy(2:2:Emmmm,4:2:Enm,2:2:Epm))...
            +vcoef.viscpp3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhz(3:2:Emmm,4:2:Enm,3:2:Ep)-vhz(3:2:Emmm,2:2:Enmmm,3:2:Ep))+...
            vcoef.viscpm3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhz(3:2:Emmm,2:2:Enmmm,1:2:Epmm)-vhz(3:2:Emmm,4:2:Enm,1:2:Epmm)))./vcoef.coefx(2:2:Emmmm,2:2:Enmmm,1:2:Epmm);
        
        vhxnew{c2}.c=(fhx(3:2:Emmm,En,2:2:Epm)+...
            2*vcoef.rescoefpp1boundR(2:2:Emmmm,1,1:2:Epmm).*vhx(3:2:Emmm,2,2:2:Epm)+2*vcoef.rescoefpm1boundR(2:2:Emmmm,1,1:2:Epmm).*vhx(3:2:Emmm,Enm,2:2:Epm)+...
            vcoef.rescoefpp2boundR(2:2:Emmmm,1,1:2:Epmm).*vhx(4:2:Emm,En,2:2:Epm)+vcoef.rescoefpm2boundR(2:2:Emmmm,1,1:2:Epmm).*vhx(2:2:Emmmm,En,2:2:Epm)+...
            vcoef.rescoefpp3boundR(2:2:Emmmm,1,1:2:Epmm).*vhx(3:2:Emmm,En,3:2:Ep)+vcoef.rescoefpm3boundR(2:2:Emmmm,1,1:2:Epmm).*vhx(3:2:Emmm,En,1:2:Epmm)+...
            vcoef.viscpp2(2:2:Emmmm,Enm,1:2:Epmm).*(vhy(4:2:Emm,2,2:2:Epm)-vhy(4:2:Emm,Enm,2:2:Epm))+...
            vcoef.viscpm2(2:2:Emmmm,Enm,1:2:Epmm).*(vhy(2:2:Emmmm,Enm,2:2:Epm)-vhy(2:2:Emmmm,2,2:2:Epm))...
            +vcoef.viscpp3(2:2:Emmmm,Enm,1:2:Epmm).*(vhz(3:2:Emmm,2,3:2:Ep)-vhz(3:2:Emmm,Enm,3:2:Ep))+...
            vcoef.viscpm3(2:2:Emmmm,Enm,1:2:Epmm).*(vhz(3:2:Emmm,Enm,1:2:Epmm)-vhz(3:2:Emmm,2,1:2:Epmm)))./vcoef.coefxboundR(2:2:Emmmm,1,1:2:Epmm);
%         vhxnewe(3:2:Emmm,1,2:2:Epm)=vhx(3:2:Emmm,En,2:2:Epm);
%         %red odd pgs  ux
        vhxnew{c2}.d=(fhx(2:2:Emm,3:2:Enmm,3:2:Epmm)+...
            2*vcoef.rescoefpp1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhx(2:2:Emm,4:2:Enm,3:2:Epmm)+2*vcoef.rescoefpm1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhx(2:2:Emm,2:2:Enmmm,3:2:Epmm)+...
            vcoef.rescoefpp2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhx(3:2:Em,3:2:Enmm,3:2:Epmm)+vcoef.rescoefpm2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhx(1:2:Emmm,3:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhx(2:2:Emm,3:2:Enmm,4:2:Epm)+vcoef.rescoefpm3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhx(2:2:Emm,3:2:Enmm,2:2:Epmmm)+...
            vcoef.viscpp2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhy(3:2:Em,4:2:Enm,3:2:Epmm)-vhy(3:2:Em,2:2:Enmmm,3:2:Epmm))+...
            vcoef.viscpm2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhy(1:2:Emmm,2:2:Enmmm,3:2:Epmm)-vhy(1:2:Emmm,4:2:Enm,3:2:Epmm))...
            +vcoef.viscpp3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhz(2:2:Emm,4:2:Enm,4:2:Epm)-vhz(2:2:Emm,2:2:Enmmm,4:2:Epm))+...
            vcoef.viscpm3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhz(2:2:Emm,2:2:Enmmm,2:2:Epmmm)-vhz(2:2:Emm,4:2:Enm,2:2:Epmmm)))./vcoef.coefx(1:2:Emmm,2:2:Enmmm,2:2:Epmmm);
        
        vhxnew{c2}.e=(fhx(2:2:Emm,En,3:2:Epmm)+...
            2*vcoef.rescoefpp1boundR(1:2:Emmm,1,2:2:Epmmm).*vhx(2:2:Emm,2,3:2:Epmm)+2*vcoef.rescoefpm1boundR(1:2:Emmm,1,2:2:Epmmm).*vhx(2:2:Emm,Enm,3:2:Epmm)+...
            vcoef.rescoefpp2boundR(1:2:Emmm,1,2:2:Epmmm).*vhx(3:2:Em,En,3:2:Epmm)+vcoef.rescoefpm2boundR(1:2:Emmm,1,2:2:Epmmm).*vhx(1:2:Emmm,En,3:2:Epmm)+...
            vcoef.rescoefpp3boundR(1:2:Emmm,1,2:2:Epmmm).*vhx(2:2:Emm,En,4:2:Epm)+vcoef.rescoefpm3boundR(1:2:Emmm,1,2:2:Epmmm).*vhx(2:2:Emm,En,2:2:Epmmm)+...
            vcoef.viscpp2(1:2:Emmm,Enm,2:2:Epmmm).*(vhy(3:2:Em,2,3:2:Epmm)-vhy(3:2:Em,Enm,3:2:Epmm))+...
            vcoef.viscpm2(1:2:Emmm,Enm,2:2:Epmmm).*(vhy(1:2:Emmm,Enm,3:2:Epmm)-vhy(1:2:Emmm,2,3:2:Epmm))...
            +vcoef.viscpp3(1:2:Emmm,Enm,2:2:Epmmm).*(vhz(2:2:Emm,2,4:2:Epm)-vhz(2:2:Emm,Enm,4:2:Epm))+...
            vcoef.viscpm3(1:2:Emmm,Enm,2:2:Epmmm).*(vhz(2:2:Emm,Enm,2:2:Epmmm)-vhz(2:2:Emm,2,2:2:Epmmm)))./vcoef.coefxboundR(1:2:Emmm,1,2:2:Epmmm);
%         vhxnewo(2:2:Emm,1,3:2:Epmm)=vhx(2:2:Emm,En,3:2:Epmm);
        
        vhxnew{c2}.f=(fhx(2:2:Emm,3:2:Enmm,Ep)+...
            2*vcoef.rescoefpp1boundF(1:2:Emmm,2:2:Enmmm).*vhx(2:2:Emm,4:2:Enm,Ep)+2*vcoef.rescoefpm1boundF(1:2:Emmm,2:2:Enmmm).*vhx(2:2:Emm,2:2:Enmmm,Ep)+...
            vcoef.rescoefpp2boundF(1:2:Emmm,2:2:Enmmm).*vhx(3:2:Em,3:2:Enmm,Ep)+vcoef.rescoefpm2boundF(1:2:Emmm,2:2:Enmmm).*vhx(1:2:Emmm,3:2:Enmm,Ep)+...
            vcoef.rescoefpp3boundF(1:2:Emmm,2:2:Enmmm).*vhx(2:2:Emm,3:2:Enmm,2)+vcoef.rescoefpm3boundF(1:2:Emmm,2:2:Enmmm).*vhx(2:2:Emm,3:2:Enmm,Epm)+...
            vcoef.viscpp2(1:2:Emmm,2:2:Enmmm,Epm).*(vhy(3:2:Em,4:2:Enm,Ep)-vhy(3:2:Em,2:2:Enmmm,Ep))+vcoef.viscpm2(1:2:Emmm,2:2:Enmmm,Epm).*(vhy(1:2:Emmm,2:2:Enmmm,Ep)-vhy(1:2:Emmm,4:2:Enm,Ep))...
            +vcoef.viscpp3(1:2:Emmm,2:2:Enmmm,Epm).*(vhz(2:2:Emm,4:2:Enm,2)-vhz(2:2:Emm,2:2:Enmmm,2))+vcoef.viscpm3(1:2:Emmm,2:2:Enmmm,Epm).*(vhz(2:2:Emm,2:2:Enmmm,Epm)-vhz(2:2:Emm,4:2:Enm,Epm)))./vcoef.coefxboundF(1:2:Emmm,2:2:Enmmm);
%         vhxnewe(2:2:Emm,3:2:Enmm,1)=vhx(2:2:Emm,3:2:Enmm,Ep);
            
        vhxnew{c2}.g=(fhx(2:2:Emm,En,Ep)+...
            2*vcoef.rescoefpp1boundFR(1:2:Emmm).*vhx(2:2:Emm,2,Ep)+2*vcoef.rescoefpm1boundFR(1:2:Emmm).*vhx(2:2:Emm,Enm,Ep)+...
            vcoef.rescoefpp2boundFR(1:2:Emmm).*vhx(3:2:Em,En,Ep)+vcoef.rescoefpm2boundFR(1:2:Emmm).*vhx(1:2:Emmm,En,Ep)+...
            vcoef.rescoefpp3boundFR(1:2:Emmm).*vhx(2:2:Emm,En,2)+vcoef.rescoefpm3boundFR(1:2:Emmm).*vhx(2:2:Emm,En,Epm)+...
            vcoef.viscpp2(1:2:Emmm,Enm,Epm).*(vhy(3:2:Em,2,Ep)-vhy(3:2:Em,Enm,Ep))+vcoef.viscpm2(1:2:Emmm,Enm,Epm).*(vhy(1:2:Emmm,Enm,Ep)-vhy(1:2:Emmm,2,Ep))...
            +vcoef.viscpp3(1:2:Emmm,Enm,Epm).*(vhz(2:2:Emm,2,2)-vhz(2:2:Emm,Enm,2))+vcoef.viscpm3(1:2:Emmm,Enm,Epm).*(vhz(2:2:Emm,Enm,Epm)-vhz(2:2:Emm,2,Epm)))./vcoef.coefxboundFR(1:2:Emmm);
%         vhxnewo(2:2:Emm,1,1)=vhx(2:2:Emm,En,Ep);
%         vhxnewo(2:2:Emm,En,1)=vhx(2:2:Emm,En,Ep);
%         vhxnewo(2:2:Emm,1,Ep)=vhx(2:2:Emm,En,Ep);
        
        
        vhxnew{8}=(fhx(3:2:Emmm,2:2:Enm,3:2:Epmm)+...
            2*vcoef.rescoefpp1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhx(3:2:Emmm,3:2:En,3:2:Epmm)+2*vcoef.rescoefpm1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhx(3:2:Emmm,1:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhx(4:2:Emm,2:2:Enm,3:2:Epmm)+vcoef.rescoefpm2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhx(2:2:Emmmm,2:2:Enm,3:2:Epmm)+...
            vcoef.rescoefpp3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhx(3:2:Emmm,2:2:Enm,4:2:Epm)+vcoef.rescoefpm3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhx(3:2:Emmm,2:2:Enm,2:2:Epmmm)+...
            vcoef.viscpp2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhy(4:2:Emm,3:2:En,3:2:Epmm)-vhy(4:2:Emm,1:2:Enmm,3:2:Epmm))+...
            vcoef.viscpm2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhy(2:2:Emmmm,1:2:Enmm,3:2:Epmm)-vhy(2:2:Emmmm,3:2:En,3:2:Epmm))...
            +vcoef.viscpp3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhz(3:2:Emmm,3:2:En,4:2:Epm)-vhz(3:2:Emmm,1:2:Enmm,4:2:Epm))+...
            vcoef.viscpm3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhz(3:2:Emmm,1:2:Enmm,2:2:Epmmm)-vhz(3:2:Emmm,3:2:En,2:2:Epmmm)))./vcoef.coefx(2:2:Emmmm,1:2:Enmm,2:2:Epmmm);
        
        vhxnew{9}=(fhx(3:2:Emmm,2:2:Enm,Ep)+...
            2*vcoef.rescoefpp1boundF(2:2:Emmmm,1:2:Enmm).*vhx(3:2:Emmm,3:2:En,Ep)+2*vcoef.rescoefpm1boundF(2:2:Emmmm,1:2:Enmm).*vhx(3:2:Emmm,1:2:Enmm,Ep)+...
            vcoef.rescoefpp2boundF(2:2:Emmmm,1:2:Enmm).*vhx(4:2:Emm,2:2:Enm,Ep)+vcoef.rescoefpm2boundF(2:2:Emmmm,1:2:Enmm).*vhx(2:2:Emmmm,2:2:Enm,Ep)+...
            vcoef.rescoefpp3boundF(2:2:Emmmm,1:2:Enmm).*vhx(3:2:Emmm,2:2:Enm,2)+vcoef.rescoefpm3boundF(2:2:Emmmm,1:2:Enmm).*vhx(3:2:Emmm,2:2:Enm,Epm)+...
            vcoef.viscpp2(2:2:Emmmm,1:2:Enmm,Epm).*(vhy(4:2:Emm,3:2:En,Ep)-vhy(4:2:Emm,1:2:Enmm,Ep))+vcoef.viscpm2(2:2:Emmmm,1:2:Enmm,Epm).*(vhy(2:2:Emmmm,1:2:Enmm,Ep)-vhy(2:2:Emmmm,3:2:En,Ep))...
            +vcoef.viscpp3(2:2:Emmmm,1:2:Enmm,Epm).*(vhz(3:2:Emmm,3:2:En,2)-vhz(3:2:Emmm,1:2:Enmm,2))+vcoef.viscpm3(2:2:Emmmm,1:2:Enmm,Epm).*(vhz(3:2:Emmm,1:2:Enmm,Epm)-vhz(3:2:Emmm,3:2:En,Epm)))./vcoef.coefxboundF(2:2:Emmmm,1:2:Enmm);
%         vhxnewo(3:2:Emmm,2:2:Enm,1)=vhx(3:2:Emmm,2:2:Enm,Ep);



        
                %red even pgs  uy
                
            elseif c2==2
%         
        vhynew{1}=(fhy(2:2:Emm,2:2:Enm,2:2:Epm)+...
            vcoef.rescoefpp1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhy(2:2:Emm,3:2:En,2:2:Epm)+vcoef.rescoefpm1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhy(2:2:Emm,1:2:Enmm,2:2:Epm)+...
            2*vcoef.rescoefpp2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhy(3:2:Em,2:2:Enm,2:2:Epm)+2*vcoef.rescoefpm2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhy(1:2:Emmm,2:2:Enm,2:2:Epm)+...
            vcoef.rescoefpp3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhy(2:2:Emm,2:2:Enm,3:2:Ep)+vcoef.rescoefpm3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhy(2:2:Emm,2:2:Enm,1:2:Epmm)+...
            vcoef.viscpp1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhx(3:2:Em,3:2:En,2:2:Epm)-vhx(1:2:Emmm,3:2:En,2:2:Epm))+...
            vcoef.viscpm1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhx(1:2:Emmm,1:2:Enmm,2:2:Epm)-vhx(3:2:Em,1:2:Enmm,2:2:Epm))...
            +vcoef.viscpp3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhz(3:2:Em,2:2:Enm,3:2:Ep)-vhz(1:2:Emmm,2:2:Enm,3:2:Ep))+...
            vcoef.viscpm3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhz(1:2:Emmm,2:2:Enm,1:2:Epmm)-vhz(3:2:Em,2:2:Enm,1:2:Epmm)))./vcoef.coefy(1:2:Emmm,1:2:Enmm,1:2:Epmm);
       
        vhynew{2}=(fhy(3:2:Emmm,3:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhy(3:2:Emmm,4:2:Enm,2:2:Epm)+vcoef.rescoefpm1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhy(3:2:Emmm,2:2:Enmmm,2:2:Epm)+...
            2*vcoef.rescoefpp2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhy(4:2:Emm,3:2:Enmm,2:2:Epm)+2*vcoef.rescoefpm2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhy(2:2:Emmmm,3:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhy(3:2:Emmm,3:2:Enmm,3:2:Ep)+vcoef.rescoefpm3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhy(3:2:Emmm,3:2:Enmm,1:2:Epmm)+...
            vcoef.viscpp1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhx(4:2:Emm,4:2:Enm,2:2:Epm)-vhx(2:2:Emmmm,4:2:Enm,2:2:Epm))+...
            vcoef.viscpm1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhx(2:2:Emmmm,2:2:Enmmm,2:2:Epm)-vhx(4:2:Emm,2:2:Enmmm,2:2:Epm))...
            +vcoef.viscpp3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhz(4:2:Emm,3:2:Enmm,3:2:Ep)-vhz(2:2:Emmmm,3:2:Enmm,3:2:Ep))+...
            vcoef.viscpm3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhz(2:2:Emmmm,3:2:Enmm,1:2:Epmm)-vhz(4:2:Emm,3:2:Enmm,1:2:Epmm)))./vcoef.coefy(2:2:Emmmm,2:2:Enmmm,1:2:Epmm);
         
        vhynew{3}=(fhy(3:2:Emmm,En,2:2:Epm)+...
           vcoef.rescoefpp1boundR(2:2:Emmmm,1,1:2:Epmm).*vhy(3:2:Emmm,2,2:2:Epm)+vcoef.rescoefpm1boundR(2:2:Emmmm,1,1:2:Epmm).*vhy(3:2:Emmm,Enm,2:2:Epm)+...
           2*vcoef.rescoefpp2boundR(2:2:Emmmm,1,1:2:Epmm).*vhy(4:2:Emm,En,2:2:Epm)+2*vcoef.rescoefpm2boundR(2:2:Emmmm,1,1:2:Epmm).*vhy(2:2:Emmmm,En,2:2:Epm)+...
           vcoef.rescoefpp3boundR(2:2:Emmmm,1,1:2:Epmm).*vhy(3:2:Emmm,En,3:2:Ep)+vcoef.rescoefpm3boundR(2:2:Emmmm,1,1:2:Epmm).*vhy(3:2:Emmm,En,1:2:Epmm)+...
           vcoef.viscpp1(2:2:Emmmm,Enm,1:2:Epmm).*(vhx(4:2:Emm,2,2:2:Epm)-vhx(2:2:Emmmm,2,2:2:Epm))+...
           vcoef.viscpm1(2:2:Emmmm,Enm,1:2:Epmm).*(vhx(2:2:Emmmm,Enm,2:2:Epm)-vhx(4:2:Emm,Enm,2:2:Epm))...
           +vcoef.viscpp3(2:2:Emmmm,Enm,1:2:Epmm).*(vhz(4:2:Emm,En,3:2:Ep)-vhz(2:2:Emmmm,En,3:2:Ep))+...
           vcoef.viscpm3(2:2:Emmmm,Enm,1:2:Epmm).*(vhz(2:2:Emmmm,En,1:2:Epmm)-vhz(4:2:Emm,En,1:2:Epmm)))./vcoef.coefyboundR(2:2:Emmmm,1,1:2:Epmm);
%        vhynewe(3:2:Emmm,1,2:2:Epm)=vhy(3:2:Emmm,En,2:2:Epm);
            
%                  
%        %red odd pgs  uy
        vhynew{4}=(fhy(2:2:Emm,3:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhy(2:2:Emm,4:2:Enm,3:2:Epmm)+vcoef.rescoefpm1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhy(2:2:Emm,2:2:Enmmm,3:2:Epmm)+...
            2*vcoef.rescoefpp2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhy(3:2:Em,3:2:Enmm,3:2:Epmm)+2*vcoef.rescoefpm2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhy(1:2:Emmm,3:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhy(2:2:Emm,3:2:Enmm,4:2:Epm)+vcoef.rescoefpm3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhy(2:2:Emm,3:2:Enmm,2:2:Epmmm)+...
            vcoef.viscpp1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhx(3:2:Em,4:2:Enm,3:2:Epmm)-vhx(1:2:Emmm,4:2:Enm,3:2:Epmm))+...
            vcoef.viscpm1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhx(1:2:Emmm,2:2:Enmmm,3:2:Epmm)-vhx(3:2:Em,2:2:Enmmm,3:2:Epmm))...
            +vcoef.viscpp3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhz(3:2:Em,3:2:Enmm,4:2:Epm)-vhz(1:2:Emmm,3:2:Enmm,4:2:Epm))+...
            vcoef.viscpm3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhz(1:2:Emmm,3:2:Enmm,2:2:Epmmm)-vhz(3:2:Em,3:2:Enmm,2:2:Epmmm)))./vcoef.coefy(1:2:Emmm,2:2:Enmmm,2:2:Epmmm);
        
        vhynew{5}=(fhy(2:2:Emm,En,3:2:Epmm)+...
            vcoef.rescoefpp1boundR(1:2:Emmm,1,2:2:Epmmm).*vhy(2:2:Emm,2,3:2:Epmm)+vcoef.rescoefpm1boundR(1:2:Emmm,1,2:2:Epmmm).*vhy(2:2:Emm,Enm,3:2:Epmm)+...
            2*vcoef.rescoefpp2boundR(1:2:Emmm,1,2:2:Epmmm).*vhy(3:2:Em,En,3:2:Epmm)+2*vcoef.rescoefpm2boundR(1:2:Emmm,1,2:2:Epmmm).*vhy(1:2:Emmm,En,3:2:Epmm)+...
            vcoef.rescoefpp3boundR(1:2:Emmm,1,2:2:Epmmm).*vhy(2:2:Emm,En,4:2:Epm)+vcoef.rescoefpm3boundR(1:2:Emmm,1,2:2:Epmmm).*vhy(2:2:Emm,En,2:2:Epmmm)+...
            vcoef.viscpp1(1:2:Emmm,Enm,2:2:Epmmm).*(vhx(3:2:Em,2,3:2:Epmm)-vhx(1:2:Emmm,2,3:2:Epmm))+...
            vcoef.viscpm1(1:2:Emmm,Enm,2:2:Epmmm).*(vhx(1:2:Emmm,Enm,3:2:Epmm)-vhx(3:2:Em,Enm,3:2:Epmm))...
            +vcoef.viscpp3(1:2:Emmm,Enm,2:2:Epmmm).*(vhz(3:2:Em,En,4:2:Epm)-vhz(1:2:Emmm,En,4:2:Epm))+...
            vcoef.viscpm3(1:2:Emmm,Enm,2:2:Epmmm).*(vhz(1:2:Emmm,En,2:2:Epmmm)-vhz(3:2:Em,En,2:2:Epmmm)))./vcoef.coefyboundR(1:2:Emmm,1,2:2:Epmmm);
%         vhynewo(2:2:Emm,1,3:2:Epmm)=vhy(2:2:Emm,En,3:2:Epmm);
        
        
         vhynew{6}=(fhy(2:2:Emm,3:2:Enmm,Ep)+...
           vcoef.rescoefpp1boundF(1:2:Emmm,2:2:Enmmm).*vhy(2:2:Emm,4:2:Enm,Ep)+vcoef.rescoefpm1boundF(1:2:Emmm,2:2:Enmmm).*vhy(2:2:Emm,2:2:Enmmm,Ep)+...
           2*vcoef.rescoefpp2boundF(1:2:Emmm,2:2:Enmmm).*vhy(3:2:Em,3:2:Enmm,Ep)+2*vcoef.rescoefpm2boundF(1:2:Emmm,2:2:Enmmm).*vhy(1:2:Emmm,3:2:Enmm,Ep)+...
           vcoef.rescoefpp3boundF(1:2:Emmm,2:2:Enmmm).*vhy(2:2:Emm,3:2:Enmm,2)+vcoef.rescoefpm3boundF(1:2:Emmm,2:2:Enmmm).*vhy(2:2:Emm,3:2:Enmm,Epm)+...
           vcoef.viscpp1(1:2:Emmm,2:2:Enmmm,Epm).*(vhx(3:2:Em,4:2:Enm,Ep)-vhx(1:2:Emmm,4:2:Enm,Ep))+vcoef.viscpm1(1:2:Emmm,2:2:Enmmm,Epm).*(vhx(1:2:Emmm,2:2:Enmmm,Ep)-vhx(3:2:Em,2:2:Enmmm,Ep))...
           +vcoef.viscpp3(1:2:Emmm,2:2:Enmmm,Epm).*(vhz(3:2:Em,3:2:Enmm,2)-vhz(1:2:Emmm,3:2:Enmm,2))+vcoef.viscpm3(1:2:Emmm,2:2:Enmmm,Epm).*(vhz(1:2:Emmm,3:2:Enmm,Epm)-vhz(3:2:Em,3:2:Enmm,Epm)))./vcoef.coefyboundF(1:2:Emmm,2:2:Enmmm);
%            vhynewo(2:2:Emm,3:2:Enmm,1)=vhy(2:2:Emm,3:2:Enmm,Ep);  
            
        vhynew{7}=(fhy(2:2:Emm,En,Ep)+...
           vcoef.rescoefpp1boundFR(1:2:Emmm).*vhy(2:2:Emm,2,Ep)+vcoef.rescoefpm1boundFR(1:2:Emmm).*vhy(2:2:Emm,Enm,Ep)+...
           2*vcoef.rescoefpp2boundFR(1:2:Emmm).*vhy(3:2:Em,En,Ep)+2*vcoef.rescoefpm2boundFR(1:2:Emmm).*vhy(1:2:Emmm,En,Ep)+...
           vcoef.rescoefpp3boundFR(1:2:Emmm).*vhy(2:2:Emm,En,2)+vcoef.rescoefpm3boundFR(1:2:Emmm).*vhy(2:2:Emm,En,Epm)+...
           vcoef.viscpp1(1:2:Emmm,Enm,Epm).*(vhx(3:2:Em,2,Ep)-vhx(1:2:Emmm,2,Ep))+vcoef.viscpm1(1:2:Emmm,Enm,Epm).*(vhx(1:2:Emmm,Enm,Ep)-vhx(3:2:Em,Enm,Ep))...
           +vcoef.viscpp3(1:2:Emmm,Enm,Epm).*(vhz(3:2:Em,En,2)-vhz(1:2:Emmm,En,2))+vcoef.viscpm3(1:2:Emmm,Enm,Epm).*(vhz(1:2:Emmm,En,Epm)-vhz(3:2:Em,En,Epm)))./vcoef.coefyboundFR(1:2:Emmm);
%         vhynewo(2:2:Emm,1,1)=vhy(2:2:Emm,En,Ep);  
%         vhynewo(2:2:Emm,1,En)=vhy(2:2:Emm,En,Ep);  
%         vhynewo(2:2:Emm,En,1)=vhy(2:2:Emm,En,Ep);  
          
        vhynew{8}=(fhy(3:2:Emmm,2:2:Enm,3:2:Epmm)+...
            vcoef.rescoefpp1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhy(3:2:Emmm,3:2:En,3:2:Epmm)+vcoef.rescoefpm1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhy(3:2:Emmm,1:2:Enmm,3:2:Epmm)+...
            2*vcoef.rescoefpp2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhy(4:2:Emm,2:2:Enm,3:2:Epmm)+2*vcoef.rescoefpm2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhy(2:2:Emmmm,2:2:Enm,3:2:Epmm)+...
            vcoef.rescoefpp3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhy(3:2:Emmm,2:2:Enm,4:2:Epm)+vcoef.rescoefpm3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhy(3:2:Emmm,2:2:Enm,2:2:Epmmm)+...
            vcoef.viscpp1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhx(4:2:Emm,3:2:En,3:2:Epmm)-vhx(2:2:Emmmm,3:2:En,3:2:Epmm))+...
            vcoef.viscpm1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhx(2:2:Emmmm,1:2:Enmm,3:2:Epmm)-vhx(4:2:Emm,1:2:Enmm,3:2:Epmm))...
            +vcoef.viscpp3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhz(4:2:Emm,2:2:Enm,4:2:Epm)-vhz(2:2:Emmmm,2:2:Enm,4:2:Epm))+...
            vcoef.viscpm3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhz(2:2:Emmmm,2:2:Enm,2:2:Epmmm)-vhz(4:2:Emm,2:2:Enm,2:2:Epmmm)))./vcoef.coefy(2:2:Emmmm,1:2:Enmm,2:2:Epmmm);
        
         vhynew{9}=(fhy(3:2:Emmm,2:2:Enm,Ep)+...
            vcoef.rescoefpp1boundF(2:2:Emmmm,1:2:Enmm).*vhy(3:2:Emmm,3:2:En,Ep)+vcoef.rescoefpm1boundF(2:2:Emmmm,1:2:Enmm).*vhy(3:2:Emmm,1:2:Enmm,Ep)+...
            2*vcoef.rescoefpp2boundF(2:2:Emmmm,1:2:Enmm).*vhy(4:2:Emm,2:2:Enm,Ep)+2*vcoef.rescoefpm2boundF(2:2:Emmmm,1:2:Enmm).*vhy(2:2:Emmmm,2:2:Enm,Ep)+...
            vcoef.rescoefpp3boundF(2:2:Emmmm,1:2:Enmm).*vhy(3:2:Emmm,2:2:Enm,2)+vcoef.rescoefpm3boundF(2:2:Emmmm,1:2:Enmm).*vhy(3:2:Emmm,2:2:Enm,Epm)+...
            vcoef.viscpp1(2:2:Emmmm,1:2:Enmm,Epm).*(vhx(4:2:Emm,3:2:En,Ep)-vhx(2:2:Emmmm,3:2:En,Ep))+vcoef.viscpm1(2:2:Emmmm,1:2:Enmm,Epm).*(vhx(2:2:Emmmm,1:2:Enmm,Ep)-vhx(4:2:Emm,1:2:Enmm,Ep))...
            +vcoef.viscpp3(2:2:Emmmm,1:2:Enmm,Epm).*(vhz(4:2:Emm,2:2:Enm,2)-vhz(2:2:Emmmm,2:2:Enm,2))+vcoef.viscpm3(2:2:Emmmm,1:2:Enmm,Epm).*(vhz(2:2:Emmmm,2:2:Enm,Epm)-vhz(4:2:Emm,2:2:Enm,Epm)))./vcoef.coefyboundF(2:2:Emmmm,1:2:Enmm);
%          vhynewo(3:2:Emmm,2:2:Enm,1)=vhy(3:2:Emmm,2:2:Enm,Ep); 
%         


            elseif c2==3


%         %red even pages uz
         vhznew{1}=(fhz(2:2:Emm,2:2:Enm,2:2:Epm)+...
            vcoef.rescoefpp1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhz(2:2:Emm,3:2:En,2:2:Epm)+vcoef.rescoefpm1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhz(2:2:Emm,1:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhz(3:2:Em,2:2:Enm,2:2:Epm)+vcoef.rescoefpm2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhz(1:2:Emmm,2:2:Enm,2:2:Epm)+...
            2*vcoef.rescoefpp3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhz(2:2:Emm,2:2:Enm,3:2:Ep)+2*vcoef.rescoefpm3(1:2:Emmm,1:2:Enmm,1:2:Epmm).*vhz(2:2:Emm,2:2:Enm,1:2:Epmm)+...
            vcoef.viscpp1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhx(2:2:Emm,3:2:En,3:2:Ep)-vhx(2:2:Emm,3:2:En,1:2:Epmm))+...
            vcoef.viscpm1(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhx(2:2:Emm,1:2:Enmm,1:2:Epmm)-vhx(2:2:Emm,1:2:Enmm,3:2:Ep))...
            +vcoef.viscpp2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhy(3:2:Em,2:2:Enm,3:2:Ep)-vhy(3:2:Em,2:2:Enm,1:2:Epmm))+...
            vcoef.viscpm2(1:2:Emmm,1:2:Enmm,1:2:Epmm).*(vhy(1:2:Emmm,2:2:Enm,1:2:Epmm)-vhy(1:2:Emmm,2:2:Enm,3:2:Ep))...
            )./vcoef.coefz(1:2:Emmm,1:2:Enmm,1:2:Epmm);
       
%         
        vhznew{2}=(fhz(3:2:Emmm,3:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhz(3:2:Emmm,4:2:Enm,2:2:Epm)+vcoef.rescoefpm1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhz(3:2:Emmm,2:2:Enmmm,2:2:Epm)+...
            vcoef.rescoefpp2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhz(4:2:Emm,3:2:Enmm,2:2:Epm)+vcoef.rescoefpm2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhz(2:2:Emmmm,3:2:Enmm,2:2:Epm)+...
            2*vcoef.rescoefpp3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhz(3:2:Emmm,3:2:Enmm,3:2:Ep)+2*vcoef.rescoefpm3(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*vhz(3:2:Emmm,3:2:Enmm,1:2:Epmm)+...
            vcoef.viscpp1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhx(3:2:Emmm,4:2:Enm,3:2:Ep)-vhx(3:2:Emmm,4:2:Enm,1:2:Epmm))+...
            vcoef.viscpm1(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhx(3:2:Emmm,2:2:Enmmm,1:2:Epmm)-vhx(3:2:Emmm,2:2:Enmmm,3:2:Ep))...
            +vcoef.viscpp2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhy(4:2:Emm,3:2:Enmm,3:2:Ep)-vhy(4:2:Emm,3:2:Enmm,1:2:Epmm))+...
            vcoef.viscpm2(2:2:Emmmm,2:2:Enmmm,1:2:Epmm).*(vhy(2:2:Emmmm,3:2:Enmm,1:2:Epmm)-vhy(2:2:Emmmm,3:2:Enmm,3:2:Ep))...
            )./vcoef.coefz(2:2:Emmmm,2:2:Enmmm,1:2:Epmm);
        
        vhznew{3}=(fhz(3:2:Emmm,En,2:2:Epm)+...
           vcoef.rescoefpp1boundR(2:2:Emmmm,1,1:2:Epmm).*vhz(3:2:Emmm,2,2:2:Epm)+vcoef.rescoefpm1boundR(2:2:Emmmm,1,1:2:Epmm).*vhz(3:2:Emmm,Enm,2:2:Epm)+...
           vcoef.rescoefpp2boundR(2:2:Emmmm,1,1:2:Epmm).*vhz(4:2:Emm,En,2:2:Epm)+vcoef.rescoefpm2boundR(2:2:Emmmm,1,1:2:Epmm).*vhz(2:2:Emmmm,En,2:2:Epm)+...
           2*vcoef.rescoefpp3boundR(2:2:Emmmm,1,1:2:Epmm).*vhz(3:2:Emmm,En,3:2:Ep)+2*vcoef.rescoefpm3boundR(2:2:Emmmm,1,1:2:Epmm).*vhz(3:2:Emmm,En,1:2:Epmm)+...
           vcoef.viscpp1(2:2:Emmmm,Enm,1:2:Epmm).*(vhx(3:2:Emmm,2,3:2:Ep)-vhx(3:2:Emmm,2,1:2:Epmm))+...
           vcoef.viscpm1(2:2:Emmmm,Enm,1:2:Epmm).*(vhx(3:2:Emmm,Enm,1:2:Epmm)-vhx(3:2:Emmm,Enm,3:2:Ep))...
           +vcoef.viscpp2(2:2:Emmmm,Enm,1:2:Epmm).*(vhy(4:2:Emm,En,3:2:Ep)-vhy(4:2:Emm,En,1:2:Epmm))+...
           vcoef.viscpm2(2:2:Emmmm,Enm,1:2:Epmm).*(vhy(2:2:Emmmm,En,1:2:Epmm)-vhy(2:2:Emmmm,En,3:2:Ep))...
           )./vcoef.coefzboundR(2:2:Emmmm,1,1:2:Epmm);
%        vhznewe(3:2:Emmm,1,2:2:Epm)=vhz(3:2:Emmm,En,2:2:Epm);
            

%         %red odd pgs  uz
        vhznew{4}=(fhz(2:2:Emm,3:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhz(2:2:Emm,4:2:Enm,3:2:Epmm)+vcoef.rescoefpm1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhz(2:2:Emm,2:2:Enmmm,3:2:Epmm)+...
            vcoef.rescoefpp2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhz(3:2:Em,3:2:Enmm,3:2:Epmm)+vcoef.rescoefpm2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhz(1:2:Emmm,3:2:Enmm,3:2:Epmm)+...
            2*vcoef.rescoefpp3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhz(2:2:Emm,3:2:Enmm,4:2:Epm)+2*vcoef.rescoefpm3(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*vhz(2:2:Emm,3:2:Enmm,2:2:Epmmm)+...
            vcoef.viscpp1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhx(2:2:Emm,4:2:Enm,4:2:Epm)-vhx(2:2:Emm,4:2:Enm,2:2:Epmmm))+...
            vcoef.viscpm1(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhx(2:2:Emm,2:2:Enmmm,2:2:Epmmm)-vhx(2:2:Emm,2:2:Enmmm,4:2:Epm))...
            +vcoef.viscpp2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhy(3:2:Em,3:2:Enmm,4:2:Epm)-vhy(3:2:Em,3:2:Enmm,2:2:Epmmm))+...
            vcoef.viscpm2(1:2:Emmm,2:2:Enmmm,2:2:Epmmm).*(vhy(1:2:Emmm,3:2:Enmm,2:2:Epmmm)-vhy(1:2:Emmm,3:2:Enmm,4:2:Epm))...
            )./vcoef.coefz(1:2:Emmm,2:2:Enmmm,2:2:Epmmm);
        
        vhznew{5}=(fhz(2:2:Emm,En,3:2:Epmm)+...
           vcoef.rescoefpp1boundR(1:2:Emmm,1,2:2:Epmmm).*vhz(2:2:Emm,2,3:2:Epmm)+vcoef.rescoefpm1boundR(1:2:Emmm,1,2:2:Epmmm).*vhz(2:2:Emm,Enm,3:2:Epmm)+...
           vcoef.rescoefpp2boundR(1:2:Emmm,1,2:2:Epmmm).*vhz(3:2:Em,En,3:2:Epmm)+vcoef.rescoefpm2boundR(1:2:Emmm,1,2:2:Epmmm).*vhz(1:2:Emmm,En,3:2:Epmm)+...
           2*vcoef.rescoefpp3boundR(1:2:Emmm,1,2:2:Epmmm).*vhz(2:2:Emm,En,4:2:Epm)+2*vcoef.rescoefpm3boundR(1:2:Emmm,1,2:2:Epmmm).*vhz(2:2:Emm,En,2:2:Epmmm)+...
           vcoef.viscpp1(1:2:Emmm,Enm,2:2:Epmmm).*(vhx(2:2:Emm,2,4:2:Epm)-vhx(2:2:Emm,2,2:2:Epmmm))+...
           vcoef.viscpm1(1:2:Emmm,Enm,2:2:Epmmm).*(vhx(2:2:Emm,Enm,2:2:Epmmm)-vhx(2:2:Emm,Enm,4:2:Epm))...
           +vcoef.viscpp2(1:2:Emmm,Enm,2:2:Epmmm).*(vhy(3:2:Em,En,4:2:Epm)-vhy(3:2:Em,En,2:2:Epmmm))+...
           vcoef.viscpm2(1:2:Emmm,Enm,2:2:Epmmm).*(vhy(1:2:Emmm,En,2:2:Epmmm)-vhy(1:2:Emmm,En,4:2:Epm))...
           )./vcoef.coefzboundR(1:2:Emmm,1,2:2:Epmmm);
%        vhznewo(2:2:Emm,1,3:2:Epmm)=vhz(2:2:Emm,En,3:2:Epmm);
        
         vhznew{6}=(fhz(2:2:Emm,3:2:Enmm,Ep)+...
            vcoef.rescoefpp1boundF(1:2:Emmm,2:2:Enmmm).*vhz(2:2:Emm,4:2:Enm,Ep)+vcoef.rescoefpm1boundF(1:2:Emmm,2:2:Enmmm).*vhz(2:2:Emm,2:2:Enmmm,Ep)+...
            vcoef.rescoefpp2boundF(1:2:Emmm,2:2:Enmmm).*vhz(3:2:Em,3:2:Enmm,Ep)+vcoef.rescoefpm2boundF(1:2:Emmm,2:2:Enmm).*vhz(1:2:Emmm,3:2:Enmm,Ep)+...
            2*vcoef.rescoefpp3boundF(1:2:Emmm,2:2:Enmmm).*vhz(2:2:Emm,3:2:Enmm,2)+2*vcoef.rescoefpm3boundF(1:2:Emmm,2:2:Enmm).*vhz(2:2:Emm,3:2:Enmm,Epm)+...
            vcoef.viscpp1(1:2:Emmm,2:2:Enmmm,Epm).*(vhx(2:2:Emm,4:2:Enm,2)-vhx(2:2:Emm,4:2:Enm,Epm))+vcoef.viscpm1(1:2:Emmm,2:2:Enmmm,Epm).*(vhx(2:2:Emm,2:2:Enmmm,Epm)-vhx(2:2:Emm,2:2:Enmmm,2))...
            +vcoef.viscpp2(1:2:Emmm,2:2:Enmmm,Epm).*(vhy(3:2:Em,3:2:Enmm,2)-vhy(3:2:Em,3:2:Enmm,Epm))+vcoef.viscpm2(1:2:Emmm,2:2:Enmmm,Epm).*(vhy(1:2:Emmm,3:2:Enmm,Epm)-vhy(1:2:Emmm,3:2:Enmm,2))...
            )./vcoef.coefzboundF(1:2:Emmm,2:2:Enmmm);
%         vhznewo(2:2:Emm,3:2:Enmm,1)=vhz(2:2:Emm,3:2:Enmm,Ep);
            
         vhznew{7}=(fhz(2:2:Emm,En,Ep)+...
            vcoef.rescoefpp1boundFR(1:2:Emmm).*vhz(2:2:Emm,2,Ep)+vcoef.rescoefpm1boundFR(1:2:Emmm).*vhz(2:2:Emm,Enm,Ep)+...
            vcoef.rescoefpp2boundFR(1:2:Emmm).*vhz(3:2:Em,En,Ep)+vcoef.rescoefpm2boundFR(1:2:Emmm).*vhz(1:2:Emmm,En,Ep)+...
            2*vcoef.rescoefpp3boundFR(1:2:Emmm).*vhz(2:2:Emm,En,2)+2*vcoef.rescoefpm3boundFR(1:2:Emmm).*vhz(2:2:Emm,En,Epm)+...
            vcoef.viscpp1(1:2:Emmm,Enm,Epm).*(vhx(2:2:Emm,2,2)-vhx(2:2:Emm,2,Epm))+vcoef.viscpm1(1:2:Emmm,Enm,Epm).*(vhx(2:2:Emm,Enm,Epm)-vhx(2:2:Emm,Enm,2))...
            +vcoef.viscpp2(1:2:Emmm,Enm,Epm).*(vhy(3:2:Em,En,2)-vhy(3:2:Em,En,Epm))+vcoef.viscpm2(1:2:Emmm,Enm,Epm).*(vhy(1:2:Emmm,En,Epm)-vhy(1:2:Emmm,En,2))...
            )./vcoef.coefzboundFR(1:2:Emmm);
%         vhznewo(2:2:Emm,1,1)=vhz(2:2:Emm,En,Ep);
%         vhznewo(2:2:Emm,En,1)=vhz(2:2:Emm,En,Ep);
%         vhznewo(2:2:Emm,1,En)=vhz(2:2:Emm,En,Ep);
         
        
        vhznew{8}=(fhz(3:2:Emmm,2:2:Enm,3:2:Epmm)+...
            vcoef.rescoefpp1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhz(3:2:Emmm,3:2:En,3:2:Epmm)+vcoef.rescoefpm1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhz(3:2:Emmm,1:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhz(4:2:Emm,2:2:Enm,3:2:Epmm)+vcoef.rescoefpm2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhz(2:2:Emmmm,2:2:Enm,3:2:Epmm)+...
            2*vcoef.rescoefpp3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhz(3:2:Emmm,2:2:Enm,4:2:Epm)+2*vcoef.rescoefpm3(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*vhz(3:2:Emmm,2:2:Enm,2:2:Epmmm)+...
            vcoef.viscpp1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhx(3:2:Emmm,3:2:En,4:2:Epm)-vhx(3:2:Emmm,3:2:En,2:2:Epmmm))+...
            vcoef.viscpm1(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhx(3:2:Emmm,1:2:Enmm,2:2:Epmmm)-vhx(3:2:Emmm,1:2:Enmm,4:2:Epm))...
            +vcoef.viscpp2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhy(4:2:Emm,2:2:Enm,4:2:Epm)-vhy(4:2:Emm,2:2:Enm,2:2:Epmmm))+...
            vcoef.viscpm2(2:2:Emmmm,1:2:Enmm,2:2:Epmmm).*(vhy(2:2:Emmmm,2:2:Enm,2:2:Epmmm)-vhy(2:2:Emmmm,2:2:Enm,4:2:Epm))...
            )./vcoef.coefz(2:2:Emmmm,1:2:Enmm,2:2:Epmmm);
        
         vhznew{9}=(fhz(3:2:Emmm,2:2:Enm,Ep)+...
            vcoef.rescoefpp1boundF(2:2:Emmmm,1:2:Enmm).*vhz(3:2:Emmm,3:2:En,Ep)+vcoef.rescoefpm1boundF(2:2:Emmmm,1:2:Enmm).*vhz(3:2:Emmm,1:2:Enmm,Ep)+...
            vcoef.rescoefpp2boundF(2:2:Emmmm,1:2:Enmm).*vhz(4:2:Emm,2:2:Enm,Ep)+vcoef.rescoefpm2boundF(2:2:Emmmm,1:2:Enmm).*vhz(2:2:Emmmm,2:2:Enm,Ep)+...
            2*vcoef.rescoefpp3boundF(2:2:Emmmm,1:2:Enmm).*vhz(3:2:Emmm,2:2:Enm,2)+2*vcoef.rescoefpm3boundF(2:2:Emmmm,1:2:Enmm).*vhz(3:2:Emmm,2:2:Enm,Epm)+...
            vcoef.viscpp1(2:2:Emmmm,1:2:Enmm,Epm).*(vhx(3:2:Emmm,3:2:En,2)-vhx(3:2:Emmm,3:2:En,Epm))+vcoef.viscpm1(2:2:Emmmm,1:2:Enmm,Epm).*(vhx(3:2:Emmm,1:2:Enmm,Epm)-vhx(3:2:Emmm,1:2:Enmm,2))...
            +vcoef.viscpp2(2:2:Emmmm,1:2:Enmm,Epm).*(vhy(4:2:Emm,2:2:Enm,2)-vhy(4:2:Emm,2:2:Enm,Epm))+vcoef.viscpm2(2:2:Emmmm,1:2:Enmm,Epm).*(vhy(2:2:Emmmm,2:2:Enm,Epm)-vhy(2:2:Emmmm,2:2:Enm,2))...
            )./vcoef.coefzboundF(2:2:Emmmm,1:2:Enmm);
%         vhznewo(3:2:Emmm,2:2:Enm,1)=vhz(3:2:Emmm,2:2:Enm,Ep);
%       %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5  
        
%      %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
            elseif c2==4
        %black even pgs
        vhxnew{10}=(fhx(2:2:Emm,3:2:Enmm,2:2:Epm)+...
            2*vcoef.rescoefpp1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhx(2:2:Emm,4:2:Enm,2:2:Epm)+2*vcoef.rescoefpm1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhx(2:2:Emm,2:2:Enmmm,2:2:Epm)+...
            vcoef.rescoefpp2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhx(3:2:Em,3:2:Enmm,2:2:Epm)+vcoef.rescoefpm2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhx(1:2:Emmm,3:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhx(2:2:Emm,3:2:Enmm,3:2:Ep)+vcoef.rescoefpm3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhx(2:2:Emm,3:2:Enmm,1:2:Epmm)+...
            vcoef.viscpp2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhy(3:2:Em,4:2:Enm,2:2:Epm)-vhy(3:2:Em,2:2:Enmmm,2:2:Epm))+...
            vcoef.viscpm2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhy(1:2:Emmm,2:2:Enmmm,2:2:Epm)-vhy(1:2:Emmm,4:2:Enm,2:2:Epm))...
            +vcoef.viscpp3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhz(2:2:Emm,4:2:Enm,3:2:Ep)-vhz(2:2:Emm,2:2:Enmmm,3:2:Ep))+...
            vcoef.viscpm3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhz(2:2:Emm,2:2:Enmmm,1:2:Epmm)-vhz(2:2:Emm,4:2:Enm,1:2:Epmm)))./vcoef.coefx(1:2:Emmm,2:2:Enmmm,1:2:Epmm);
        
        vhxnew{11}=(fhx(2:2:Emm,En,2:2:Epm)+...
           2*vcoef.rescoefpp1boundR(1:2:Emmm,1,1:2:Epmm).*vhx(2:2:Emm,2,2:2:Epm)+2*vcoef.rescoefpm1boundR(1:2:Emmm,1,1:2:Epmm).*vhx(2:2:Emm,Enm,2:2:Epm)+...
           vcoef.rescoefpp2boundR(1:2:Emmm,1,1:2:Epmm).*vhx(3:2:Em,En,2:2:Epm)+vcoef.rescoefpm2boundR(1:2:Emmm,1,1:2:Epmm).*vhx(1:2:Emmm,En,2:2:Epm)+...
           vcoef.rescoefpp3boundR(1:2:Emmm,1,1:2:Epmm).*vhx(2:2:Emm,En,3:2:Ep)+vcoef.rescoefpm3boundR(1:2:Emmm,1,1:2:Epmm).*vhx(2:2:Emm,En,1:2:Epmm)+...
           vcoef.viscpp2(1:2:Emmm,Enm,1:2:Epmm).*(vhy(3:2:Em,2,2:2:Epm)-vhy(3:2:Em,Enm,2:2:Epm))+...
           vcoef.viscpm2(1:2:Emmm,Enm,1:2:Epmm).*(vhy(1:2:Emmm,Enm,2:2:Epm)-vhy(1:2:Emmm,2,2:2:Epm))...
           +vcoef.viscpp3(1:2:Emmm,Enm,1:2:Epmm).*(vhz(2:2:Emm,2,3:2:Ep)-vhz(2:2:Emm,Enm,3:2:Ep))+...
           vcoef.viscpm3(1:2:Emmm,Enm,1:2:Epmm).*(vhz(2:2:Emm,Enm,1:2:Epmm)-vhz(2:2:Emm,2,1:2:Epmm)))./vcoef.coefxboundR(1:2:Emmm,1,1:2:Epmm);
%         vhxnewe(2:2:Emm,1,2:2:Epm)=vhx(2:2:Emm,En,2:2:Epm);
        
        vhxnew{12}=(fhx(3:2:Emmm,2:2:Enm,2:2:Epm)+...
            2*vcoef.rescoefpp1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhx(3:2:Emmm,3:2:En,2:2:Epm)+2*vcoef.rescoefpm1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhx(3:2:Emmm,1:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhx(4:2:Emm,2:2:Enm,2:2:Epm)+vcoef.rescoefpm2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhx(2:2:Emmmm,2:2:Enm,2:2:Epm)+...
            vcoef.rescoefpp3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhx(3:2:Emmm,2:2:Enm,3:2:Ep)+vcoef.rescoefpm3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhx(3:2:Emmm,2:2:Enm,1:2:Epmm)+...
            vcoef.viscpp2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhy(4:2:Emm,3:2:En,2:2:Epm)-vhy(4:2:Emm,1:2:Enmm,2:2:Epm))+...
            vcoef.viscpm2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhy(2:2:Emmmm,1:2:Enmm,2:2:Epm)-vhy(2:2:Emmmm,3:2:En,2:2:Epm))...
            +vcoef.viscpp3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhz(3:2:Emmm,3:2:En,3:2:Ep)-vhz(3:2:Emmm,1:2:Enmm,3:2:Ep))+...
            vcoef.viscpm3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhz(3:2:Emmm,1:2:Enmm,1:2:Epmm)-vhz(3:2:Emmm,3:2:En,1:2:Epmm)))./vcoef.coefx(2:2:Emmmm,1:2:Enmm,1:2:Epmm);
            
%         
%         %black odd pgs
        vhxnew{13}=(fhx(2:2:Emm,2:2:Enm,3:2:Epmm)+...
            2*vcoef.rescoefpp1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhx(2:2:Emm,3:2:En,3:2:Epmm)+2*vcoef.rescoefpm1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhx(2:2:Emm,1:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhx(3:2:Em,2:2:Enm,3:2:Epmm)+vcoef.rescoefpm2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhx(1:2:Emmm,2:2:Enm,3:2:Epmm)+...
            vcoef.rescoefpp3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhx(2:2:Emm,2:2:Enm,4:2:Epm)+vcoef.rescoefpm3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhx(2:2:Emm,2:2:Enm,2:2:Epmmm)+...
            vcoef.viscpp2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhy(3:2:Em,3:2:En,3:2:Epmm)-vhy(3:2:Em,1:2:Enmm,3:2:Epmm))+...
            vcoef.viscpm2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhy(1:2:Emmm,1:2:Enmm,3:2:Epmm)-vhy(1:2:Emmm,3:2:En,3:2:Epmm))...
            +vcoef.viscpp3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhz(2:2:Emm,3:2:En,4:2:Epm)-vhz(2:2:Emm,1:2:Enmm,4:2:Epm))+...
            vcoef.viscpm3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhz(2:2:Emm,1:2:Enmm,2:2:Epmmm)-vhz(2:2:Emm,3:2:En,2:2:Epmmm)))./vcoef.coefx(1:2:Emmm,1:2:Enmm,2:2:Epmmm);
        
       vhxnew{14}=(fhx(2:2:Emm,2:2:Enm,Ep)+...
            2*vcoef.rescoefpp1boundF(1:2:Emmm,1:2:Enmm).*vhx(2:2:Emm,3:2:En,Ep)+2*vcoef.rescoefpm1boundF(1:2:Emmm,1:2:Enmm).*vhx(2:2:Emm,1:2:Enmm,Ep)+...
            vcoef.rescoefpp2boundF(1:2:Emmm,1:2:Enmm).*vhx(3:2:Em,2:2:Enm,Ep)+vcoef.rescoefpm2boundF(1:2:Emmm,1:2:Enmm).*vhx(1:2:Emmm,2:2:Enm,Ep)+...
            vcoef.rescoefpp3boundF(1:2:Emmm,1:2:Enmm).*vhx(2:2:Emm,2:2:Enm,2)+vcoef.rescoefpm3boundF(1:2:Emmm,1:2:Enmm).*vhx(2:2:Emm,2:2:Enm,Epm)+...
            vcoef.viscpp2(1:2:Emmm,1:2:Enmm,Epm).*(vhy(3:2:Em,3:2:En,Ep)-vhy(3:2:Em,1:2:Enmm,Ep))+vcoef.viscpm2(1:2:Emmm,1:2:Enmm,Epm).*(vhy(1:2:Emmm,1:2:Enmm,Ep)-vhy(1:2:Emmm,3:2:En,Ep))...
            +vcoef.viscpp3(1:2:Emmm,1:2:Enmm,Epm).*(vhz(2:2:Emm,3:2:En,2)-vhz(2:2:Emm,1:2:Enmm,2))+vcoef.viscpm3(1:2:Emmm,1:2:Enmm,Epm).*(vhz(2:2:Emm,1:2:Enmm,Epm)-vhz(2:2:Emm,3:2:En,Epm)))./vcoef.coefxboundF(1:2:Emmm,1:2:Enmm);
%         vhxnewo(2:2:Emm,2:2:Enm,1)=vhx(2:2:Emm,2:2:Enm,Ep);
        
        
        vhxnew{15}=(fhx(3:2:Emmm,3:2:Enmm,3:2:Epmm)+...
            2*vcoef.rescoefpp1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhx(3:2:Emmm,4:2:Enm,3:2:Epmm)+2*vcoef.rescoefpm1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhx(3:2:Emmm,2:2:Enmmm,3:2:Epmm)+...
            vcoef.rescoefpp2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhx(4:2:Emm,3:2:Enmm,3:2:Epmm)+vcoef.rescoefpm2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhx(2:2:Emmmm,3:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhx(3:2:Emmm,3:2:Enmm,4:2:Epm)+vcoef.rescoefpm3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhx(3:2:Emmm,3:2:Enmm,2:2:Epmmm)+...
            vcoef.viscpp2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhy(4:2:Emm,4:2:Enm,3:2:Epmm)-vhy(4:2:Emm,2:2:Enmmm,3:2:Epmm))+...
            vcoef.viscpm2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhy(2:2:Emmmm,2:2:Enmmm,3:2:Epmm)-vhy(2:2:Emmmm,4:2:Enm,3:2:Epmm))...
            +vcoef.viscpp3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhz(3:2:Emmm,4:2:Enm,4:2:Epm)-vhz(3:2:Emmm,2:2:Enmmm,4:2:Epm))+...
            vcoef.viscpm3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhz(3:2:Emmm,2:2:Enmmm,2:2:Epmmm)-vhz(3:2:Emmm,4:2:Enm,2:2:Epmmm)))./vcoef.coefx(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm);
        
        
        vhxnew{16}=(fhx(3:2:Emmm,En,3:2:Epmm)+...
           2*vcoef.rescoefpp1boundR(2:2:Emmmm,1,2:2:Epmmm).*vhx(3:2:Emmm,2,3:2:Epmm)+2*vcoef.rescoefpm1boundR(2:2:Emmmm,1,2:2:Epmmm).*vhx(3:2:Emmm,Enm,3:2:Epmm)+...
           vcoef.rescoefpp2boundR(2:2:Emmmm,1,2:2:Epmmm).*vhx(4:2:Emm,En,3:2:Epmm)+vcoef.rescoefpm2boundR(2:2:Emmmm,1,2:2:Epmmm).*vhx(2:2:Emmmm,En,3:2:Epmm)+...
           vcoef.rescoefpp3boundR(2:2:Emmmm,1,2:2:Epmmm).*vhx(3:2:Emmm,En,4:2:Epm)+vcoef.rescoefpm3boundR(2:2:Emmmm,1,2:2:Epmmm).*vhx(3:2:Emmm,En,2:2:Epmmm)+...
           vcoef.viscpp2(2:2:Emmmm,Enm,2:2:Epmmm).*(vhy(4:2:Emm,2,3:2:Epmm)-vhy(4:2:Emm,Enm,3:2:Epmm))+...
           vcoef.viscpm2(2:2:Emmmm,Enm,2:2:Epmmm).*(vhy(2:2:Emmmm,Enm,3:2:Epmm)-vhy(2:2:Emmmm,2,3:2:Epmm))...
           +vcoef.viscpp3(2:2:Emmmm,Enm,2:2:Epmmm).*(vhz(3:2:Emmm,2,4:2:Epm)-vhz(3:2:Emmm,Enm,4:2:Epm))+...
           vcoef.viscpm3(2:2:Emmmm,Enm,2:2:Epmmm).*(vhz(3:2:Emmm,Enm,2:2:Epmmm)-vhz(3:2:Emmm,2,2:2:Epmmm)))./vcoef.coefxboundR(2:2:Emmmm,1,2:2:Epmmm);
%         vhxnewo(3:2:Emmm,1,3:2:Epmm)=vhx(3:2:Emmm,En,3:2:Epmm);
        
        
        vhxnew{17}=(fhx(3:2:Emmm,3:2:Enmm,Ep)+...
            2*vcoef.rescoefpp1boundF(2:2:Emmmm,2:2:Enmmm).*vhx(3:2:Emmm,4:2:Enm,Ep)+2*vcoef.rescoefpm1boundF(2:2:Emmmm,2:2:Enmmm).*vhx(3:2:Emmm,2:2:Enmmm,Ep)+...
            vcoef.rescoefpp2boundF(2:2:Emmmm,2:2:Enmmm).*vhx(4:2:Emm,3:2:Enmm,Ep)+vcoef.rescoefpm2boundF(2:2:Emmmm,2:2:Enmmm).*vhx(2:2:Emmmm,3:2:Enmm,Ep)+...
            vcoef.rescoefpp3boundF(2:2:Emmmm,2:2:Enmmm).*vhx(3:2:Emmm,3:2:Enmm,2)+vcoef.rescoefpm3boundF(2:2:Emmmm,2:2:Enmmm).*vhx(3:2:Emmm,3:2:Enmm,Epm)+...
            vcoef.viscpp2(2:2:Emmmm,2:2:Enmmm,Epm).*(vhy(4:2:Emm,4:2:Enm,Ep)-vhy(4:2:Emm,2:2:Enmmm,Ep))+vcoef.viscpm2(2:2:Emmmm,2:2:Enmmm,Epm).*(vhy(2:2:Emmmm,2:2:Enmmm,Ep)-vhy(2:2:Emmmm,4:2:Enm,Ep))...
            +vcoef.viscpp3(2:2:Emmmm,2:2:Enmmm,Epm).*(vhz(3:2:Emmm,4:2:Enm,2)-vhz(3:2:Emmm,2:2:Enmmm,2))+vcoef.viscpm3(2:2:Emmmm,2:2:Enmmm,Epm).*(vhz(3:2:Emmm,2:2:Enmmm,Epm)-vhz(3:2:Emmm,4:2:Enm,Epm)))./vcoef.coefxboundF(2:2:Emmmm,2:2:Enmmm);
%        vhxnewo(3:2:Emmm,3:2:Enmm,1)=vhx(3:2:Emmm,3:2:Enmm,Ep);
       
        vhxnew{18}=(fhx(3:2:Emmm,En,Ep)+...
            2*vcoef.rescoefpp1boundFR(2:2:Emmmm).*vhx(3:2:Emmm,2,Ep)+2*vcoef.rescoefpm1boundFR(2:2:Emmmm).*vhx(3:2:Emmm,Enm,Ep)+...
            vcoef.rescoefpp2boundFR(2:2:Emmmm).*vhx(4:2:Emm,En,Ep)+vcoef.rescoefpm2boundFR(2:2:Emmmm).*vhx(2:2:Emmmm,En,Ep)+...
            vcoef.rescoefpp3boundFR(2:2:Emmmm).*vhx(3:2:Emmm,En,2)+vcoef.rescoefpm3boundFR(2:2:Emmmm).*vhx(3:2:Emmm,En,Epm)+...
            vcoef.viscpp2(2:2:Emmmm,Enm,Epm).*(vhy(4:2:Emm,2,Ep)-vhy(4:2:Emm,Enm,Ep))+vcoef.viscpm2(2:2:Emmmm,Enm,Epm).*(vhy(2:2:Emmmm,Enm,Ep)-vhy(2:2:Emmmm,2,Ep))...
            +vcoef.viscpp3(2:2:Emmmm,Enm,Epm).*(vhz(3:2:Emmm,2,2)-vhz(3:2:Emmm,Enm,2))+vcoef.viscpm3(2:2:Emmmm,Enm,Epm).*(vhz(3:2:Emmm,Enm,Epm)-vhz(3:2:Emmm,2,Epm)))./vcoef.coefxboundFR(2:2:Emmmm);
%        vhxnewo(3:2:Emmm,1,1)=vhx(3:2:Emmm,En,Ep);
%        vhxnewo(3:2:Emmm,En,1)=vhx(3:2:Emmm,En,Ep);
%        vhxnewo(3:2:Emmm,1,En)=vhx(3:2:Emmm,En,Ep);
%         

        
        
        
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   y vel
        
            elseif c2==5
%         black even pgs
        vhynew{10}=(fhy(2:2:Emm,3:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhy(2:2:Emm,4:2:Enm,2:2:Epm)+vcoef.rescoefpm1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhy(2:2:Emm,2:2:Enmmm,2:2:Epm)+...
            2*vcoef.rescoefpp2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhy(3:2:Em,3:2:Enmm,2:2:Epm)+2*vcoef.rescoefpm2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhy(1:2:Emmm,3:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhy(2:2:Emm,3:2:Enmm,3:2:Ep)+vcoef.rescoefpm3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhy(2:2:Emm,3:2:Enmm,1:2:Epmm)+...
            vcoef.viscpp1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhx(3:2:Em,4:2:Enm,2:2:Epm)-vhx(1:2:Emmm,4:2:Enm,2:2:Epm))+...
            vcoef.viscpm1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhx(1:2:Emmm,2:2:Enmmm,2:2:Epm)-vhx(3:2:Em,2:2:Enmmm,2:2:Epm))...
            +vcoef.viscpp3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhz(3:2:Em,3:2:Enmm,3:2:Ep)-vhz(1:2:Emmm,3:2:Enmm,3:2:Ep))+...
            vcoef.viscpm3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhz(1:2:Emmm,3:2:Enmm,1:2:Epmm)-vhz(3:2:Em,3:2:Enmm,1:2:Epmm)))./vcoef.coefy(1:2:Emmm,2:2:Enmmm,1:2:Epmm);
        
        vhynew{11}=(fhy(2:2:Emm,En,2:2:Epm)+...
           vcoef.rescoefpp1boundR(1:2:Emmm,1,1:2:Epmm).*vhy(2:2:Emm,2,2:2:Epm)+vcoef.rescoefpm1boundR(1:2:Emmm,1,1:2:Epmm).*vhy(2:2:Emm,Enm,2:2:Epm)+...
           2*vcoef.rescoefpp2boundR(1:2:Emmm,1,1:2:Epmm).*vhy(3:2:Em,En,2:2:Epm)+2*vcoef.rescoefpm2boundR(1:2:Emmm,1,1:2:Epmm).*vhy(1:2:Emmm,En,2:2:Epm)+...
           vcoef.rescoefpp3boundR(1:2:Emmm,1,1:2:Epmm).*vhy(2:2:Emm,En,3:2:Ep)+vcoef.rescoefpm3boundR(1:2:Emmm,1,1:2:Epmm).*vhy(2:2:Emm,En,1:2:Epmm)+...
           vcoef.viscpp1(1:2:Emmm,Enm,1:2:Epmm).*(vhx(3:2:Em,2,2:2:Epm)-vhx(1:2:Emmm,2,2:2:Epm))+...
           vcoef.viscpm1(1:2:Emmm,Enm,1:2:Epmm).*(vhx(1:2:Emmm,Enm,2:2:Epm)-vhx(3:2:Em,Enm,2:2:Epm))...
           +vcoef.viscpp3(1:2:Emmm,Enm,1:2:Epmm).*(vhz(3:2:Em,En,3:2:Ep)-vhz(1:2:Emmm,En,3:2:Ep))+...
           vcoef.viscpm3(1:2:Emmm,Enm,1:2:Epmm).*(vhz(1:2:Emmm,En,1:2:Epmm)-vhz(3:2:Em,En,1:2:Epmm)))./vcoef.coefyboundR(1:2:Emmm,1,1:2:Epmm);
%         vhynew{12}(2:2:Emm,1,2:2:Epm)=vhy(2:2:Emm,En,2:2:Epm);
        
        
        vhynew{12}=(fhy(3:2:Emmm,2:2:Enm,2:2:Epm)+...
            vcoef.rescoefpp1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhy(3:2:Emmm,3:2:En,2:2:Epm)+vcoef.rescoefpm1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhy(3:2:Emmm,1:2:Enmm,2:2:Epm)+...
            2*vcoef.rescoefpp2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhy(4:2:Emm,2:2:Enm,2:2:Epm)+2*vcoef.rescoefpm2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhy(2:2:Emmmm,2:2:Enm,2:2:Epm)+...
            vcoef.rescoefpp3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhy(3:2:Emmm,2:2:Enm,3:2:Ep)+vcoef.rescoefpm3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhy(3:2:Emmm,2:2:Enm,1:2:Epmm)+...
            vcoef.viscpp1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhx(4:2:Emm,3:2:En,2:2:Epm)-vhx(2:2:Emmmm,3:2:En,2:2:Epm))+...
            vcoef.viscpm1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhx(2:2:Emmmm,1:2:Enmm,2:2:Epm)-vhx(4:2:Emm,1:2:Enmm,2:2:Epm))...
            +vcoef.viscpp3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhz(4:2:Emm,2:2:Enm,3:2:Ep)-vhz(2:2:Emmmm,2:2:Enm,3:2:Ep))+...
            vcoef.viscpm3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhz(2:2:Emmmm,2:2:Enm,1:2:Epmm)-vhz(4:2:Emm,2:2:Enm,1:2:Epmm)))./vcoef.coefy(2:2:Emmmm,1:2:Enmm,1:2:Epmm);
           
%         
%         %black odd pgs
        vhynew{13}=(fhy(2:2:Emm,2:2:Enm,3:2:Epmm)+...
            vcoef.rescoefpp1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhy(2:2:Emm,3:2:En,3:2:Epmm)+vcoef.rescoefpm1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhy(2:2:Emm,1:2:Enmm,3:2:Epmm)+...
            2*vcoef.rescoefpp2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhy(3:2:Em,2:2:Enm,3:2:Epmm)+2*vcoef.rescoefpm2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhy(1:2:Emmm,2:2:Enm,3:2:Epmm)+...
            vcoef.rescoefpp3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhy(2:2:Emm,2:2:Enm,4:2:Epm)+vcoef.rescoefpm3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhy(2:2:Emm,2:2:Enm,2:2:Epmmm)+...
            vcoef.viscpp1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhx(3:2:Em,3:2:En,3:2:Epmm)-vhx(1:2:Emmm,3:2:En,3:2:Epmm))+...
            vcoef.viscpm1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhx(1:2:Emmm,1:2:Enmm,3:2:Epmm)-vhx(3:2:Em,1:2:Enmm,3:2:Epmm))...
            +vcoef.viscpp3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhz(3:2:Em,2:2:Enm,4:2:Epm)-vhz(1:2:Emmm,2:2:Enm,4:2:Epm))+...
            vcoef.viscpm3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhz(1:2:Emmm,2:2:Enm,2:2:Epmmm)-vhz(3:2:Em,2:2:Enm,2:2:Epmmm)))./vcoef.coefy(1:2:Emmm,1:2:Enmm,2:2:Epmmm);
        
        vhynew{14}=(fhy(2:2:Emm,2:2:Enm,Ep)+...
            vcoef.rescoefpp1boundF(1:2:Emmm,1:2:Enmm).*vhy(2:2:Emm,3:2:En,Ep)+vcoef.rescoefpm1boundF(1:2:Emmm,1:2:Enmm).*vhy(2:2:Emm,1:2:Enmm,Ep)+...
            2*vcoef.rescoefpp2boundF(1:2:Emmm,1:2:Enmm).*vhy(3:2:Em,2:2:Enm,Ep)+2*vcoef.rescoefpm2boundF(1:2:Emmm,1:2:Enmm).*vhy(1:2:Emmm,2:2:Enm,Ep)+...
            vcoef.rescoefpp3boundF(1:2:Emmm,1:2:Enmm).*vhy(2:2:Emm,2:2:Enm,2)+vcoef.rescoefpm3boundF(1:2:Emmm,1:2:Enmm).*vhy(2:2:Emm,2:2:Enm,Epm)+...
            vcoef.viscpp1(1:2:Emmm,1:2:Enmm,Epm).*(vhx(3:2:Em,3:2:En,Ep)-vhx(1:2:Emmm,3:2:En,Ep))+vcoef.viscpm1(1:2:Emmm,1:2:Enmm,Epm).*(vhx(1:2:Emmm,1:2:Enmm,Ep)-vhx(3:2:Em,1:2:Enmm,Ep))...
            +vcoef.viscpp3(1:2:Emmm,1:2:Enmm,Epm).*(vhz(3:2:Em,2:2:Enm,2)-vhz(1:2:Emmm,2:2:Enm,2))+vcoef.viscpm3(1:2:Emmm,1:2:Enmm,Epm).*(vhz(1:2:Emmm,2:2:Enm,Epm)-vhz(3:2:Em,2:2:Enm,Epm)))./vcoef.coefyboundF(1:2:Emmm,1:2:Enmm);
%         vhynewo(2:2:Emm,2:2:Enm,1)=vhy(2:2:Emm,2:2:Enm,Ep); 
        
        vhynew{15}=(fhy(3:2:Emmm,3:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhy(3:2:Emmm,4:2:Enm,3:2:Epmm)+vcoef.rescoefpm1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhy(3:2:Emmm,2:2:Enmmm,3:2:Epmm)+...
            2*vcoef.rescoefpp2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhy(4:2:Emm,3:2:Enmm,3:2:Epmm)+2*vcoef.rescoefpm2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhy(2:2:Emmmm,3:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhy(3:2:Emmm,3:2:Enmm,4:2:Epm)+vcoef.rescoefpm3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhy(3:2:Emmm,3:2:Enmm,2:2:Epmmm)+...
            vcoef.viscpp1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhx(4:2:Emm,4:2:Enm,3:2:Epmm)-vhx(2:2:Emmmm,4:2:Enm,3:2:Epmm))+...
            vcoef.viscpm1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhx(2:2:Emmmm,2:2:Enmmm,3:2:Epmm)-vhx(4:2:Emm,2:2:Enmmm,3:2:Epmm))...
            +vcoef.viscpp3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhz(4:2:Emm,3:2:Enmm,4:2:Epm)-vhz(2:2:Emmmm,3:2:Enmm,4:2:Epm))+...
            vcoef.viscpm3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhz(2:2:Emmmm,3:2:Enmm,2:2:Epmmm)-vhz(4:2:Emm,3:2:Enmm,2:2:Epmmm)))./vcoef.coefy(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm);
        
        vhynew{16}=(fhy(3:2:Emmm,En,3:2:Epmm)+...
           vcoef.rescoefpp1boundR(2:2:Emmmm,1,2:2:Epmmm).*vhy(3:2:Emmm,2,3:2:Epmm)+vcoef.rescoefpm1boundR(2:2:Emmmm,1,2:2:Epmmm).*vhy(3:2:Emmm,Enm,3:2:Epmm)+...
           2*vcoef.rescoefpp2boundR(2:2:Emmmm,1,2:2:Epmmm).*vhy(4:2:Emm,En,3:2:Epmm)+2*vcoef.rescoefpm2boundR(2:2:Emmmm,1,2:2:Epmmm).*vhy(2:2:Emmmm,En,3:2:Epmm)+...
           vcoef.rescoefpp3boundR(2:2:Emmmm,1,2:2:Epmmm).*vhy(3:2:Emmm,En,4:2:Epm)+vcoef.rescoefpm3boundR(2:2:Emmmm,1,2:2:Epmmm).*vhy(3:2:Emmm,En,2:2:Epmmm)+...
           vcoef.viscpp1(2:2:Emmmm,Enm,2:2:Epmmm).*(vhx(4:2:Emm,2,3:2:Epmm)-vhx(2:2:Emmmm,2,3:2:Epmm))+...
           vcoef.viscpm1(2:2:Emmmm,Enm,2:2:Epmmm).*(vhx(2:2:Emmmm,Enm,3:2:Epmm)-vhx(4:2:Emm,Enm,3:2:Epmm))...
           +vcoef.viscpp3(2:2:Emmmm,Enm,2:2:Epmmm).*(vhz(4:2:Emm,En,4:2:Epm)-vhz(2:2:Emmmm,En,4:2:Epm))+...
           vcoef.viscpm3(2:2:Emmmm,Enm,2:2:Epmmm).*(vhz(2:2:Emmmm,En,2:2:Epmmm)-vhz(4:2:Emm,En,2:2:Epmmm)))./vcoef.coefyboundR(2:2:Emmmm,1,2:2:Epmmm);
%         vhynew{17}(3:2:Emmm,1,3:2:Epmm)=vhy(3:2:Emmm,En,3:2:Epmm);
        
        
        vhynew{17}=(fhy(3:2:Emmm,3:2:Enmm,Ep)+...
            vcoef.rescoefpp1boundF(2:2:Emmmm,2:2:Enmmm).*vhy(3:2:Emmm,4:2:Enm,Ep)+vcoef.rescoefpm1boundF(2:2:Emmmm,2:2:Enmmm).*vhy(3:2:Emmm,2:2:Enmmm,Ep)+...
            2*vcoef.rescoefpp2boundF(2:2:Emmmm,2:2:Enmmm).*vhy(4:2:Emm,3:2:Enmm,Ep)+2*vcoef.rescoefpm2boundF(2:2:Emmmm,2:2:Enmmm).*vhy(2:2:Emmmm,3:2:Enmm,Ep)+...
            vcoef.rescoefpp3boundF(2:2:Emmmm,2:2:Enmmm).*vhy(3:2:Emmm,3:2:Enmm,2)+vcoef.rescoefpm3boundF(2:2:Emmmm,2:2:Enmmm).*vhy(3:2:Emmm,3:2:Enmm,Epm)+...
            vcoef.viscpp1(2:2:Emmmm,2:2:Enmmm,Epm).*(vhx(4:2:Emm,4:2:Enm,Ep)-vhx(2:2:Emmmm,4:2:Enm,Ep))+vcoef.viscpm1(2:2:Emmmm,2:2:Enmmm,Epm).*(vhx(2:2:Emmmm,2:2:Enmmm,Ep)-vhx(4:2:Emm,2:2:Enmmm,Ep))...
            +vcoef.viscpp3(2:2:Emmmm,2:2:Enmmm,Epm).*(vhz(4:2:Emm,3:2:Enmm,2)-vhz(2:2:Emmmm,3:2:Enmm,2))+vcoef.viscpm3(2:2:Emmmm,2:2:Enmmm,Epm).*(vhz(2:2:Emmmm,3:2:Enmm,Epm)-vhz(4:2:Emm,3:2:Enmm,Epm)))./vcoef.coefyboundF(2:2:Emmmm,2:2:Enmmm);
%         vhynew{18}(3:2:Emmm,3:2:Enmm,1)=vhy(3:2:Emmm,3:2:Enmm,Ep);
        
        vhynew{18}=(fhy(3:2:Emmm,En,Ep)+...
           vcoef.rescoefpp1boundFR(2:2:Emmmm).*vhy(3:2:Emmm,2,Ep)+vcoef.rescoefpm1boundFR(2:2:Emmmm).*vhy(3:2:Emmm,Enm,Ep)+...
           2*vcoef.rescoefpp2boundFR(2:2:Emmmm).*vhy(4:2:Emm,En,Ep)+2*vcoef.rescoefpm2boundFR(2:2:Emmmm).*vhy(2:2:Emmmm,En,Ep)+...
           vcoef.rescoefpp3boundFR(2:2:Emmmm).*vhy(3:2:Emmm,En,2)+vcoef.rescoefpm3boundFR(2:2:Emmmm).*vhy(3:2:Emmm,En,Epm)+...
           vcoef.viscpp1(2:2:Emmmm,Enm,Epm).*(vhx(4:2:Emm,2,Ep)-vhx(2:2:Emmmm,2,Ep))+vcoef.viscpm1(2:2:Emmmm,Enm,Epm).*(vhx(2:2:Emmmm,Enm,Ep)-vhx(4:2:Emm,Enm,Ep))...
           +vcoef.viscpp3(2:2:Emmmm,Enm,Epm).*(vhz(4:2:Emm,En,2)-vhz(2:2:Emmmm,En,2))+vcoef.viscpm3(2:2:Emmmm,Enm,Epm).*(vhz(2:2:Emmmm,En,Epm)-vhz(4:2:Emm,En,Epm)))./vcoef.coefyboundFR(2:2:Emmmm);
%         vhynewo(3:2:Emmm,En,1)=vhy(3:2:Emmm,En,Ep);
%         vhynewo(3:2:Emmm,1,En)=vhy(3:2:Emmm,En,Ep);
%         vhynewo(3:2:Emmm,1,1)=vhy(3:2:Emmm,En,Ep);
        
             
            elseif c2==1
        
        
% %       %%%%%%%%%%%%%%  z vel  


        
%         %black even pgs
        vhznew{10}=(fhz(2:2:Emm,3:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhz(2:2:Emm,4:2:Enm,2:2:Epm)+vcoef.rescoefpm1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhz(2:2:Emm,2:2:Enmmm,2:2:Epm)+...
            vcoef.rescoefpp2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhz(3:2:Em,3:2:Enmm,2:2:Epm)+vcoef.rescoefpm2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhz(1:2:Emmm,3:2:Enmm,2:2:Epm)+...
            2*vcoef.rescoefpp3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhz(2:2:Emm,3:2:Enmm,3:2:Ep)+2*vcoef.rescoefpm3(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*vhz(2:2:Emm,3:2:Enmm,1:2:Epmm)+...
            vcoef.viscpp1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhx(2:2:Emm,4:2:Enm,3:2:Ep)-vhx(2:2:Emm,4:2:Enm,1:2:Epmm))+...
            vcoef.viscpm1(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhx(2:2:Emm,2:2:Enmmm,1:2:Epmm)-vhx(2:2:Emm,2:2:Enmmm,3:2:Ep))...
            +vcoef.viscpp2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhy(3:2:Em,3:2:Enmm,3:2:Ep)-vhy(3:2:Em,3:2:Enmm,1:2:Epmm))+...
            vcoef.viscpm2(1:2:Emmm,2:2:Enmmm,1:2:Epmm).*(vhy(1:2:Emmm,3:2:Enmm,1:2:Epmm)-vhy(1:2:Emmm,3:2:Enmm,3:2:Ep))...
            )./vcoef.coefz(1:2:Emmm,2:2:Enmmm,1:2:Epmm);
        
        vhznew{11}=(fhz(2:2:Emm,En,2:2:Epm)+...
           vcoef.rescoefpp1boundR(1:2:Emmm,1,1:2:Epmm).*vhz(2:2:Emm,2,2:2:Epm)+vcoef.rescoefpm1boundR(1:2:Emmm,1,1:2:Epmm).*vhz(2:2:Emm,Enm,2:2:Epm)+...
           vcoef.rescoefpp2boundR(1:2:Emmm,1,1:2:Epmm).*vhz(3:2:Em,En,2:2:Epm)+vcoef.rescoefpm2boundR(1:2:Emmm,1,1:2:Epmm).*vhz(1:2:Emmm,En,2:2:Epm)+...
           2*vcoef.rescoefpp3boundR(1:2:Emmm,1,1:2:Epmm).*vhz(2:2:Emm,En,3:2:Ep)+2*vcoef.rescoefpm3boundR(1:2:Emmm,1,1:2:Epmm).*vhz(2:2:Emm,En,1:2:Epmm)+...
           vcoef.viscpp1(1:2:Emmm,Enm,1:2:Epmm).*(vhx(2:2:Emm,2,3:2:Ep)-vhx(2:2:Emm,2,1:2:Epmm))+...
           vcoef.viscpm1(1:2:Emmm,Enm,1:2:Epmm).*(vhx(2:2:Emm,Enm,1:2:Epmm)-vhx(2:2:Emm,Enm,3:2:Ep))...
           +vcoef.viscpp2(1:2:Emmm,Enm,1:2:Epmm).*(vhy(3:2:Em,En,3:2:Ep)-vhy(3:2:Em,En,1:2:Epmm))+...
           vcoef.viscpm2(1:2:Emmm,Enm,1:2:Epmm).*(vhy(1:2:Emmm,En,1:2:Epmm)-vhy(1:2:Emmm,En,3:2:Ep))...
           )./vcoef.coefzboundR(1:2:Emmm,1,1:2:Epmm);
%        vhznewe(2:2:Emm,1,2:2:Epm)=vhz(2:2:Emm,En,2:2:Epm);
        
        
        
        vhznew{12}=(fhz(3:2:Emmm,2:2:Enm,2:2:Epm)+...
            vcoef.rescoefpp1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhz(3:2:Emmm,3:2:En,2:2:Epm)+vcoef.rescoefpm1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhz(3:2:Emmm,1:2:Enmm,2:2:Epm)+...
            vcoef.rescoefpp2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhz(4:2:Emm,2:2:Enm,2:2:Epm)+vcoef.rescoefpm2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhz(2:2:Emmmm,2:2:Enm,2:2:Epm)+...
            2*vcoef.rescoefpp3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhz(3:2:Emmm,2:2:Enm,3:2:Ep)+2*vcoef.rescoefpm3(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*vhz(3:2:Emmm,2:2:Enm,1:2:Epmm)+...
            vcoef.viscpp1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhx(3:2:Emmm,3:2:En,3:2:Ep)-vhx(3:2:Emmm,3:2:En,1:2:Epmm))+...
            vcoef.viscpm1(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhx(3:2:Emmm,1:2:Enmm,1:2:Epmm)-vhx(3:2:Emmm,1:2:Enmm,3:2:Ep))...
            +vcoef.viscpp2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhy(4:2:Emm,2:2:Enm,3:2:Ep)-vhy(4:2:Emm,2:2:Enm,1:2:Epmm))+...
            vcoef.viscpm2(2:2:Emmmm,1:2:Enmm,1:2:Epmm).*(vhy(2:2:Emmmm,2:2:Enm,1:2:Epmm)-vhy(2:2:Emmmm,2:2:Enm,3:2:Ep))...
            )./vcoef.coefz(2:2:Emmmm,1:2:Enmm,1:2:Epmm);
             end
             if c2==2
        
%         %black odd pgs
        vhznew{13}=(fhz(2:2:Emm,2:2:Enm,3:2:Epmm)+...
            vcoef.rescoefpp1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhz(2:2:Emm,3:2:En,3:2:Epmm)+vcoef.rescoefpm1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhz(2:2:Emm,1:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhz(3:2:Em,2:2:Enm,3:2:Epmm)+vcoef.rescoefpm2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhz(1:2:Emmm,2:2:Enm,3:2:Epmm)+...
            2*vcoef.rescoefpp3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhz(2:2:Emm,2:2:Enm,4:2:Epm)+2*vcoef.rescoefpm3(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*vhz(2:2:Emm,2:2:Enm,2:2:Epmmm)+...
            vcoef.viscpp1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhx(2:2:Emm,3:2:En,4:2:Epm)-vhx(2:2:Emm,3:2:En,2:2:Epmmm))+...
            vcoef.viscpm1(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhx(2:2:Emm,1:2:Enmm,2:2:Epmmm)-vhx(2:2:Emm,1:2:Enmm,4:2:Epm))...
            +vcoef.viscpp2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhy(3:2:Em,2:2:Enm,4:2:Epm)-vhy(3:2:Em,2:2:Enm,2:2:Epmmm))+...
            vcoef.viscpm2(1:2:Emmm,1:2:Enmm,2:2:Epmmm).*(vhy(1:2:Emmm,2:2:Enm,2:2:Epmmm)-vhy(1:2:Emmm,2:2:Enm,4:2:Epm))...
            )./vcoef.coefz(1:2:Emmm,1:2:Enmm,2:2:Epmmm);
        
        vhznew{14}=(fhz(2:2:Emm,2:2:Enm,Ep)+...
            vcoef.rescoefpp1boundF(1:2:Emmm,1:2:Enmm).*vhz(2:2:Emm,3:2:En,Ep)+vcoef.rescoefpm1boundF(1:2:Emmm,1:2:Enmm).*vhz(2:2:Emm,1:2:Enmm,Ep)+...
            vcoef.rescoefpp2boundF(1:2:Emmm,1:2:Enmm).*vhz(3:2:Em,2:2:Enm,Ep)+vcoef.rescoefpm2boundF(1:2:Emmm,1:2:Enmm).*vhz(1:2:Emmm,2:2:Enm,Ep)+...
            2*vcoef.rescoefpp3boundF(1:2:Emmm,1:2:Enmm).*vhz(2:2:Emm,2:2:Enm,2)+2*vcoef.rescoefpm3boundF(1:2:Emmm,1:2:Enmm).*vhz(2:2:Emm,2:2:Enm,Epm)+...
            vcoef.viscpp1(1:2:Emmm,1:2:Enmm,Epm).*(vhx(2:2:Emm,3:2:En,2)-vhx(2:2:Emm,3:2:En,Epm))+vcoef.viscpm1(1:2:Emmm,1:2:Enmm,Epm).*(vhx(2:2:Emm,1:2:Enmm,Epm)-vhx(2:2:Emm,1:2:Enmm,2))...
            +vcoef.viscpp2(1:2:Emmm,1:2:Enmm,Epm).*(vhy(3:2:Em,2:2:Enm,2)-vhy(3:2:Em,2:2:Enm,Epm))+vcoef.viscpm2(1:2:Emmm,1:2:Enmm,Epm).*(vhy(1:2:Emmm,2:2:Enm,Epm)-vhy(1:2:Emmm,2:2:Enm,2))...
            )./vcoef.coefzboundF(1:2:Emmm,1:2:Enmm);
%         vhznewo(2:2:Emm,2:2:Enm,1)=vhz(2:2:Emm,2:2:Enm,Ep);
    
    
        vhznew{15}=(fhz(3:2:Emmm,3:2:Enmm,3:2:Epmm)+...
            vcoef.rescoefpp1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhz(3:2:Emmm,4:2:Enm,3:2:Epmm)+vcoef.rescoefpm1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhz(3:2:Emmm,2:2:Enmmm,3:2:Epmm)+...
            vcoef.rescoefpp2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhz(4:2:Emm,3:2:Enmm,3:2:Epmm)+vcoef.rescoefpm2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhz(2:2:Emmmm,3:2:Enmm,3:2:Epmm)+...
            2*vcoef.rescoefpp3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhz(3:2:Emmm,3:2:Enmm,4:2:Epm)+2*vcoef.rescoefpm3(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*vhz(3:2:Emmm,3:2:Enmm,2:2:Epmmm)+...
            vcoef.viscpp1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhx(3:2:Emmm,4:2:Enm,4:2:Epm)-vhx(3:2:Emmm,4:2:Enm,2:2:Epmmm))+...
            vcoef.viscpm1(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhx(3:2:Emmm,2:2:Enmmm,2:2:Epmmm)-vhx(3:2:Emmm,2:2:Enmmm,4:2:Epm))...
            +vcoef.viscpp2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhy(4:2:Emm,3:2:Enmm,4:2:Epm)-vhy(4:2:Emm,3:2:Enmm,2:2:Epmmm))+...
            vcoef.viscpm2(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm).*(vhy(2:2:Emmmm,3:2:Enmm,2:2:Epmmm)-vhy(2:2:Emmmm,3:2:Enmm,4:2:Epm))...
            )./vcoef.coefz(2:2:Emmmm,2:2:Enmmm,2:2:Epmmm);
        
        vhznew{16}=(fhz(3:2:Emmm,En,3:2:Epmm)+...
            vcoef.rescoefpp1boundR(2:2:Emmmm,1,2:2:Epmmm).*vhz(3:2:Emmm,2,3:2:Epmm)+vcoef.rescoefpm1boundR(2:2:Emmmm,1,2:2:Epmmm).*vhz(3:2:Emmm,Enm,3:2:Epmm)+...
            vcoef.rescoefpp2boundR(2:2:Emmmm,1,2:2:Epmmm).*vhz(4:2:Emm,En,3:2:Epmm)+vcoef.rescoefpm2boundR(2:2:Emmmm,1,2:2:Epmmm).*vhz(2:2:Emmmm,En,3:2:Epmm)+...
            2*vcoef.rescoefpp3boundR(2:2:Emmmm,1,2:2:Epmmm).*vhz(3:2:Emmm,En,4:2:Epm)+2*vcoef.rescoefpm3boundR(2:2:Emmmm,1,2:2:Epmmm).*vhz(3:2:Emmm,En,2:2:Epmmm)+...
            vcoef.viscpp1(2:2:Emmmm,Enm,2:2:Epmmm).*(vhx(3:2:Emmm,2,4:2:Epm)-vhx(3:2:Emmm,2,2:2:Epmmm))+...
            vcoef.viscpm1(2:2:Emmmm,Enm,2:2:Epmmm).*(vhx(3:2:Emmm,Enm,2:2:Epmmm)-vhx(3:2:Emmm,Enm,4:2:Epm))...
            +vcoef.viscpp2(2:2:Emmmm,Enm,2:2:Epmmm).*(vhy(4:2:Emm,En,4:2:Epm)-vhy(4:2:Emm,En,2:2:Epmmm))+...
            vcoef.viscpm2(2:2:Emmmm,Enm,2:2:Epmmm).*(vhy(2:2:Emmmm,En,2:2:Epmmm)-vhy(2:2:Emmmm,En,4:2:Epm))...
            )./vcoef.coefzboundR(2:2:Emmmm,1,2:2:Epmmm);
%         vhznewo(3:2:Emmm,1,3:2:Epmm)=vhz(3:2:Emmm,En,3:2:Epmm);
        
        vhznew{17}=(fhz(3:2:Emmm,3:2:Enmm,Ep)+...
            vcoef.rescoefpp1boundF(2:2:Emmmm,2:2:Enmmm).*vhz(3:2:Emmm,4:2:Enm,Ep)+vcoef.rescoefpm1boundF(2:2:Emmmm,2:2:Enmmm).*vhz(3:2:Emmm,2:2:Enmmm,Ep)+...
            vcoef.rescoefpp2boundF(2:2:Emmmm,2:2:Enmmm).*vhz(4:2:Emm,3:2:Enmm,Ep)+vcoef.rescoefpm2boundF(2:2:Emmmm,2:2:Enmmm).*vhz(2:2:Emmmm,3:2:Enmm,Ep)+...
            2*vcoef.rescoefpp3boundF(2:2:Emmm,2:2:Enmm).*vhz(3:2:Emmm,3:2:Enmm,2)+2*vcoef.rescoefpm3boundF(2:2:Emmmm,2:2:Enmmm).*vhz(3:2:Emmm,3:2:Enmm,Epm)+...
            vcoef.viscpp1(2:2:Emmmm,2:2:Enmmm,Epm).*(vhx(3:2:Emmm,4:2:Enm,2)-vhx(3:2:Emmm,4:2:Enm,Epm))+vcoef.viscpm1(2:2:Emmmm,2:2:Enmmm,Epm).*(vhx(3:2:Emmm,2:2:Enmmm,Epm)-vhx(3:2:Emmm,2:2:Enmmm,2))...
            +vcoef.viscpp2(2:2:Emmmm,2:2:Enmmm,Epm).*(vhy(4:2:Emm,3:2:Enmm,2)-vhy(4:2:Emm,3:2:Enmm,Epm))+vcoef.viscpm2(2:2:Emmmm,2:2:Enmmm,Epm).*(vhy(2:2:Emmmm,3:2:Enmm,Epm)-vhy(2:2:Emmmm,3:2:Enmm,2))...
            )./vcoef.coefzboundF(2:2:Emmmm,2:2:Enmmm);
%         vhznewo(3:2:Emmm,3:2:Enmm,1)=vhz(3:2:Emmm,3:2:Enmm,Ep);
            
            
        vhznew{18}=(fhz(3:2:Emmm,En,Ep)+...
           vcoef.rescoefpp1boundFR(2:2:Emmmm).*vhz(3:2:Emmm,2,Ep)+vcoef.rescoefpm1boundFR(2:2:Emmmm).*vhz(3:2:Emmm,Enm,Ep)+...
           vcoef.rescoefpp2boundFR(2:2:Emmmm).*vhz(4:2:Emm,En,Ep)+vcoef.rescoefpm2boundFR(2:2:Emmmm).*vhz(2:2:Emmmm,En,Ep)+...
           2*vcoef.rescoefpp3boundFR(2:2:Emmm).*vhz(3:2:Emmm,En,2)+2*vcoef.rescoefpm3boundFR(2:2:Emmmm).*vhz(3:2:Emmm,En,Epm)+...
           vcoef.viscpp1(2:2:Emmmm,Enm,Epm).*(vhx(3:2:Emmm,2,2)-vhx(3:2:Emmm,2,Epm))+vcoef.viscpm1(2:2:Emmmm,Enm,Epm).*(vhx(3:2:Emmm,Enm,Epm)-vhx(3:2:Emmm,Enm,2))...
           +vcoef.viscpp2(2:2:Emmmm,Enm,Epm).*(vhy(4:2:Emm,En,2)-vhy(4:2:Emm,En,Epm))+vcoef.viscpm2(2:2:Emmmm,Enm,Epm).*(vhy(2:2:Emmmm,En,Epm)-vhy(2:2:Emmmm,En,2))...
           )./vcoef.coefzboundFR(2:2:Emmmm);
%        vhznewo(3:2:Emmm,1,1)=vhz(3:2:Emmm,En,Ep);   
%        vhznewo(3:2:Emmm,En,1)=vhz(3:2:Emmm,En,Ep);   
%        vhznewo(3:2:Emmm,1,En)=vhz(3:2:Emmm,En,Ep);   
%          
%         

        
        
%         vh(:,:,Ep)=vh(:,:,Ep-1);
        
        
    %     vh(:,1)=vh(:,2);
    %     vh(:,1)=vh(:,Enm);
    %     vh(:,En)=vh(:,2);
    
%         vh=(1-w)*vhnew+w*vh;
%         vhnew=vh;
            end
        end
        
         vhx(:,1,:)=vhx(:,En,:);
         vhx(:,:,1)=vhx(:,:,Ep);
         vhy(:,1,:)=vhy(:,En,:);
         vhy(:,:,1)=vhy(:,:,Ep);
         vhz(:,1,:)=vhz(:,En,:);
         vhz(:,:,1)=vhz(:,:,Ep);
         
         vhx(:,:,2:2:Epm)=vhxnew(:,:,2:2:Epm);
         vhy(:,:,2:2:Epm)=vhynew(:,:,2:2:Epm);
         vhz(:,:,2:2:Epm)=vhznew(:,:,2:2:Epm); 
         vhx(:,:,1:2:Ep)=vhxnew(:,:,1:2:Ep);
         vhy(:,:,1:2:Ep)=vhynew(:,:,1:2:Ep);
         vhz(:,:,1:2:Ep)=vhznew(:,:,1:2:Ep);
    end

% vhnew=vh;



